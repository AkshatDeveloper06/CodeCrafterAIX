css/styles.css:
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: #f0f0f0;
}

.header {
    background: #2c3e50;
    color: white;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-controls {
    display: flex;
    gap: 10px;
    align-items: center;
}

.language-select {
    background: white;
    border: none;
    padding: 6px;
    border-radius: 4px;
    cursor: pointer;
}

.main-content {
    display: flex;
    flex: 1;
    position: relative;
}

#blocklyDiv {
    flex: 1;
    height: calc(70vh - 60px);
}

.output-panel {
    width: 100%;
    height: 30vh;
    background: #fff;
    border-top: 2px solid #ccc;
    padding: 10px;
    font-family: monospace;
    display: flex;
    flex-direction: column;
    position: relative;
    transition: background-color 0.3s ease;
}

.resize-handle {
    width: 100%;
    height: 5px;
    background: #ccc;
    cursor: ns-resize;
    position: absolute;
    top: 0;
    left: 0;
}

.resize-handle:hover {
    background: #999;
}

#outputCode {
    font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
    font-size: 14px;
    line-height: 1.5;
    padding: 15px;
    transition: all 0.3s ease;
}

.button {
    background: #3498db;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    margin-left: 10px;
}

.button:hover {
    background: #2980b9;
}

/* Syntax highlighting */
/* Seletor de tema */
.theme-select {
    background: white;
    border: none;
    padding: 6px;
    border-radius: 4px;
    cursor: pointer;
    margin-right: 10px;
}

/* Tema Light (PadrÃ£o) */
.theme-light {
    background: white;
    color: #24292e;
}

.theme-light .token.comment { color: #6a737d; }
.theme-light .token.keyword { color: #d73a49; }
.theme-light .token.string { color: #032f62; }
.theme-light .token.class-name { color: #6f42c1; }
.theme-light .token.function { color: #005cc5; }
.theme-light .token.number { color: #005cc5; }
.theme-light .token.operator { color: #d73a49; }
.theme-light .token.punctuation { color: #24292e; }
.theme-light .token.annotation { color: #d73a49; }

/* Tema Dark */
.theme-dark {
    background: #1e1e1e;
    color: #d4d4d4;
}

.theme-dark .token.comment { color: #6A9955; }
.theme-dark .token.keyword { color: #569cd6; }
.theme-dark .token.string { color: #ce9178; }
.theme-dark .token.class-name { color: #4ec9b0; }
.theme-dark .token.function { color: #dcdcaa; }
.theme-dark .token.number { color: #b5cea8; }
.theme-dark .token.operator { color: #d4d4d4; }
.theme-dark .token.punctuation { color: #d4d4d4; }
.theme-dark .token.annotation { color: #4fc1ff; }

/* Tema GitHub */
.theme-github {
    background: white;
    color: #24292e;
}

.theme-github .token.comment { color: #6a737d; }
.theme-github .token.keyword { color: #d73a49; }
.theme-github .token.string { color: #032f62; }
.theme-github .token.class-name { color: #6f42c1; }
.theme-github .token.function { color: #005cc5; }
.theme-github .token.number { color: #005cc5; }
.theme-github .token.operator { color: #d73a49; }
.theme-github .token.punctuation { color: #24292e; }
.theme-github .token.annotation { color: #d73a49; }

/* Tema Monokai */
.theme-monokai {
    background: #272822;
    color: #f8f8f2;
}

.theme-monokai .token.comment { color: #75715e; }
.theme-monokai .token.keyword { color: #f92672; }
.theme-monokai .token.string { color: #e6db74; }
.theme-monokai .token.class-name { color: #a6e22e; }
.theme-monokai .token.function { color: #66d9ef; }
.theme-monokai .token.number { color: #ae81ff; }
.theme-monokai .token.operator { color: #f8f8f2; }
.theme-monokai .token.punctuation { color: #f8f8f2; }
.theme-monokai .token.annotation { color: #f92672; }

/* NotificaÃ§Ãµes */
.notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 5px;
    color: white;
    font-weight: bold;
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

.notification.success {
    background-color: #2ecc71;
}

.notification.error {
    background-color: #e74c3c;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Estilo para o input de arquivo (oculto) */
input[type="file"] {
    display: none;
}

/* Melhorias nos botÃµes de arquivo */
.button.file-button {
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.button.file-button span {
    font-size: 18px;
}

index.html:
<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>MIT App Inventor Extension Builder</title>
	
	<!-- Favicon -->
	<link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAERERERERERERAAAAAAAAERAQAAAAAAEBEAEAAAAAEAEQABAAAAEAARAAAQAAAQABEAAAEAAAEAEQAAAQAAEAARAAABAAEAABAAAAEAAAAAAQAAAQAAAAAAEAAAEAAAAAAAQAAAQAAAAAAEAAAAAAAAAAAAAARERERERERERAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
	
	<!-- Blockly -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/blockly.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/msg/pt-br.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/msg/en.js"></script>
	
	<!-- Prism.js para syntax highlighting -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
	
	<!-- CSS prÃ³prio -->
	<link rel="stylesheet" href="css/styles.css">
</head>
<body>
	<div class="header">
		<h2 id="title">MIT App Inventor Extension Builder</h2>
			<div class="header-controls">
				<select id="themeSelect" class="theme-select">
					<option value="light">Light Theme</option>
					<option value="dark">Dark Theme</option>
					<option value="github">GitHub</option>
					<option value="monokai">Monokai</option>
				</select>
				<select id="languageSelect" class="language-select">
					<option value="en">English</option>
					<option value="pt-br">PortuguÃªs</option>
				</select>
				<button class="button" onclick="saveBlocks()" title="Salvar Blocos">
					<span class="text-save">ðŸ’¾</span>
				</button>
				<button class="button" onclick="loadBlocks()" title="Carregar Blocos">
					<span class="text-load">ðŸ“‚</span>
				</button>
				<button class="button" onclick="generateJavaCode()">
					<span class="text-generate">Gerar CÃ³digo Java</span>
				</button>
				<button class="button" onclick="downloadCode()">
					<span class="text-download">Download .java</span>
				</button>
			</div>
	</div>
	<div class="main-content">
		<div id="blocklyDiv"></div>
	</div>
	<div class="output-panel">
		<div class="resize-handle"></div>
		<pre><code id="outputCode" class="language-java"></code></pre>
	</div>

	<xml id="toolbox" style="display: none">
	    <category id="cat_config" name="Configuration" colour="#5C6BC0">
	        <block type="extension_class"></block>
	        <block type="custom_annotation"></block>
	        <block type="constructor_declaration"></block>
	        <block type="constructor_parameter"></block>
	        <block type="constructor_super_call"></block>
	        <block type="package_declaration"></block>
	    </category>

	    <category id="cat_imports" name="Imports" colour="#00897B">
	        <block type="import_basic"></block>
	        <block type="import_manual"></block>
	        <block type="import_package"></block>
	        <block type="import_class"></block>
	        <block type="import_static"></block>
	        <block type="import_manual">
	            <field name="IMPORT_PATH">java.util.HashMap</field>
	        </block>		    
	    </category>

	    <category id="cat_imported" name="Imported Classes" colour="#6D4C41">
	        <block type="imported_static_method"></block>
	        <block type="imported_static_field"></block>
	        <block type="imported_type_declaration"></block>
	        <block type="imported_interface"></block>
	    </category>
	    
	    <category id="cat_props" name="Properties" colour="#FB8C00">
	        <block type="property_declaration"></block>
	        <block type="designer_property"></block>
	        <block type="set_property"></block>
	        <block type="get_property"></block>
	    </category>

	    <category id="cat_method_inserts" name="Method Inserts" colour="#4CAF50">
		    <block type="post_runnable"></block>
		    <block type="run_on_ui_thread"></block>
		    <block type="set_on_click_listener"></block>
		    <block type="add_text_view"></block>
		    <block type="add_image_view"></block>
		    <block type="scroll_to_bottom"></block>
		    <block type="show_toast"></block>
		</category>

	    
	    <category id="cat_methods" name="Methods" colour="#7CB342">
	        <block type="method_declaration"></block>
	        <block type="event_declaration"></block>
	        <block type="custom_dispatcher"></block>
	        <block type="method_return"></block>
	        <block type="method_call"></block>
	    </category>

	    <sep></sep>

	    <category id="cat_control" name="Control" colour="#E53935">
	        <block type="controls_if_java"></block>
	        <block type="controls_for_java"></block>
	        <block type="controls_while_java"></block>
	        <block type="controls_try_catch"></block>
	        <block type="controls_return"></block>
	    </category>

	    <category id="cat_logic" name="Logic" colour="#FDD835">
	        <block type="logic_compare"></block>
	        <block type="logic_operation"></block>
	        <block type="logic_negate"></block>
	        <block type="logic_boolean"></block>
	        <block type="logic_null"></block>
	    </category>

	    <category id="cat_math" name="Math" colour="#8E24AA">
	        <block type="math_operation"></block>
	        <block type="math_function"></block>
	        <block type="math_random"></block>
	        <block type="math_number"></block>
	        <block type="math_constant"></block>
	    </category>

	    <category id="cat_text" name="Text" colour="#3949AB">
	        <block type="text_string"></block>
	        <block type="text_join"></block>
	        <block type="text_operation"></block>
	        <block type="text_charAt"></block>
	        <block type="text_indexOf"></block>
	        <block type="log_message"></block>
        	<block type="log_message_tagged"></block>
        	<block type="single_line_comment"></block>
        	<block type="multi_line_comment"></block>
	    </category>

	    <category id="cat_lists" name="Lists" colour="#00ACC1">
	        <block type="lists_create"></block>
	        <block type="lists_operation"></block>
	        <block type="lists_get_index"></block>
	        <block type="lists_set_index"></block>
	        <block type="lists_forEach"></block>
	    </category>

	    <category id="cat_dictionaries" name="Dictionaries" colour="#43A047">
	        <block type="dict_create"></block>
	        <block type="dict_get"></block>
	        <block type="dict_set"></block>
	        <block type="dict_remove"></block>
	        <block type="dict_containsKey"></block>
	    </category>

	    <category id="cat_object" name="Objects" colour="#F4511E">
	        <block type="object_create"></block>
	        <block type="object_get_field"></block>
	        <block type="object_set_field"></block>
	        <block type="object_call_method"></block>
	        <block type="object_instance_of"></block>
	        <block type="object_cast"></block>
	        <sep gap="8"></sep>
	        <block type="constructor_arg"></block>
	        <block type="method_arg"></block>
	    </category>

	    <category id="cat_colors" name="Colors" colour="#D81B60">
	        <block type="color_picker"></block>
	        <block type="color_rgb"></block>
	        <block type="color_blend"></block>
	        <block type="color_random"></block>
	    </category>

	    <category id="cat_variables_custom" name="Variables" colour="#546E7A">
		    <block type="create_variable"></block>
		    <block type="set_variable"></block>
		    <block type="get_variable"></block>
		</category>


	    <category id="cat_functions" name="Functions" colour="#827717">
	        <block type="procedures_defnoreturn"></block>
	        <block type="procedures_defreturn"></block>
	        <block type="procedures_ifreturn"></block>
	        <block type="procedures_callnoreturn"></block>
	        <block type="procedures_callreturn"></block>
	        <block type="function_return"></block>
	    </category>
	</xml>


	<!-- Scripts prÃ³prios -->
	<script src="js/translations.js"></script>
	<script src="js/blocks/functions.js"></script>
	<script src="js/blocks/methods.js"></script>
	<script src="js/blocks/control_blocks.js"></script>
	<script src="js/blocks/math_blocks.js"></script>
	<script src="js/blocks/text_blocks.js"></script>
	<script src="js/blocks/list_blocks.js"></script>
	<script src="js/blocks/logic_blocks.js"></script>
	<script src="js/blocks/dictionary_blocks.js"></script>
	<script src="js/blocks/color_blocks.js"></script>
	<script src="js/blocks/import_blocks.js"></script>
	<script src="js/blocks/imported_class_blocks.js"></script>
	<script src="js/blocks/object_blocks.js"></script>
	<script src="js/blocks/imported_class_blocks.js"></script>
	<script src="js/blocks/blocks.js"></script>
	<script src="js/blocks/configurations.js"></script>
	<script src="js/blocks/method_inserts.js"></script>
	<script src="js/blocks/variables.js"></script>
	<script src="js/main.js"></script>
</body>
</html>


js/blocks/blocks.js:
// Define custom blocks



Blockly.Blocks['import_basic'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Import")
            .appendField(new Blockly.FieldDropdown([
                ["com.google.appinventor.components.annotations.*", "ANNOTATIONS"],
                ["com.google.appinventor.components.common.*", "COMMON"],
                ["com.google.appinventor.components.runtime.*", "RUNTIME"],
                ["android.content.Context", "CONTEXT"]
            ]), "IMPORT");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(210);
        this.setTooltip("Imports necessary libraries");
        this.setHelpUrl("");
    }
};

// Import Static Method

Blockly.Blocks['designer_property'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("designerProperty"), "PROPERTY_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["string", "PropertyTypeConstants.PROPERTY_TYPE_STRING"],
                ["boolean", "PropertyTypeConstants.PROPERTY_TYPE_BOOLEAN"],
                ["integer", "PropertyTypeConstants.PROPERTY_TYPE_INTEGER"],
                ["color", "PropertyTypeConstants.PROPERTY_TYPE_COLOR"]
            ]), "TYPE");
        this.appendDummyInput()
            .appendField("Description")
            .appendField(new Blockly.FieldTextInput("A designer property"), "DESCRIPTION");
        this.appendDummyInput()
            .appendField("Category")
            .appendField(new Blockly.FieldDropdown([
                ["BEHAVIOR", "PropertyCategory.BEHAVIOR"],
                ["APPEARANCE", "PropertyCategory.APPEARANCE"]
            ]), "CATEGORY");
        this.appendStatementInput("DESIGNER_PROPERTY_SETTER")
            .setCheck(null)
            .appendField("Setter");
        this.appendStatementInput("DESIGNER_PROPERTY_GETTER")
            .setCheck(null)
            .appendField("Getter");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(160);
        this.setTooltip("Declares a designer property");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['property_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["boolean", "boolean"],
                ["double", "double"]
            ]), "TYPE");
        this.appendStatementInput("PROPERTY_SETTER")
            .setCheck(null)
            .appendField("Setter");
        this.appendStatementInput("PROPERTY_GETTER")
            .setCheck(null)
            .appendField("Getter");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(160);
        this.setTooltip("Declares a property");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['set_property'] = {
  init: function() {
    this.appendValueInput("VALUE")
        .setCheck(null)
        .appendField("set")
        .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY");
    this.setPreviousStatement(true, null);
    this.setNextStatement(true, null);
    this.setColour(290);
    this.setTooltip("Set property value");
    this.setHelpUrl("");
  }
};


Blockly.Blocks['get_property'] = {
  init: function() {
    this.appendDummyInput()
        .appendField("get")
        .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY");
    this.setOutput(true, null);
    this.setColour(290);
    this.setTooltip("Get property value");
    this.setHelpUrl("");
  }
};




//Generators
// Java code generator
Blockly.JavaScript['set_property'] = function(block) {
  var property = block.getFieldValue('PROPERTY');
  var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC);
  var code = `set${property.charAt(0).toUpperCase() + property.slice(1)}(${value});\n`;
  return code;
};

Blockly.JavaScript['get_property'] = function(block) {
  var property = block.getFieldValue('PROPERTY');
  var code = `get${property.charAt(0).toUpperCase() + property.slice(1)}()`;
  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];
};

Blockly.JavaScript['property_declaration'] = function(block) {
    var propertyName = block.getFieldValue('PROPERTY_NAME');
    var type = block.getFieldValue('TYPE');
    var setterContent = Blockly.JavaScript.statementToCode(block, 'PROPERTY_SETTER');
    var getterContent = Blockly.JavaScript.statementToCode(block, 'PROPERTY_GETTER');
    
    return `    private ${type} ${propertyName};
    
    public void set${propertyName.charAt(0).toUpperCase() + propertyName.slice(1)}(${type} value) {
        ${setterContent}
    }
    
    public ${type} get${propertyName.charAt(0).toUpperCase() + propertyName.slice(1)}() {
        ${getterContent}
    }\n`;
};

Blockly.JavaScript['designer_property'] = function(block) {
    var propertyName = block.getFieldValue('PROPERTY_NAME');
    var type = block.getFieldValue('TYPE');
    var description = block.getFieldValue('DESCRIPTION');
    var category = block.getFieldValue('CATEGORY');
    var setterContent = Blockly.JavaScript.statementToCode(block, 'DESIGNER_PROPERTY_SETTER');
    var getterContent = Blockly.JavaScript.statementToCode(block, 'DESIGNER_PROPERTY_GETTER');
    
    return `    @DesignerProperty(editorType = ${type}, defaultValue = "")
    @SimpleProperty(description = "${description}")
    public void ${propertyName}(String value) {
        ${setterContent}
    }
    
    @SimpleProperty(category = ${category})
    public String ${propertyName}() {
        ${getterContent}
    }\n`;
};

Blockly.JavaScript['import_basic'] = function(block) {
    var importType = block.getFieldValue('IMPORT');
    var imports = {
        'ANNOTATIONS': 'com.google.appinventor.components.annotations.*',
        'COMMON': 'com.google.appinventor.components.common.*',
        'RUNTIME': 'com.google.appinventor.components.runtime.*',
        'CONTEXT': 'android.content.Context'
    };
    return `import ${imports[importType]};\n`;
};





js/blocks/color_blocks.js:
// Seletor de cor
Blockly.Blocks['color_picker'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('cor')
            .appendField(new Blockly.FieldColour('#ff0000'), 'COLOR');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Seleciona uma cor');
    }
};

// RGB
Blockly.Blocks['color_rgb'] = {
    init: function() {
        this.appendValueInput('RED')
            .setCheck('Number')
            .appendField('cor com R');
        this.appendValueInput('GREEN')
            .setCheck('Number')
            .appendField('G');
        this.appendValueInput('BLUE')
            .setCheck('Number')
            .appendField('B');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Cria uma cor a partir de valores RGB (0-255)');
    }
};

// Misturar cores
Blockly.Blocks['color_blend'] = {
    init: function() {
        this.appendValueInput('COLOR1')
            .setCheck('Color')
            .appendField('misturar cor');
        this.appendValueInput('COLOR2')
            .setCheck('Color')
            .appendField('com');
        this.appendValueInput('RATIO')
            .setCheck('Number')
            .appendField('proporÃ§Ã£o');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Mistura duas cores com uma proporÃ§Ã£o (0-1)');
    }
};

// Cor aleatÃ³ria
Blockly.Blocks['color_random'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('cor aleatÃ³ria');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Gera uma cor aleatÃ³ria');
    }
};

// Geradores de cÃ³digo para cores
Blockly.JavaScript['color_picker'] = function(block) {
    var color = block.getFieldValue('COLOR');
    return [`Color.parseColor("${color}")`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['color_rgb'] = function(block) {
    var red = Blockly.JavaScript.valueToCode(block, 'RED', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    var green = Blockly.JavaScript.valueToCode(block, 'GREEN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    var blue = Blockly.JavaScript.valueToCode(block, 'BLUE', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [`Color.rgb(${red}, ${green}, ${blue})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['color_blend'] = function(block) {
    var color1 = Blockly.JavaScript.valueToCode(block, 'COLOR1', Blockly.JavaScript.ORDER_ATOMIC) || 'Color.BLACK';
    var color2 = Blockly.JavaScript.valueToCode(block, 'COLOR2', Blockly.JavaScript.ORDER_ATOMIC) || 'Color.WHITE';
    var ratio = Blockly.JavaScript.valueToCode(block, 'RATIO', Blockly.JavaScript.ORDER_ATOMIC) || '0.5';
    return [`ColorUtils.blendARGB(${color1}, ${color2}, ${ratio})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['color_random'] = function(block) {
    return [`Color.rgb((int)(Math.random() * 256), (int)(Math.random() * 256), (int)(Math.random() * 256))`, 
        Blockly.JavaScript.ORDER_ATOMIC];
};

js/blocks/configurations.js:
//blocks/configurations.js

//Blocks
Blockly.Blocks['extension_class'] = {
  init: function() {
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Create Extension"), "className")
        .appendField(new Blockly.FieldTextInput("MyExtension"), "classNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Description"), "descriptionName")
        .appendField(new Blockly.FieldTextInput("A custom extension"), "descriptionNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Category"), "categoryName")
        .appendField(new Blockly.FieldTextInput("EXTENSION"), "extensionNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Non-visible"), "NAME")
        .appendField(new Blockly.FieldCheckbox("TRUE"), "checkBoxNonVisible");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Icon Name"), "NAME")
        .appendField(new Blockly.FieldTextInput("image/icon.png"), "imageURL");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Interfaces"), "interfacesLabel")
        .appendField(new Blockly.FieldTextInput(""), "interfaces");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("ANNOTATIONS"), "annotationsText");
    this.appendStatementInput("annotationBlocks")
        .setCheck(null);
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("BLOCKS"), "blocksExtensions");
    this.appendStatementInput("statementBlocks")
        .setCheck(null);
    this.setPreviousStatement(true, null);
    this.setColour("#5C6BC0");
    this.setTooltip("");
    this.setHelpUrl("");
  }
};

Blockly.Blocks['custom_annotation'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Custom Annotation")
            .appendField(new Blockly.FieldTextInput("@MyAnnotation"), "ANNOTATION");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip("Adds a custom annotation above @SimpleObject");
        this.setHelpUrl("");
    }
};


// Bloco do construtor
Blockly.Blocks['constructor_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('Constructor')
            .appendField(new Blockly.FieldCheckbox("TRUE"), "IS_DEFAULT")
            .appendField("default");
        this.appendStatementInput('PARAMETERS')
            .setCheck('constructor_parameter')
            .appendField('parameters');
        this.appendStatementInput('SUPER_CALL')
            .setCheck('constructor_super_call')
            .appendField('super call');
        this.appendStatementInput('CONSTRUCTOR_CONTENT')
            .setCheck(null)
            .appendField('implementation');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Define o construtor da extensÃ£o');
        
        this.updateShape_();
    },
    
    mutationToDom: function() {
        var container = document.createElement('mutation');
        var isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        container.setAttribute('is_default', isDefault);
        return container;
    },
    
    domToMutation: function(xmlElement) {
        var isDefault = (xmlElement.getAttribute('is_default') == 'true');
        this.getField('IS_DEFAULT').setValue(isDefault ? 'TRUE' : 'FALSE');
        this.updateShape_();
    },
    
    updateShape_: function() {
        var isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        if (isDefault) {
            if (this.getInput('PARAMETERS')) this.removeInput('PARAMETERS');
            if (this.getInput('SUPER_CALL')) this.removeInput('SUPER_CALL');
        } else {
            if (!this.getInput('PARAMETERS')) {
                this.appendStatementInput('PARAMETERS')
                    .setCheck('constructor_parameter')
                    .appendField('parameters');
            }
            if (!this.getInput('SUPER_CALL')) {
                this.appendStatementInput('SUPER_CALL')
                    .setCheck('constructor_super_call')
                    .appendField('super call');
            }
        }
    }
};

// Bloco de parÃ¢metro do construtor
Blockly.Blocks['constructor_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('parameter')
            .appendField(new Blockly.FieldTextInput('paramName'), 'PARAM_NAME')
            .appendField('type')
            .appendField(new Blockly.FieldDropdown([
                ['ComponentContainer', 'ComponentContainer'],
                ['Context', 'Context'],
                ['String', 'String'],
                ['int', 'int'],
                ['boolean', 'boolean']
            ]), 'PARAM_TYPE');
        this.setPreviousStatement(true, 'constructor_parameter');
        this.setNextStatement(true, 'constructor_parameter');
        this.setColour("#5C6BC0");
        this.setTooltip('Adiciona um parÃ¢metro ao construtor');
    }
};

// Bloco para chamada super
Blockly.Blocks['constructor_super_call'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('super(')
            .appendField(new Blockly.FieldTextInput('container.$context()'), 'SUPER_PARAMS')
            .appendField(')');
        this.setPreviousStatement(true, 'constructor_super_call');
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Chamada do construtor da classe pai');
    }
};

Blockly.Blocks['package_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Package")
            .appendField(new Blockly.FieldTextInput("com.example.extension"), "PACKAGE");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip("Declares the extension package");
        this.setHelpUrl("");
    }
};

//Generators
Blockly.JavaScript['extension_class'] = function(block) {
  var interfaces = block.getFieldValue('interfaces');
  var className = block.getFieldValue('classNameEdit');
  var description = block.getFieldValue('descriptionNameEdit');
  var category = block.getFieldValue('extensionNameEdit');
  var nonVisible = block.getFieldValue('checkBoxNonVisible') === 'TRUE';
  var iconName = block.getFieldValue('imageURL');
  var annotations = Blockly.JavaScript.statementToCode(block, 'annotationBlocks');
  var members = Blockly.JavaScript.statementToCode(block, 'statementBlocks');

  var code = `@DesignerComponent(version = 1,
    description = "${description}",
    category = ComponentCategory.${category},
    nonVisible = ${nonVisible},
    iconName = "${iconName}")
@SimpleObject(external = true)
${annotations}public class ${className} extends AndroidNonvisibleComponent${interfaces ? ' implements ' + interfaces : ''} {
${members}}`;

  return code;
};

Blockly.JavaScript['custom_annotation'] = function(block) {
    var annotation = block.getFieldValue('ANNOTATION');
    return `${annotation}\n`;
};

Blockly.JavaScript['constructor_declaration'] = function(block) {
    var isDefault = block.getFieldValue('IS_DEFAULT') == 'TRUE';
    var content = Blockly.JavaScript.statementToCode(block, 'CONSTRUCTOR_CONTENT') || '';
    
    if (isDefault) {
        return `    public Constructor(ComponentContainer container) {
        
${content}    }\n`;
    } else {
        var parameters = Blockly.JavaScript.statementToCode(block, 'PARAMETERS') || '';
        var superCall = Blockly.JavaScript.statementToCode(block, 'SUPER_CALL') || '';
        
        parameters = parameters.trim().replace(/,\s*$/, '');
        
        return `    public Constructor(${parameters}) {
${superCall}${content}    }\n`;
    }
};

Blockly.JavaScript['constructor_parameter'] = function(block) {
    var paramName = block.getFieldValue('PARAM_NAME');
    var paramType = block.getFieldValue('PARAM_TYPE');
    
    return paramType + ' ' + paramName + ', ';
};

Blockly.JavaScript['constructor_super_call'] = function(block) {
    var params = block.getFieldValue('SUPER_PARAMS');
    var afterSuper = Blockly.JavaScript.statementToCode(block, 'AFTER_SUPER') || '';
    
    return `        super(${params});
${afterSuper}`;
};

Blockly.JavaScript['package_declaration'] = function(block) {
    var package = block.getFieldValue('PACKAGE');
    return `package ${package};\n\n`;
};

js/blocks/control_blocks.js:
// Bloco If-Else
Blockly.Blocks['controls_if_java'] = {
    init: function() {
        this.appendValueInput('IF0')
            .setCheck('Boolean')
            .appendField('if');
        this.appendStatementInput('DO0')
            .appendField('do');
        this.appendStatementInput('ELSE')
            .appendField('else');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('If-else control statement');
    }
};

// Bloco For
Blockly.Blocks['controls_for_java'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('for')
            .appendField(new Blockly.FieldTextInput('i'), 'VAR')
            .appendField('from')
            .appendField(new Blockly.FieldNumber(0), 'FROM')
            .appendField('to')
            .appendField(new Blockly.FieldNumber(10), 'TO')
            .appendField('step')
            .appendField(new Blockly.FieldNumber(1), 'STEP');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('For loop with variable');
    }
};

// Bloco While
Blockly.Blocks['controls_while_java'] = {
    init: function() {
        this.appendValueInput('CONDITION')
            .setCheck('Boolean')
            .appendField('while');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('While loop');
    }
};

// Geradores de cÃ³digo para os blocos de controle
Blockly.JavaScript['controls_if_java'] = function(block) {
    var condition = Blockly.JavaScript.valueToCode(block, 'IF0', Blockly.JavaScript.ORDER_NONE) || 'false';
    var thenBranch = Blockly.JavaScript.statementToCode(block, 'DO0');
    var elseBranch = Blockly.JavaScript.statementToCode(block, 'ELSE');
    
    return `if (${condition}) {
        ${thenBranch}
    } else {
        ${elseBranch}
    }\n`;
};

Blockly.JavaScript['controls_for_java'] = function(block) {
    var variable = block.getFieldValue('VAR');
    var from = block.getFieldValue('FROM');
    var to = block.getFieldValue('TO');
    var step = block.getFieldValue('STEP');
    var branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `for (int ${variable} = ${from}; ${variable} <= ${to}; ${variable} += ${step}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_while_java'] = function(block) {
    var condition = Blockly.JavaScript.valueToCode(block, 'CONDITION', Blockly.JavaScript.ORDER_NONE) || 'false';
    var branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `while (${condition}) {
        ${branch}
    }\n`;
};

// Bloco If-Else
Blockly.Blocks['controls_if_java'] = {
    init: function() {
        this.appendValueInput('IF0')
            .setCheck('Boolean')
            .appendField('if');
        this.appendStatementInput('DO0')
            .appendField('do');
        this.appendStatementInput('ELSE')
            .appendField('else');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('If-else control statement');
    }
};

// Bloco For
Blockly.Blocks['controls_for_java'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('for')
            .appendField(new Blockly.FieldTextInput('i'), 'VAR')
            .appendField('from')
            .appendField(new Blockly.FieldNumber(0), 'FROM')
            .appendField('to')
            .appendField(new Blockly.FieldNumber(10), 'TO')
            .appendField('step')
            .appendField(new Blockly.FieldNumber(1), 'STEP');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('For loop with variable');
    }
};

// Bloco While
Blockly.Blocks['controls_while_java'] = {
    init: function() {
        this.appendValueInput('CONDITION')
            .setCheck('Boolean')
            .appendField('while');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('While loop');
    }
};

// Try-Catch Block
Blockly.Blocks['controls_try_catch'] = {
    init: function() {
        this.appendStatementInput('TRY')
            .setCheck(null)
            .appendField('try');
        this.appendStatementInput('CATCH')
            .setCheck(null)
            .appendField('catch')
            .appendField(new Blockly.FieldTextInput('Exception'), 'EXCEPTION_TYPE')
            .appendField(new Blockly.FieldTextInput('e'), 'EXCEPTION_VAR');
        this.appendStatementInput('FINALLY')
            .setCheck(null)
            .appendField('finally');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('Try-Catch-Finally block');
    }
};

// Return Block
Blockly.Blocks['controls_return'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('return');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null); // Return geralmente Ã© a Ãºltima declaraÃ§Ã£o
        this.setColour("#E53935");
        this.setTooltip('Return statement');
    }
};

// Geradores de cÃ³digo para os blocos de controle
Blockly.JavaScript['controls_if_java'] = function(block) {
    var condition = Blockly.JavaScript.valueToCode(block, 'IF0', Blockly.JavaScript.ORDER_NONE) || 'false';
    var thenBranch = Blockly.JavaScript.statementToCode(block, 'DO0');
    var elseBranch = Blockly.JavaScript.statementToCode(block, 'ELSE');
    
    return `if (${condition}) {
        ${thenBranch}
    } else {
        ${elseBranch}
    }\n`;
};

Blockly.JavaScript['controls_for_java'] = function(block) {
    var variable = block.getFieldValue('VAR');
    var from = block.getFieldValue('FROM');
    var to = block.getFieldValue('TO');
    var step = block.getFieldValue('STEP');
    var branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `for (int ${variable} = ${from}; ${variable} <= ${to}; ${variable} += ${step}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_while_java'] = function(block) {
    var condition = Blockly.JavaScript.valueToCode(block, 'CONDITION', Blockly.JavaScript.ORDER_NONE) || 'false';
    var branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `while (${condition}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_try_catch'] = function(block) {
    var tryCode = Blockly.JavaScript.statementToCode(block, 'TRY') || '';
    var catchCode = Blockly.JavaScript.statementToCode(block, 'CATCH') || '';
    var finallyCode = Blockly.JavaScript.statementToCode(block, 'FINALLY') || '';
    var exceptionType = block.getFieldValue('EXCEPTION_TYPE');
    var exceptionVar = block.getFieldValue('EXCEPTION_VAR');
    
    var code = 'try {\n' + 
        tryCode + 
        '} catch (' + exceptionType + ' ' + exceptionVar + ') {\n' +
        catchCode;

    if (finallyCode) {
        code += '} finally {\n' + finallyCode;
    }
    
    return code + '}\n';
};

Blockly.JavaScript['controls_return'] = function(block) {
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return 'return ' + value + ';\n';
};

js/blocks/dictionary_blocks.js:
// Criar HashMap
Blockly.Blocks['dict_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('novo HashMap<')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Object', 'Object']
            ]), 'KEY_TYPE')
            .appendField(',')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Object', 'Object']
            ]), 'VALUE_TYPE')
            .appendField('>');
        this.setOutput(true, 'HashMap');
        this.setColour("#43A047");
        this.setTooltip('Cria um novo HashMap');
    }
};

// Obter valor
Blockly.Blocks['dict_get'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('obter valor');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('com chave');
        this.setOutput(true, null);
        this.setColour("#43A047");
        this.setTooltip('ObtÃ©m um valor do HashMap');
    }
};

// Definir valor
Blockly.Blocks['dict_set'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('definir em');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('chave');
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('valor');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#43A047");
        this.setTooltip('Define um valor no HashMap');
    }
};

// Remover valor
Blockly.Blocks['dict_remove'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('remover de');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('chave');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#43A047");
        this.setTooltip('Remove um valor do HashMap');
    }
};

// Verificar chave
Blockly.Blocks['dict_containsKey'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('contÃ©m chave');
        this.appendValueInput('KEY')
            .setCheck(null);
        this.setOutput(true, 'Boolean');
        this.setColour("#43A047");
        this.setTooltip('Verifica se o HashMap contÃ©m uma chave');
    }
};

// Geradores de cÃ³digo para dicionÃ¡rios
Blockly.JavaScript['dict_create'] = function(block) {
    var keyType = block.getFieldValue('KEY_TYPE');
    var valueType = block.getFieldValue('VALUE_TYPE');
    return [`new HashMap<${keyType}, ${valueType}>()`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_get'] = function(block) {
    var dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    var key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${dict}.get(${key})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_set'] = function(block) {
    var dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    var key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return `${dict}.put(${key}, ${value});\n`;
};

Blockly.JavaScript['dict_remove'] = function(block) {
    var dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    var key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return `${dict}.remove(${key});\n`;
};

Blockly.JavaScript['dict_containsKey'] = function(block) {
    var dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    var key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${dict}.containsKey(${key})`, Blockly.JavaScript.ORDER_ATOMIC];
};


js/blocks/functions.js:
// FunÃ§Ã£o sem retorno
Blockly.Blocks['procedures_defnoreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('procedimento')
            .appendField(new Blockly.FieldTextInput('nome'), 'NAME');
        this.appendStatementInput('STACK')
            .appendField('faÃ§a');
        this.setColour('#827717');
        this.setTooltip('Cria uma funÃ§Ã£o sem valor de retorno');
        this.setHelpUrl('');
    }
};

// FunÃ§Ã£o com retorno
Blockly.Blocks['procedures_defreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('funÃ§Ã£o')
            .appendField(new Blockly.FieldTextInput('nome'), 'NAME');
        this.appendStatementInput('STACK')
            .appendField('faÃ§a');
        this.appendValueInput('RETURN')
            .appendField('retornar');
        this.setColour('#827717');
        this.setTooltip('Cria uma funÃ§Ã£o que retorna um valor');
        this.setHelpUrl('');
    }
};

// Retorno condicional
Blockly.Blocks['procedures_ifreturn'] = {
    init: function() {
        this.appendValueInput('CONDITION')
            .setCheck('Boolean')
            .appendField('se');
        this.appendValueInput('VALUE')
            .appendField('retornar');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour('#827717');
        this.setTooltip('Retorna um valor se a condiÃ§Ã£o for verdadeira');
    }
};

// Chamar procedimento sem retorno
Blockly.Blocks['procedures_callnoreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('chamar')
            .appendField(new Blockly.FieldTextInput('procedimento'), 'NAME');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour('#827717');
        this.setTooltip('Chama um procedimento sem retorno');
    }
};

// Chamar funÃ§Ã£o com retorno
Blockly.Blocks['procedures_callreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('chamar funÃ§Ã£o')
            .appendField(new Blockly.FieldTextInput('funÃ§Ã£o'), 'NAME');
        this.setOutput(true, null);
        this.setColour('#827717');
        this.setTooltip('Chama uma funÃ§Ã£o que retorna um valor');
    }
};

// Bloco de retorno simples
Blockly.Blocks['function_return'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('retornar');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null);
        this.setColour('#827717');
        this.setTooltip('Retorna um valor da funÃ§Ã£o');
    }
};

// Geradores de cÃ³digo
Blockly.JavaScript['procedures_defnoreturn'] = function(block) {
    var funcName = block.getFieldValue('NAME');
    var branch = Blockly.JavaScript.statementToCode(block, 'STACK') || '';
    return `public void ${funcName}() {\n${branch}}\n`;
};

Blockly.JavaScript['procedures_defreturn'] = function(block) {
    var funcName = block.getFieldValue('NAME');
    var branch = Blockly.JavaScript.statementToCode(block, 'STACK') || '';
    var returnValue = Blockly.JavaScript.valueToCode(block, 'RETURN', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return `public Object ${funcName}() {\n${branch}return ${returnValue};\n}\n`;
};

Blockly.JavaScript['procedures_ifreturn'] = function(block) {
    var condition = Blockly.JavaScript.valueToCode(block, 'CONDITION', Blockly.JavaScript.ORDER_ATOMIC) || 'false';
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return `if (${condition}) {\n    return ${value};\n}\n`;
};

Blockly.JavaScript['procedures_callnoreturn'] = function(block) {
    var funcName = block.getFieldValue('NAME');
    return `${funcName}();\n`;
};

Blockly.JavaScript['procedures_callreturn'] = function(block) {
    var funcName = block.getFieldValue('NAME');
    return [`${funcName}()`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['function_return'] = function(block) {
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return `return ${value};\n`;
};

js/blocks/import_blocks.js:
// ImportaÃ§Ã£o Manual
Blockly.Blocks['import_manual'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import')
            .appendField(new Blockly.FieldTextInput('java.util.ArrayList'), 'IMPORT_PATH');
        this.appendDummyInput()
            .appendField(new Blockly.FieldCheckbox('FALSE'), 'IS_STATIC')
            .appendField('static')
            .appendField(new Blockly.FieldCheckbox('FALSE'), 'IS_WILDCARD')
            .appendField('.*');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('ImportaÃ§Ã£o manual de classe ou pacote');
    }
};

// Importar Pacote EspecÃ­fico
Blockly.Blocks['import_package'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import package')
            .appendField(new Blockly.FieldTextInput('com.example'), 'PACKAGE')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('util'), 'SUB_PACKAGE')
            .appendField('.*');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar todas as classes de um pacote');
    }
};

// Importar Classe EspecÃ­fica
Blockly.Blocks['import_class'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import class')
            .appendField(new Blockly.FieldTextInput('java.util.List'), 'CLASS_PATH');
        this.appendDummyInput()
            .appendField('as')
            .appendField(new Blockly.FieldTextInput(''), 'ALIAS')
            .appendField('(opcional)');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar uma classe especÃ­fica com alias opcional');
    }
};

// Importar MÃ©todo EstÃ¡tico
Blockly.Blocks['import_static'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import static')
            .appendField(new Blockly.FieldTextInput('java.lang.Math'), 'CLASS')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('*'), 'METHOD');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar mÃ©todo estÃ¡tico de uma classe');
    }
};

// Geradores de cÃ³digo
Blockly.JavaScript['import_manual'] = function(block) {
    var path = block.getFieldValue('IMPORT_PATH');
    var isStatic = block.getFieldValue('IS_STATIC') === 'TRUE';
    var isWildcard = block.getFieldValue('IS_WILDCARD') === 'TRUE';
    
    var code = 'import ';
    if (isStatic) code += 'static ';
    code += path;
    if (isWildcard) code += '.*';
    return code + ';\n';
};

Blockly.JavaScript['import_package'] = function(block) {
    var pkg = block.getFieldValue('PACKAGE');
    var subPkg = block.getFieldValue('SUB_PACKAGE');
    return `import ${pkg}.${subPkg}.*;\n`;
};

Blockly.JavaScript['import_class'] = function(block) {
    var classPath = block.getFieldValue('CLASS_PATH');
    var alias = block.getFieldValue('ALIAS');
    var code = `import ${classPath}`;
    if (alias) {
        code += ` as ${alias}`;
    }
    return code + ';\n';
};

Blockly.JavaScript['import_static'] = function(block) {
    var className = block.getFieldValue('CLASS');
    var method = block.getFieldValue('METHOD');
    return `import static ${className}.${method};\n`;
};

js/blocks/imported_class_blocks.js:
// Bloco para chamar mÃ©todo estÃ¡tico
Blockly.Blocks['imported_static_method'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput('Class'), 'CLASS_NAME')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('staticMethod'), 'METHOD_NAME')
            .appendField('(');
        this.appendStatementInput('ARGS')
            .setCheck('method_arg');
        this.appendDummyInput()
            .appendField(')');
        this.setOutput(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Chama um mÃ©todo estÃ¡tico de uma classe importada');
    }
};

// Bloco para acessar campo estÃ¡tico
Blockly.Blocks['imported_static_field'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput('Class'), 'CLASS_NAME')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('CONSTANT'), 'FIELD_NAME');
        this.setOutput(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Acessa um campo estÃ¡tico de uma classe importada');
    }
};

// Bloco para declarar tipo
Blockly.Blocks['imported_type_declaration'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE_NAME')
            .appendField(new Blockly.FieldTextInput('varName'), 'VAR_NAME')
            .appendField('=');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Declara uma variÃ¡vel com tipo importado');
    }
};

// Bloco para interface
Blockly.Blocks['imported_interface'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('implement interface')
            .appendField(new Blockly.FieldTextInput('Interface'), 'INTERFACE_NAME');
        this.appendStatementInput('METHODS')
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Implementa uma interface importada');
    }
};

// Geradores de cÃ³digo
Blockly.JavaScript['imported_static_method'] = function(block) {
    var className = block.getFieldValue('CLASS_NAME');
    var methodName = block.getFieldValue('METHOD_NAME');
    var args = Blockly.JavaScript.statementToCode(block, 'ARGS');
    args = args.trim().replace(/,\s*$/, '');
    return [`${className}.${methodName}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['imported_static_field'] = function(block) {
    var className = block.getFieldValue('CLASS_NAME');
    var fieldName = block.getFieldValue('FIELD_NAME');
    return [`${className}.${fieldName}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['imported_type_declaration'] = function(block) {
    var typeName = block.getFieldValue('TYPE_NAME');
    var varName = block.getFieldValue('VAR_NAME');
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${typeName} ${varName} = ${value};\n`;
};

Blockly.JavaScript['imported_interface'] = function(block) {
    var interfaceName = block.getFieldValue('INTERFACE_NAME');
    var methods = Blockly.JavaScript.statementToCode(block, 'METHODS');
    return `implements ${interfaceName} {\n${methods}}\n`;
};

js/blocks/list_blocks.js:
// Criar Lista
Blockly.Blocks['lists_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('nova ArrayList<')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Double', 'Double']
            ]), 'TYPE')
            .appendField('>');
        this.setOutput(true, 'ArrayList');
        this.setColour("#00ACC1");
        this.setTooltip('Cria uma nova ArrayList');
    }
};

// OperaÃ§Ãµes com Lista
Blockly.Blocks['lists_operation'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField(new Blockly.FieldDropdown([
                ['adicionar', 'ADD'],
                ['remover', 'REMOVE'],
                ['obter', 'GET'],
                ['tamanho', 'SIZE'],
                ['limpar', 'CLEAR']
            ]), 'OP');
        this.appendValueInput('ITEM')
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('OperaÃ§Ãµes com ArrayList');
    }
};

// Geradores de cÃ³digo para listas
Blockly.JavaScript['lists_create'] = function(block) {
    var type = block.getFieldValue('TYPE');
    return [`new ArrayList<${type}>()`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['lists_operation'] = function(block) {
    var list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    var item = Blockly.JavaScript.valueToCode(block, 'ITEM', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var op = block.getFieldValue('OP');
    
    switch(op) {
        case 'ADD': return `${list}.add(${item});\n`;
        case 'REMOVE': return `${list}.remove(${item});\n`;
        case 'GET': return `${list}.get(${item});\n`;
        case 'SIZE': return `${list}.size();\n`;
        case 'CLEAR': return `${list}.clear();\n`;
    }
    return '';
};

// Blocos para Listas
Blockly.Blocks['lists_get_index'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('obter item da lista');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('Ã­ndice');
        this.setOutput(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('ObtÃ©m um item da lista pelo Ã­ndice');
    }
};

Blockly.Blocks['lists_set_index'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('definir item da lista');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('Ã­ndice');
        this.appendValueInput('ITEM')
            .appendField('valor');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Define um item na lista pelo Ã­ndice');
    }
};

Blockly.Blocks['lists_forEach'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('para cada item');
        this.appendDummyInput()
            .appendField('como')
            .appendField(new Blockly.FieldTextInput('item'), 'VAR');
        this.appendStatementInput('DO')
            .appendField('fazer');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Executa aÃ§Ãµes para cada item da lista');
    }
};

// Blocos para MatemÃ¡tica
Blockly.Blocks['math_number'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldNumber(0), 'NUM');
        this.setOutput(true, 'Number');
        this.setColour(230);
        this.setTooltip('Um nÃºmero');
    }
};

Blockly.Blocks['math_constant'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['Ï€', 'Math.PI'],
                ['e', 'Math.E'],
                ['Ï†', '1.618034'],
                ['âˆš2', 'Math.SQRT2'],
                ['âˆšÂ½', 'Math.SQRT1_2']
            ]), 'CONSTANT');
        this.setOutput(true, 'Number');
        this.setColour(230);
        this.setTooltip('Constantes matemÃ¡ticas');
    }
};

// Blocos para Texto
Blockly.Blocks['text_charAt'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('caractere da string');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('na posiÃ§Ã£o');
        this.setOutput(true, 'String');
        this.setColour(160);
        this.setTooltip('Retorna o caractere na posiÃ§Ã£o especificada');
    }
};

Blockly.Blocks['text_indexOf'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('posiÃ§Ã£o em');
        this.appendValueInput('FIND')
            .setCheck('String')
            .appendField('encontrar');
        this.setOutput(true, 'Number');
        this.setColour(160);
        this.setTooltip('Retorna a posiÃ§Ã£o de uma string dentro de outra');
    }
};

// Blocos para LÃ³gica
Blockly.Blocks['logic_boolean'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['verdadeiro', 'true'],
                ['falso', 'false']
            ]), 'BOOL');
        this.setOutput(true, 'Boolean');
        this.setColour(290);
        this.setTooltip('Valor booleano verdadeiro ou falso');
    }
};

Blockly.Blocks['logic_null'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('null');
        this.setOutput(true, null);
        this.setColour(290);
        this.setTooltip('Valor nulo');
    }
};

// Geradores de cÃ³digo para os blocos
Blockly.JavaScript['lists_get_index'] = function(block) {
    var list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    var index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [`${list}.get(${index})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['lists_set_index'] = function(block) {
    var list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    var index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    var item = Blockly.JavaScript.valueToCode(block, 'ITEM', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${list}.set(${index}, ${item});\n`;
};

Blockly.JavaScript['lists_forEach'] = function(block) {
    var list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    var varName = block.getFieldValue('VAR');
    var branch = Blockly.JavaScript.statementToCode(block, 'DO') || '';
    return `for (${varName} : ${list}) {\n${branch}}\n`;
};

Blockly.JavaScript['math_number'] = function(block) {
    var number = block.getFieldValue('NUM');
    return [number, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_constant'] = function(block) {
    var constant = block.getFieldValue('CONSTANT');
    return [constant, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_charAt'] = function(block) {
    var string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [`${string}.charAt(${index})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_indexOf'] = function(block) {
    var string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var find = Blockly.JavaScript.valueToCode(block, 'FIND', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${string}.indexOf(${find})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_boolean'] = function(block) {
    var bool = block.getFieldValue('BOOL');
    return [bool, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_null'] = function(block) {
    return ['null', Blockly.JavaScript.ORDER_ATOMIC];
};

js/blocks/logic_blocks.js:
// ComparaÃ§Ãµes
Blockly.Blocks['logic_compare'] = {
    init: function() {
        this.appendValueInput('A')
            .setCheck(null);
        this.appendValueInput('B')
            .setCheck(null)
            .appendField(new Blockly.FieldDropdown([
                ['=', 'EQ'],
                ['â‰ ', 'NEQ'],
                ['<', 'LT'],
                ['â‰¤', 'LTE'],
                ['>', 'GT'],
                ['â‰¥', 'GTE']
            ]), 'OP');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Compara dois valores');
    }
};

// OperaÃ§Ãµes lÃ³gicas com mÃºltiplas entradas
Blockly.Blocks['logic_operation'] = {
    init: function() {
        this.setHelpUrl('');
        this.setColour("#FDD835");
        this.itemCount_ = 2;
        this.updateShape_();
        this.setOutput(true, 'Boolean');
        this.setMutator(new Blockly.Mutator(['logic_operation_item']));
        this.setTooltip('Combina valores booleanos com AND/OR');
    },

    mutationToDom: function() {
        var container = document.createElement('mutation');
        container.setAttribute('items', this.itemCount_);
        return container;
    },

    domToMutation: function(xmlElement) {
        this.itemCount_ = parseInt(xmlElement.getAttribute('items'), 10);
        this.updateShape_();
    },

    decompose: function(workspace) {
        var containerBlock = workspace.newBlock('logic_operation_container');
        containerBlock.initSvg();
        
        var connection = containerBlock.getInput('STACK').connection;
        for (var i = 0; i < this.itemCount_; i++) {
            var itemBlock = workspace.newBlock('logic_operation_item');
            itemBlock.initSvg();
            connection.connect(itemBlock.previousConnection);
            connection = itemBlock.nextConnection;
        }
        
        return containerBlock;
    },

    compose: function(containerBlock) {
        var itemBlock = containerBlock.getInputTargetBlock('STACK');
        var connections = [];
        while (itemBlock) {
            connections.push(itemBlock.valueConnection_);
            itemBlock = itemBlock.nextConnection &&
                itemBlock.nextConnection.targetBlock();
        }
        
        this.itemCount_ = connections.length;
        this.updateShape_();
        
        for (var i = 0; i < this.itemCount_; i++) {
            if (connections[i]) {
                this.getInput('ADD' + i).connection.connect(connections[i]);
            }
        }
    },

    updateShape_: function() {
        var i = 0;
        while (this.getInput('ADD' + i)) {
            this.removeInput('ADD' + i);
            i++;
        }

        if (!this.getInput('OP')) {
            this.appendDummyInput('OP')
                .appendField(new Blockly.FieldDropdown([
                    ['and', 'AND'],
                    ['or', 'OR']
                ]), 'OP');
        }

        for (var i = 0; i < this.itemCount_; i++) {
            var input = this.appendValueInput('ADD' + i)
                .setCheck('Boolean');
            if (i === 0) {
                input.appendField('');
            }
        }

        if (this.itemCount_ === 0) {
            this.appendDummyInput('EMPTY')
                .appendField('(vazio)');
        }
    }
};

// NegaÃ§Ã£o
Blockly.Blocks['logic_negate'] = {
    init: function() {
        this.appendValueInput('BOOL')
            .setCheck('Boolean')
            .appendField('not');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Nega um valor booleano');
    }
};

// Booleano
Blockly.Blocks['logic_boolean'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['true', 'TRUE'],
                ['false', 'FALSE']
            ]), 'BOOL');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Retorna verdadeiro ou falso');
    }
};

// Nulo
Blockly.Blocks['logic_null'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('null');
        this.setOutput(true, null);
        this.setColour("#FDD835");
        this.setTooltip('Retorna um valor nulo');
    }
};

// Blocos do mutator para logic_operation
Blockly.Blocks['logic_operation_container'] = {
    init: function() {
        this.setColour("#FDD835");
        this.appendDummyInput()
            .appendField('entradas');
        this.appendStatementInput('STACK');
        this.setTooltip("Adicione, remova ou reordene as entradas");
        this.contextMenu = false;
    }
};

Blockly.Blocks['logic_operation_item'] = {
    init: function() {
        this.setColour("#FDD835");
        this.appendDummyInput()
            .appendField('valor booleano');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
        this.setTooltip("Adiciona uma nova entrada booleana");
        this.contextMenu = false;
    }
};

// Geradores de cÃ³digo
Blockly.JavaScript['logic_compare'] = function(block) {
    var a = Blockly.JavaScript.valueToCode(block, 'A', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    var b = Blockly.JavaScript.valueToCode(block, 'B', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    var op = block.getFieldValue('OP');
    
    var code = '';
    switch(op) {
        case 'EQ': code = `${a}.equals(${b})`; break;
        case 'NEQ': code = `!${a}.equals(${b})`; break;
        case 'LT': code = `${a} < ${b}`; break;
        case 'LTE': code = `${a} <= ${b}`; break;
        case 'GT': code = `${a} > ${b}`; break;
        case 'GTE': code = `${a} >= ${b}`; break;
    }
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_operation'] = function(block) {
    var operator = block.getFieldValue('OP');
    var code = [];
    
    for (var i = 0; i < block.itemCount_; i++) {
        var value = Blockly.JavaScript.valueToCode(block, 'ADD' + i,
            Blockly.JavaScript.ORDER_ATOMIC) || 'false';
        code.push(value);
    }
    
    var operation = (operator === 'AND') ? ' && ' : ' || ';
    return ['(' + code.join(operation) + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_negate'] = function(block) {
    var bool = Blockly.JavaScript.valueToCode(block, 'BOOL', Blockly.JavaScript.ORDER_ATOMIC) || 'false';
    return [`!${bool}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_boolean'] = function(block) {
    var code = (block.getFieldValue('BOOL') === 'TRUE') ? 'true' : 'false';
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_null'] = function(block) {
    return ['null', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_operation_container'] = function(block) {
    return null;
};

Blockly.JavaScript['logic_operation_item'] = function(block) {
    return null;
};

js/blocks/math_blocks.js:
// Number block
Blockly.Blocks['math_number'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldNumber(0), 'NUM');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('A number');
    }
};

// Multiple Math Operations
Blockly.Blocks['math_operation'] = {
    init: function() {
        this.setHelpUrl('');
        this.setColour("#8E24AA");
        this.itemCount_ = 2;
        this.updateShape_();
        this.setOutput(true, 'Number');
        this.setMutator(new Blockly.Mutator(['math_operation_item']));
        this.setTooltip('Combines numbers with mathematical operations');
    },

    mutationToDom: function() {
        var container = document.createElement('mutation');
        container.setAttribute('items', this.itemCount_);
        return container;
    },

    domToMutation: function(xmlElement) {
        this.itemCount_ = parseInt(xmlElement.getAttribute('items'), 10);
        this.updateShape_();
    },

    decompose: function(workspace) {
        var containerBlock = workspace.newBlock('math_operation_container');
        containerBlock.initSvg();
        
        var connection = containerBlock.getInput('STACK').connection;
        for (var i = 0; i < this.itemCount_ - 1; i++) {
            var itemBlock = workspace.newBlock('math_operation_item');
            itemBlock.initSvg();
            connection.connect(itemBlock.previousConnection);
            connection = itemBlock.nextConnection;
        }
        
        return containerBlock;
    },

    compose: function(containerBlock) {
        var itemBlock = containerBlock.getInputTargetBlock('STACK');
        var connections = [];
        var operators = [];
        while (itemBlock) {
            connections.push(itemBlock.valueConnection_);
            operators.push(itemBlock.getFieldValue('OP'));
            itemBlock = itemBlock.nextConnection &&
                itemBlock.nextConnection.targetBlock();
        }
        
        this.itemCount_ = connections.length + 1;
        this.updateShape_();
        
        for (var i = 1; i < this.itemCount_; i++) {
            if (operators[i-1]) {
                this.getField('OP' + i).setValue(operators[i-1]);
            }
            if (connections[i-1]) {
                this.getInput('NUM' + i).connection.connect(connections[i-1]);
            }
        }
    },

    updateShape_: function() {
        if (!this.getInput('NUM0')) {
            this.appendValueInput('NUM0')
                .setCheck('Number');
        }

        var i = 1;
        while (this.getInput('NUM' + i)) {
            this.removeInput('NUM' + i);
            i++;
        }

        for (var i = 1; i < this.itemCount_; i++) {
            this.appendValueInput('NUM' + i)
                .setCheck('Number')
                .appendField(new Blockly.FieldDropdown([
                    ['+', 'ADD'],
                    ['-', 'SUBTRACT'],
                    ['Ã—', 'MULTIPLY'],
                    ['Ã·', 'DIVIDE'],
                    ['%', 'MODULO'],
                    ['^', 'POWER']
                ]), 'OP' + i);
        }
    }
};

// Container block for mutator
Blockly.Blocks['math_operation_container'] = {
    init: function() {
        this.setColour("#8E24AA");
        this.appendDummyInput()
            .appendField('numbers');
        this.appendStatementInput('STACK');
        this.setTooltip('Add numbers for math operations');
        this.contextMenu = false;
    }
};

// Item block for mutator
Blockly.Blocks['math_operation_item'] = {
    init: function() {
        this.setColour("#8E24AA");
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['+', 'ADD'],
                ['-', 'SUBTRACT'],
                ['Ã—', 'MULTIPLY'],
                ['Ã·', 'DIVIDE'],
                ['%', 'MODULO'],
                ['^', 'POWER']
            ]), 'OP');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
        this.setTooltip('Adds a new number with operator');
        this.contextMenu = false;
    }
};

// Math functions
Blockly.Blocks['math_function'] = {
    init: function() {
        this.appendValueInput('NUMBER')
            .setCheck('Number')
            .appendField(new Blockly.FieldDropdown([
                ['abs', 'Math.abs'],
                ['sqrt', 'Math.sqrt'],
                ['pow', 'Math.pow'],
                ['sin', 'Math.sin'],
                ['cos', 'Math.cos'],
                ['tan', 'Math.tan'],
                ['round', 'Math.round'],
                ['ceil', 'Math.ceil'],
                ['floor', 'Math.floor'],
                ['log', 'Math.log'],
                ['log10', 'Math.log10'],
                ['exp', 'Math.exp']
            ]), 'FUNC');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('Advanced mathematical functions');
    }
};

// Random with options
Blockly.Blocks['math_random'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('random')
            .appendField(new Blockly.FieldDropdown([
                ['number between', 'INT'],
                ['decimal between', 'FLOAT'],
                ['decimal 0-1', 'RANDOM'],
                ['boolean', 'BOOL']
            ]), 'TYPE');
        this.appendValueInput('MIN')
            .setCheck('Number')
            .appendField('min');
        this.appendValueInput('MAX')
            .setCheck('Number')
            .appendField('max');
        this.setOutput(true, ['Number', 'Boolean']);
        this.setColour("#8E24AA");
        this.setTooltip('Generates random numbers');
        this.updateShape_();
    },

    updateShape_: function() {
        var type = this.getFieldValue('TYPE');
        if (type === 'RANDOM' || type === 'BOOL') {
            if (this.getInput('MIN')) this.removeInput('MIN');
            if (this.getInput('MAX')) this.removeInput('MAX');
        } else {
            if (!this.getInput('MIN')) {
                this.appendValueInput('MIN')
                    .setCheck('Number')
                    .appendField('min');
            }
            if (!this.getInput('MAX')) {
                this.appendValueInput('MAX')
                    .setCheck('Number')
                    .appendField('max');
            }
        }
    },

    onchange: function() {
        this.updateShape_();
    }
};

// Mathematical constants
Blockly.Blocks['math_constant'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['Ï€', 'Math.PI'],
                ['e', 'Math.E'],
                ['Ï† (phi)', '1.618034'],
                ['âˆš2', 'Math.SQRT2'],
                ['âˆšÂ½', 'Math.SQRT1_2'],
                ['âˆž', 'Infinity']
            ]), 'CONSTANT');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('Mathematical constants');
    }
};

// Code Generators
Blockly.JavaScript['math_number'] = function(block) {
    var number = block.getFieldValue('NUM');
    return [number, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_operation'] = function(block) {
    var code = [];
    
    code.push(Blockly.JavaScript.valueToCode(block, 'NUM0', Blockly.JavaScript.ORDER_ATOMIC) || '0');
    
    for (var i = 1; i < block.itemCount_; i++) {
        var operator = block.getFieldValue('OP' + i);
        var value = Blockly.JavaScript.valueToCode(block, 'NUM' + i, Blockly.JavaScript.ORDER_ATOMIC) || '0';
        
        switch(operator) {
            case 'ADD': code.push('+', value); break;
            case 'SUBTRACT': code.push('-', value); break; 
            case 'MULTIPLY': code.push('*', value); break; 
            case 'DIVIDE': code.push('/', value); break;
            case 'MODULO': code.push('%', value); break;
            case 'POWER': code.push('Math.pow(' + code.pop() + ',', value + ')'); break;
        }
    }
    
    return ['(' + code.join(' ') + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_constant'] = function(block) {
    var constant = block.getFieldValue('CONSTANT');
    return [constant, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_function'] = function(block) {
    var func = block.getFieldValue('FUNC');
    var number = Blockly.JavaScript.valueToCode(block, 'NUMBER', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [func + '(' + number + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_random'] = function(block) {
    var type = block.getFieldValue('TYPE');
    var code;
    
    switch(type) {
        case 'INT':
            var min = Blockly.JavaScript.valueToCode(block, 'MIN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
            var max = Blockly.JavaScript.valueToCode(block, 'MAX', Blockly.JavaScript.ORDER_ATOMIC) || '100';
            code = `Math.floor(Math.random() * (${max} - ${min} + 1) + ${min})`;
            break;
        case 'FLOAT':
            var min = Blockly.JavaScript.valueToCode(block, 'MIN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
            var max = Blockly.JavaScript.valueToCode(block, 'MAX', Blockly.JavaScript.ORDER_ATOMIC) || '1';
            code = `(Math.random() * (${max} - ${min}) + ${min})`;
            break;
        case 'RANDOM':
            code = 'Math.random()';
            break;
        case 'BOOL':
            code = 'Math.random() >= 0.5';
            break;
    }
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_operation_container'] = function(block) {
    return null;
};

Blockly.JavaScript['math_operation_item'] = function(block) {
    return null;
};


js/blocks/method_inserts.js:
//blocks/method_inserts.js
'use strict';
Blockly.Blocks['post_runnable'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".post new Runnable");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Executes code inside a Runnable using post with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['post_runnable'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.post(new Runnable() {\n    @Override\n    public void run() {\n${content}    }\n});\n`;
};

Blockly.Blocks['run_on_ui_thread'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".$form().runOnUiThread");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Runs code on the UI thread with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['run_on_ui_thread'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.runOnUiThread(new Runnable() {\n    @Override\n    public void run() {\n${content}    }\n});\n`;
};


Blockly.Blocks['set_on_click_listener'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".setOnClickListener");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Sets an OnClickListener with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['set_on_click_listener'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.setOnClickListener(new View.OnClickListener() {\n    @Override\n    public void onClick(View v) {\n${content}    }\n});\n`;
};

Blockly.Blocks['add_text_view'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".addTextView");
        this.appendValueInput("TEXT")
            .setCheck("String")
            .appendField("with text");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Adds a TextView with specified text to a layout.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['add_text_view'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const text = Blockly.JavaScript.valueToCode(block, 'TEXT', Blockly.JavaScript.ORDER_ATOMIC);
    return `${prefix}.addView(new TextView(context) {{ setText(${text}); }});\n`;
};

Blockly.Blocks['add_image_view'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".addImageView");
        this.appendValueInput("IMAGE_PATH")
            .setCheck("String")
            .appendField("with image path");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Adds an ImageView with the specified image path.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['add_image_view'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const imagePath = Blockly.JavaScript.valueToCode(block, 'IMAGE_PATH', Blockly.JavaScript.ORDER_ATOMIC);
    return `${prefix}.addView(new ImageView(context) {{ setImageURI(Uri.parse(${imagePath})); }});\n`;
};

Blockly.Blocks['scroll_to_bottom'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".scrollToBottom");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Scrolls a ScrollView to the bottom.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['scroll_to_bottom'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    return `${prefix}.post(new Runnable() {\n    @Override\n    public void run() {\n        ${prefix}.fullScroll(View.FOCUS_DOWN);\n    }\n});\n`;
};

Blockly.Blocks['show_toast'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Show Toast");
        this.appendValueInput("MESSAGE")
            .setCheck("String")
            .appendField("message");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Shows a toast message.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['show_toast'] = function(block) {
    const message = Blockly.JavaScript.valueToCode(block, 'MESSAGE', Blockly.JavaScript.ORDER_ATOMIC);
    return `Toast.makeText(context, ${message}, Toast.LENGTH_SHORT).show();\n`;
};



js/blocks/methods.js:
//blocks/methods.js
'use strict';

//blocks
// Function return block for methods
Blockly.Blocks['method_return'] = {
    init: function() {
        this.appendValueInput('RETURN_VALUE')
            .setCheck(null)
            .appendField('return');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null); // Does not allow following block
        this.setColour("#7CB342"); // Same color as methods
        this.setTooltip('Returns a value from the method');
    }
};

Blockly.Blocks['method_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['parameter'] = {
    init: function() {
        this.setColour("#7CB342");
        this.appendDummyInput()
            .appendField('parameter');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
    }
};

// Updated method block with content field
Blockly.Blocks['method_declaration'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("myMethod"), "METHOD_NAME")
            .appendField("return")
            .appendField(new Blockly.FieldDropdown([
                ["void", "void"],
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "RETURN_TYPE");
        this.appendDummyInput("DESCRIPTION")
            .appendField("description")
            .appendField(new Blockly.FieldTextInput("A custom method"), "DESCRIPTION");
        this.appendStatementInput("METHOD_CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setMutator(new Blockly.Mutator(['method_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Declares a method with customizable parameters.");
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            paramNode.setAttribute('final', param.final);
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type'),
                final: param.getAttribute('final') === 'true'
            });
        });
        this.updateShape_();
    },

    updateShape_: function() {
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => (param.final ? 'final ' : '') + `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};


Blockly.Blocks['method_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("TRUE"), "FINAL");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for a method.");
    }
};

//Events
Blockly.Blocks['event_declaration'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("MyEvent"), "EVENT_NAME")
            .appendField("parameters");
        this.appendDummyInput("DESCRIPTION")
            .appendField("description")
            .appendField(new Blockly.FieldTextInput("A custom event"), "DESCRIPTION");
        this.appendStatementInput("EVENT_CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setMutator(new Blockly.Mutator(['event_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Declares an event with customizable parameters.");
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            paramNode.setAttribute('final', param.final);
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type'),
                final: param.getAttribute('final') === 'true'
            });
        });
        this.updateShape_();
    },

    updateShape_: function() {
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => (param.final ? 'final ' : '') + `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};


Blockly.Blocks['event_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove event parameters.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['event_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("TRUE"), "FINAL");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for an event.");
    }
};


Blockly.Blocks['custom_dispatcher'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("Dispatcher"), "EVENT_NAME")
            .appendField("parameters");
        this.appendDummyInput("PARAMETERS")
            .appendField("content");
        this.setMutator(new Blockly.Mutator(['custom_dispatcher_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Custom Event Dispatcher with dynamic parameters.");
    },
    
    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            container.appendChild(paramNode);
        });
        return container;
    },
    
    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type')
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('custom_dispatcher_mutator');
        containerBlock.initSvg();
        const connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('custom_dispatcher_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        this.paramCount_ = 0;
        this.paramNames_ = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME');
            const paramType = paramBlock.getFieldValue('PARAM_TYPE');

            this.paramCount_++;
            this.paramNames_.push({
                name: paramName,
                type: paramType
            });
            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.updateShape_();
    },

    updateShape_: function() {
        // Remove the old parameter display
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        // Add the new parameter display
        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};


Blockly.Blocks['custom_dispatcher_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the custom dispatcher.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['custom_dispatcher_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the custom dispatcher.");
    }
};

Blockly.Blocks['method_call'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField("call method")
            .appendField(new Blockly.FieldTextInput("Method Name"), "METHOD_NAME");
        this.setMutator(new Blockly.Mutator(['custom_dispatcher_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Call a method with dynamic parameters.");
    },
    
    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            container.appendChild(paramNode);
        });
        return container;
    },
    
    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type')
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('call_event_mutator');
        containerBlock.initSvg();
        const connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('call_event_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        this.paramCount_ = 0;
        this.paramNames_ = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME');
            const paramType = paramBlock.getFieldValue('PARAM_TYPE');

            this.paramCount_++;
            this.paramNames_.push({
                name: paramName,
                type: paramType
            });
            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.updateShape_();
    },

    updateShape_: function() {
        // Remove the old parameter display
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        // Add the new parameter display
        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};



Blockly.Blocks['call_event_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the custom dispatcher.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['call_event_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the custom dispatcher.");
    }
};



//generators

Blockly.JavaScript['method_call'] = function(block) {
    const eventName = block.getFieldValue('METHOD_NAME');
    const content = Blockly.JavaScript.statementToCode(block, 'EVENT_CONTENT');

    // Coleta os parÃ¢metros diretamente do `paramNames_`
    const parameters = block.paramNames_ || [];

    // Junta os parÃ¢metros no formato "tipo nome" para o cabeÃ§alho
    const paramString = parameters.map(param => `${param.type} ${param.name}`).join(', ');

    // Apenas os nomes dos parÃ¢metros para usar no `EventDispatcher.dispatchEvent`
    const paramNames = parameters.map(param => param.name).join(', ');

    // Gera o evento com os parÃ¢metros no cabeÃ§alho e no dispatcher
    return `${eventName}"(${paramNames});\n`;
};



Blockly.JavaScript['event_declaration'] = function(block) {
    const eventName = block.getFieldValue('EVENT_NAME');
    const description = block.getFieldValue('DESCRIPTION');
    const content = Blockly.JavaScript.statementToCode(block, 'EVENT_CONTENT');

    const parameters = block.paramNames_ || [];
    const paramString = parameters.map(param => (param.final ? 'final ' : '') + `${param.type} ${param.name}`).join(', ');

    return `    @SimpleEvent(description = "${description}")
    public void ${eventName}(${paramString}) {
${content}
    }\n`;
};


Blockly.JavaScript['custom_dispatcher'] = function(block) {
    const eventName = block.getFieldValue('EVENT_NAME');
    const content = Blockly.JavaScript.statementToCode(block, 'EVENT_CONTENT');

    // Coleta os parÃ¢metros diretamente do `paramNames_`
    const parameters = block.paramNames_ || [];

    // Junta os parÃ¢metros no formato "tipo nome" para o cabeÃ§alho
    const paramString = parameters.map(param => `${param.type} ${param.name}`).join(', ');

    // Apenas os nomes dos parÃ¢metros para usar no `EventDispatcher.dispatchEvent`
    const paramNames = parameters.map(param => param.name).join(', ');

    // Gera o evento com os parÃ¢metros no cabeÃ§alho e no dispatcher
    return `       EventDispatcher.dispatchEvent(this, "${eventName}", ${paramNames});\n`;
};

Blockly.JavaScript['method_parameter'] = function(block) {
    const paramName = block.getFieldValue('PARAM_NAME');
    const paramType = block.getFieldValue('PARAM_TYPE');
    const paramFinal = block.getFieldValue('FINAL') === 'TRUE';

    // Retorna o parÃ¢metro formatado como "tipo nome"
    return (paramFinal ? 'final ' : '') + `${paramType} ${paramName}`;
};

Blockly.JavaScript['method_declaration'] = function(block) {
    const methodName = block.getFieldValue('METHOD_NAME');
    const description = block.getFieldValue('DESCRIPTION');
    const returnType = block.getFieldValue('RETURN_TYPE');
    const content = Blockly.JavaScript.statementToCode(block, 'METHOD_CONTENT');

    const parameters = block.paramNames_ || [];
    const paramString = parameters.map(param => (param.final ? 'final ' : '') + `${param.type} ${param.name}`).join(', ');

    return `    @SimpleFunction(description = "${description}")
    public ${returnType} ${methodName}(${paramString}) {
${content}
    }\n`;
};

Blockly.JavaScript['method_return'] = function(block) {
    var returnValue = Blockly.JavaScript.valueToCode(block, 'RETURN_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return `        return ${returnValue};\n`;
};

js/blocks/object_blocks.js:
// Criar Objeto
Blockly.Blocks['object_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('new')
            .appendField(new Blockly.FieldTextInput('Object'), 'CLASS_NAME');
        this.appendStatementInput('CONSTRUCTOR_ARGS')
            .setCheck('constructor_arg')
            .appendField('argumentos');
        this.setOutput(true, 'Object');
        this.setColour("#F4511E");;
        this.setTooltip('Cria uma nova instÃ¢ncia de objeto');
    }
};

// Argumento do Construtor
Blockly.Blocks['constructor_arg'] = {
    init: function() {
        this.appendValueInput('ARG_VALUE')
            .setCheck(null)
            .appendField(new Blockly.FieldTextInput('arg'), 'ARG_NAME');
        this.setPreviousStatement(true, 'constructor_arg');
        this.setNextStatement(true, 'constructor_arg');
        this.setColour("#F4511E");;
        this.setTooltip('Argumento para construtor');
    }
};

// Acessar Campo
Blockly.Blocks['object_get_field'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('field'), 'FIELD_NAME');
        this.setOutput(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Acessa um campo do objeto');
    }
};

// Definir Campo
Blockly.Blocks['object_set_field'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('field'), 'FIELD_NAME')
            .appendField('=');
        this.appendValueInput('VALUE')
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Define o valor de um campo do objeto');
    }
};

// Chamar MÃ©todo
Blockly.Blocks['object_call_method'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('method'), 'METHOD_NAME')
            .appendField('(');
        this.appendStatementInput('ARGS')
            .setCheck('method_arg');
        this.appendDummyInput()
            .appendField(')');
        this.setOutput(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Chama um mÃ©todo do objeto');
    }
};

// Argumento de MÃ©todo
Blockly.Blocks['method_arg'] = {
    init: function() {
        this.appendValueInput('ARG_VALUE')
            .setCheck(null);
        this.setPreviousStatement(true, 'method_arg');
        this.setNextStatement(true, 'method_arg');
        this.setColour("#F4511E");;
        this.setTooltip('Argumento para mÃ©todo');
    }
};

// Instanceof
Blockly.Blocks['object_instance_of'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('instanceof')
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE');
        this.setOutput(true, 'Boolean');
        this.setColour("#F4511E");;
        this.setTooltip('Verifica se o objeto Ã© instÃ¢ncia de um tipo');
    }
};

// Cast
Blockly.Blocks['object_cast'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object')
            .appendField('(')
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE')
            .appendField(')');
        this.setOutput(true, 'Object');
        this.setColour("#F4511E");;
        this.setTooltip('Converte o objeto para outro tipo');
    }
};

// Geradores de cÃ³digo
Blockly.JavaScript['object_create'] = function(block) {
    var className = block.getFieldValue('CLASS_NAME');
    var args = Blockly.JavaScript.statementToCode(block, 'CONSTRUCTOR_ARGS');
    args = args.trim().replace(/,\s*$/, ''); // Remove Ãºltima vÃ­rgula
    return [`new ${className}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['constructor_arg'] = function(block) {
    var value = Blockly.JavaScript.valueToCode(block, 'ARG_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return value + ', ';
};

Blockly.JavaScript['object_get_field'] = function(block) {
    var object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    var field = block.getFieldValue('FIELD_NAME');
    return [`${object}.${field}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['object_set_field'] = function(block) {
    var object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    var field = block.getFieldValue('FIELD_NAME');
    var value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${object}.${field} = ${value};\n`;
};

Blockly.JavaScript['object_call_method'] = function(block) {
    var object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    var method = block.getFieldValue('METHOD_NAME');
    var args = Blockly.JavaScript.statementToCode(block, 'ARGS');
    args = args.trim().replace(/,\s*$/, ''); // Remove Ãºltima vÃ­rgula
    return [`${object}.${method}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['method_arg'] = function(block) {
    var value = Blockly.JavaScript.valueToCode(block, 'ARG_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return value + ', ';
};

Blockly.JavaScript['object_instance_of'] = function(block) {
    var object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    var type = block.getFieldValue('TYPE');
    return [`${object} instanceof ${type}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['object_cast'] = function(block) {
    var object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    var type = block.getFieldValue('TYPE');
    return [`(${type}) ${object}`, Blockly.JavaScript.ORDER_ATOMIC];
};

js/blocks/text_blocks.js:
// Texto simples
Blockly.Blocks['text_string'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('"')
            .appendField(new Blockly.FieldTextInput(''), 'TEXT')
            .appendField('"');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('String de texto');
    }
};

// Concatenar textos
Blockly.Blocks['text_join'] = {
    init: function() {
        this.appendValueInput('A')
            .setCheck(['String', 'Number']);
        this.appendValueInput('B')
            .setCheck(['String', 'Number'])
            .appendField('+');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('Concatena textos');
    }
};

// OperaÃ§Ãµes com texto
Blockly.Blocks['text_operation'] = {
    init: function() {
        this.appendValueInput('TEXT')
            .setCheck('String')
            .appendField(new Blockly.FieldDropdown([
                ['comprimento', 'LENGTH'],
                ['maiÃºsculas', 'UPPER'],
                ['minÃºsculas', 'LOWER'],
                ['trim', 'TRIM']
            ]), 'OP');
        this.setOutput(true, ['String', 'Number']);
        this.setColour("#3949AB");
        this.setTooltip('OperaÃ§Ãµes com texto');
    }
};

// Log message block
Blockly.Blocks['log_message'] = {
    init: function() {
        this.appendValueInput('MESSAGE')
            .setCheck('String')
            .appendField(new Blockly.FieldDropdown([
                ['Info', 'INFO'],
                ['Warning', 'WARNING'],
                ['Error', 'ERROR'],
                ['Debug', 'DEBUG']
            ]), 'LOG_LEVEL')
            .appendField('Log');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#3949AB");
        this.setTooltip('Logs a message at the selected log level');
        this.setHelpUrl('');
    }
};

// Log message with tag
Blockly.Blocks['log_message_tagged'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['Info', 'INFO'],
                ['Warning', 'WARNING'],
                ['Error', 'ERROR'],
                ['Debug', 'DEBUG']
            ]), 'LOG_LEVEL')
            .appendField('Log with tag');
        this.appendValueInput('TAG')
            .setCheck('String')
            .appendField('Tag');
        this.appendValueInput('MESSAGE')
            .setCheck('String')
            .appendField('Message');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#3949AB");
        this.setTooltip('Logs a message with a custom tag at the selected log level');
        this.setHelpUrl('');
    }
};

Blockly.Blocks['single_line_comment'] = {
  init: function() {
    this.appendDummyInput()
        .appendField("//")
        .appendField(new Blockly.FieldTextInput("comment"), "COMMENT");
    this.setPreviousStatement(true, null);
    this.setNextStatement(true, null);
    this.setColour("#3949AB");
    this.setTooltip("Single-line comment");
  }
};

Blockly.Blocks['multi_line_comment'] = {
  init: function() {
    this.appendDummyInput()
        .appendField("/*");
    this.appendStatementInput("COMMENT_LINES")
        .setCheck(null);
    this.appendDummyInput()
        .appendField("*/");
    this.setPreviousStatement(true, null);
    this.setNextStatement(true, null);
    this.setColour("#3949AB");
    this.setTooltip("Multi-line comment");
  }
};

//Generators
Blockly.JavaScript['single_line_comment'] = function(block) {
  var comment = block.getFieldValue('COMMENT');
  return '// ' + comment + '\n';
};

Blockly.JavaScript['multi_line_comment'] = function(block) {
  var lines = Blockly.JavaScript.statementToCode(block, 'COMMENT_LINES');
  return '/*\n' + lines + '*/\n';
};

// Log generator functions
Blockly.JavaScript['log_message'] = function(block) {
    var logLevel = block.getFieldValue('LOG_LEVEL');
    var message = Blockly.JavaScript.valueToCode(block, 'MESSAGE', Blockly.JavaScript.ORDER_ATOMIC) || '""';

    var logMethod;
    switch (logLevel) {
        case 'INFO': logMethod = 'console.info'; break;
        case 'WARNING': logMethod = 'console.warn'; break;
        case 'ERROR': logMethod = 'console.error'; break;
        case 'DEBUG': logMethod = 'console.debug'; break;
        default: logMethod = 'console.log';
    }

    var code = `${logMethod}(${message});\n`;
    return code;
};

Blockly.JavaScript['log_message_tagged'] = function(block) {
    var logLevel = block.getFieldValue('LOG_LEVEL');
    var tag = Blockly.JavaScript.valueToCode(block, 'TAG', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var message = Blockly.JavaScript.valueToCode(block, 'MESSAGE', Blockly.JavaScript.ORDER_ATOMIC) || '""';

    var logMethod;
    switch (logLevel) {
        case 'INFO': logMethod = 'console.info'; break;
        case 'WARNING': logMethod = 'console.warn'; break;
        case 'ERROR': logMethod = 'console.error'; break;
        case 'DEBUG': logMethod = 'console.debug'; break;
        default: logMethod = 'console.log';
    }

    var code = `${logMethod}("[${tag}] " + ${message});\n`;
    return code;
};


// Geradores de cÃ³digo para texto
Blockly.JavaScript['text_string'] = function(block) {
    var text = block.getFieldValue('TEXT');
    return [`"${text}"`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_join'] = function(block) {
    var a = Blockly.JavaScript.valueToCode(block, 'A', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var b = Blockly.JavaScript.valueToCode(block, 'B', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${a} + ${b}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_operation'] = function(block) {
    var text = Blockly.JavaScript.valueToCode(block, 'TEXT', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    var op = block.getFieldValue('OP');
    var code = '';
    
    switch(op) {
        case 'LENGTH': code = `${text}.length()`; break;
        case 'UPPER': code = `${text}.toUpperCase()`; break;
        case 'LOWER': code = `${text}.toLowerCase()`; break;
        case 'TRIM': code = `${text}.trim()`; break;
    }
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};


js/blocks/variables.js:
//blocks/variables.js
'use strict';

// CriaÃ§Ã£o de variÃ¡vel
Blockly.Blocks['create_variable'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Create Variable")
            .appendField(new Blockly.FieldTextInput("varName", this.validateVariableName), "VAR_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["int", "int"],
                ["String", "String"],
                ["boolean", "boolean"],
                ["double", "double"],
                ["Object", "Object"]
            ]), "VAR_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("FALSE"), "IS_FINAL");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Creates a new variable.");
        this.setHelpUrl("");
    },

    validateVariableName: function(name) {
        const workspace = this.workspace;
        if (!workspace) return name;

        const variables = workspace.getVariablesOfType('');
        const variableNames = variables.map(v => v.name);

        if (variableNames.includes(name)) {
            alert(`Variable "${name}" already exists.`);
            return null; // Nome invÃ¡lido
        }
        return name; // Nome vÃ¡lido
    }
};

Blockly.JavaScript['create_variable'] = function(block) {
    const varName = block.getFieldValue('VAR_NAME');
    const varType = block.getFieldValue('VAR_TYPE');
    const isFinal = block.getFieldValue('IS_FINAL') === 'TRUE' ? 'final ' : '';
    return `${isFinal}${varType} ${varName};\n`;
};


// AtribuiÃ§Ã£o de valor
Blockly.Blocks['set_variable'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Set Variable")
            .appendField(new Blockly.FieldDropdown(this.updateVariableOptions.bind(this)), "VAR_NAME")
            .appendField("=");
        this.appendValueInput("VALUE")
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Sets a value to an existing variable.");
        this.setHelpUrl("");
    },

    updateVariableOptions: function() {
        const workspace = Blockly.getMainWorkspace();
        const variables = workspace.getAllVariables();
        return variables.length > 0
            ? variables.map(v => [v.name, v.name])
            : [["No Variables", ""]];
    }
};

Blockly.JavaScript['set_variable'] = function(block) {
    const varName = block.getFieldValue('VAR_NAME');
    const value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${varName} = ${value};\n`;
};

// Obter valor de variÃ¡vel
Blockly.Blocks['get_variable'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Get Variable")
            .appendField(new Blockly.FieldDropdown(this.updateVariableOptions.bind(this)), "VAR_NAME");
        this.setOutput(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Gets the value of a variable.");
        this.setHelpUrl("");
    },

    updateVariableOptions: function() {
        const workspace = Blockly.getMainWorkspace();
        const variables = workspace.getAllVariables();
        return variables.length > 0
            ? variables.map(v => [v.name, v.name])
            : [["No Variables", ""]];
    }
};

Blockly.JavaScript['get_variable'] = function(block) {
    const varName = block.getFieldValue('VAR_NAME');
    return [`${varName}`, Blockly.JavaScript.ORDER_ATOMIC];
};



js/main.js:
/*
 * Author: Francisco Iago Lira Passos (iagolirapassos@gmail.com)
 * New blocks in https://google.github.io/blockly-samples/examples/developer-tools/index.html
 * MIT LICENSE
 */
// VariÃ¡veis globais
let workspace = Blockly.getMainWorkspace();
let currentLanguage = 'pt-br';

// Sistema de notificaÃ§Ãµes
function showNotification(message, type) {
    var oldNotification = document.querySelector('.notification');
    if (oldNotification) {
        oldNotification.remove();
    }
    
    var notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// FunÃ§Ãµes para salvar e carregar blocos
window.saveBlocks = function() {
    try {
        var xmlDom = Blockly.Xml.workspaceToDom(workspace);
        var xmlText = Blockly.Xml.domToPrettyText(xmlDom);
        
        var saveData = {
            version: "1.0",
            timestamp: new Date().toISOString(),
            blocks: xmlText
        };
        
        var saveString = JSON.stringify(saveData, null, 2);
        var blob = new Blob([saveString], {type: 'application/json'});
        var a = document.createElement('a');
        a.download = 'extension_blocks.json';
        a.href = URL.createObjectURL(blob);
        a.click();
        
        showNotification(TRANSLATIONS[currentLanguage]['file_success'], 'success');
    } catch (e) {
        console.error('Erro ao salvar blocos:', e);
        showNotification(TRANSLATIONS[currentLanguage]['file_error'], 'error');
    }
};

window.loadBlocks = function() {
    var input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                var saveData = JSON.parse(e.target.result);
                
                if (!saveData.version) {
                    throw new Error('Formato de arquivo invÃ¡lido');
                }
                
                var xmlDom = Blockly.utils.xml.textToDom(saveData.blocks);
                workspace.clear();
                Blockly.Xml.domToWorkspace(xmlDom, workspace);
                
                showNotification(TRANSLATIONS[currentLanguage]['file_success'], 'success');
            } catch (err) {
                console.error('Erro ao carregar blocos:', err);
                showNotification(TRANSLATIONS[currentLanguage]['file_error'], 'error');
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
};


document.addEventListener('DOMContentLoaded', function() {
	const themeSelect = document.getElementById('themeSelect');
	const outputCode = document.getElementById('outputCode');

    // ConfiguraÃ§Ã£o do Blockly
    workspace = Blockly.inject('blocklyDiv', {
        toolbox: document.getElementById('toolbox'),
        grid: {
            spacing: 20,
            length: 3,
            colour: '#ccc',
            snap: true
        },
        zoom: {
            controls: true,
            wheel: true,
            startScale: 1.0,
            maxScale: 3,
            minScale: 0.3,
            scaleSpeed: 1.2
        },
        trashcan: true
    });

    // ConfiguraÃ§Ã£o do redimensionamento do painel
    const outputPanel = document.querySelector('.output-panel');
    const resizeHandle = document.querySelector('.resize-handle');
    let isResizing = false;
    let startY;
    let startHeight;

    resizeHandle.addEventListener('mousedown', (e) => {
        isResizing = true;
        startY = e.clientY;
        startHeight = parseInt(document.defaultView.getComputedStyle(outputPanel).height, 10);
    });

    document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;

        const diffY = startY - e.clientY;
        outputPanel.style.height = (startHeight + diffY) + 'px';
        
        // Ajusta a altura do Blockly
        const blocklyDiv = document.getElementById('blocklyDiv');
        blocklyDiv.style.height = `calc(100vh - ${outputPanel.offsetHeight}px - 60px)`;
        Blockly.svgResize(workspace);
    });

    document.addEventListener('mouseup', () => {
        isResizing = false;
    });

    // ConfiguraÃ§Ã£o da mudanÃ§a de idioma
    const languageSelect = document.getElementById('languageSelect');
    languageSelect.addEventListener('change', function() {
        currentLanguage = this.value; // Atualiza a variÃ¡vel global
        changeLanguage(this.value);
    });

    function changeLanguage(lang) {
    
        // Atualiza as categorias do toolbox
        document.querySelectorAll('[id^="cat_"]').forEach(category => {
            const categoryId = category.id.replace('cat_', 'category_');
            if (TRANSLATIONS[lang][categoryId]) {
                category.setAttribute('name', TRANSLATIONS[lang][categoryId]);
            }
        });

        // Atualiza textos da interface
        document.getElementById('title').textContent = TRANSLATIONS[lang]['title'];
        // Atualiza categorias do toolbox
        document.getElementById('cat_config').setAttribute('name', TRANSLATIONS[lang]['cat_config']);
        document.getElementById('cat_props').setAttribute('name', TRANSLATIONS[lang]['cat_props']);
        document.getElementById('cat_methods').setAttribute('name', TRANSLATIONS[lang]['cat_methods']);

        // Atualiza os botÃµes da IDE
        document.querySelector('.text-save').parentElement.title = TRANSLATIONS[lang]['save_blocks'];
        document.querySelector('.text-load').parentElement.title = TRANSLATIONS[lang]['load_blocks'];
        document.querySelector('.text-generate').textContent = TRANSLATIONS[lang]['generate_code'];
        document.querySelector('.text-download').textContent = TRANSLATIONS[lang]['download_file'];

        // Atualiza o Blockly
        Blockly.setLocale(lang);
    }
    
    //Themes
    themeSelect.addEventListener('change', function() {
		changeTheme(this.value);
	});

	function changeTheme(theme) {
		// Remove todas as classes de tema anteriores
		outputPanel.classList.remove('theme-light', 'theme-dark', 'theme-github', 'theme-monokai');
		
		// Adiciona a nova classe de tema
		outputPanel.classList.add(`theme-${theme}`);
		
		// Regenera o cÃ³digo para aplicar o novo tema
		if (workspace) {
		    generateJavaCode();
		}
	}

    // FunÃ§Ãµes de geraÃ§Ã£o e download de cÃ³digo
    window.generateJavaCode = function() {
		try {
		    var code = Blockly.JavaScript.workspaceToCode(workspace);
		    const outputElement = document.getElementById('outputCode');
		    
		    // Primeiro, define o texto bruto
		    outputElement.textContent = code;

		    // Se o Prism estÃ¡ disponÃ­vel e carregado corretamente
		    if (typeof Prism !== 'undefined' && Prism.languages.java) {
		        requestAnimationFrame(() => {
		            try {
		                const highlightedCode = Prism.highlight(
		                    code,
		                    Prism.languages.java,
		                    'java'
		                );
		                outputElement.innerHTML = highlightedCode;
		                
		                // MantÃ©m o tema atual
		                const currentTheme = themeSelect.value;
		                changeTheme(currentTheme);
		            } catch (highlightError) {
		                console.warn('Erro ao aplicar syntax highlighting:', highlightError);
		            }
		        });
		    }
		} catch (error) {
		    console.error('Erro ao gerar cÃ³digo:', error);
		    outputElement.textContent = 'Erro ao gerar cÃ³digo. Por favor, verifique seus blocos.';
		}
	};

    window.downloadCode = function() {
        const outputElement = document.getElementById('outputCode');
        // Pega o texto sem formataÃ§Ã£o HTML
        const code = outputElement.textContent || outputElement.innerText;
        const blob = new Blob([code], { type: 'text/java;charset=utf-8' });
        const a = document.createElement('a');
        a.download = 'MinhaExtensao.java';
        a.href = URL.createObjectURL(blob);
        a.click();
    };

    document.getElementById('blocklyDiv').addEventListener('dragover', handleDragOver);
    document.getElementById('blocklyDiv').addEventListener('drop', handleFileDrop);

    function handleDragOver(e) {
      e.preventDefault();
    }

    function handleFileDrop(e) {
      e.preventDefault();
      var file = e.dataTransfer.files[0];
      var reader = new FileReader();

      reader.onload = function(event) {
        var saveData = JSON.parse(event.target.result);
        var xmlDom = Blockly.utils.xml.textToDom(saveData.blocks);
        workspace.clear();
        Blockly.Xml.domToWorkspace(xmlDom, workspace);
      };

      reader.readAsText(file);
    }

    // Atualiza a lista de variÃ¡veis para todos os blocos relevantes
    
    Blockly.getMainWorkspace().addChangeListener((event) => {
        if (event.type === Blockly.Events.VAR_CREATE || event.type === Blockly.Events.VAR_DELETE || event.type === Blockly.Events.VAR_RENAME) {
            updateVariableList();
        }
    });


    // Define o idioma inicial
    changeLanguage('en');
    changeTheme('light');
});


js/translations.js:
const TRANSLATIONS = {
    'en': {
        // Interface
        'title': 'MIT App Inventor Extension Builder',
        'btn_generate': 'Generate Java Code',
        'btn_download': 'Download .java',
        'theme_light': 'Light Theme',
        'theme_dark': 'Dark Theme',
        'theme_github': 'GitHub Theme',
        'theme_monokai': 'Monokai Theme',
        
        // Categories
        'cat_config': 'Configuration',
        'cat_props': 'Properties',
        'cat_methods': 'Methods',
        'cat_control': 'Control',
        'cat_lists': 'Lists',
        'cat_math': 'Math',
        'cat_text': 'Text',
        'cat_logic': 'Logic',
        'cat_dictionaries': 'Dictionaries',
        'cat_colors': 'Colors',
        'cat_variables': 'Variables',
        'cat_functions': 'Functions',


        // BotÃµes da IDE
        'save_blocks': 'Save Blocks',
        'load_blocks': 'Load Blocks',
        'generate_code': 'Generate Java Code',
        'download_file': 'Download .java',
        
        // Categorias do Toolbox
        'category_config': 'Configuration',
        'category_imports': 'Imports',
        'category_props': 'Properties',
        'category_methods': 'Methods',
        'category_control': 'Control',
        'category_math': 'Math',
        'category_text': 'Text',
        'category_lists': 'Lists',
        'category_logic': 'Logic',
        'category_dictionaries': 'Dictionaries',
        'category_imported': 'Imported Classes',
        'category_object': 'Objects',
        'category_colors': 'Colors',
        'category_variables': 'Variables',
        'category_functions': 'Functions',
        
        // Blocos
        'block_return': 'return',
        'block_extension': 'Create Extension',
        'block_constructor': 'Constructor',
        'block_package': 'Package',
        'block_import': 'Import',
        'block_property': 'Property',
        'block_designer': 'Designer Property',
        'block_method': 'Method',
        'block_event': 'Event',
        'block_parameter': 'Parameter',
        
        // Common terms
        'type': 'type',
        'return': 'return',
        'name': 'name',
        'value': 'value',
        'parameter': 'parameter',
        'description': 'description',
        'implementation': 'implementation',
        'add_parameter': 'Add Parameter',
        'remove_parameter': 'Remove Parameter',
        // Control blocks
        'controls_if': 'if',
        'controls_for': 'for',
        'controls_while': 'while',
        'controls_try': 'try',
        'controls_catch': 'catch',
        'controls_finally': 'finally',
        'controls_return': 'return',
        'controls_do': 'do',
        'controls_else': 'else',
        
        // Math blocks
        'math_number': 'number',
        'math_operation': 'operation',
        'math_function': 'function',
        'math_random': 'random',
        'math_constant': 'constant',
        'math_add': 'add',
        'math_subtract': 'subtract',
        'math_multiply': 'multiply',
        'math_divide': 'divide',
        'math_modulo': 'modulo',
        'math_power': 'power',
        'math_abs': 'absolute',
        'math_sqrt': 'square root',
        'math_sin': 'sine',
        'math_cos': 'cosine',
        'math_tan': 'tangent',
        'math_round': 'round',
        'math_ceil': 'ceiling',
        'math_floor': 'floor',
        'math_random_int': 'random integer',
        'math_random_float': 'random decimal',
        'math_random_bool': 'random boolean',
        
        // Text blocks
        'text_string': 'text',
        'text_join': 'join',
        'text_length': 'length',
        'text_uppercase': 'to uppercase',
        'text_lowercase': 'to lowercase',
        'text_trim': 'trim',
        'text_charAt': 'character at',
        'text_indexOf': 'find in text',
        
        // List blocks
        'lists_create': 'create list',
        'lists_add': 'add',
        'lists_remove': 'remove',
        'lists_get': 'get',
        'lists_set': 'set',
        'lists_clear': 'clear',
        'lists_size': 'size',
        'lists_forEach': 'for each',
        
        // Constructor blocks
        'constructor_default': 'default constructor',
        'constructor_custom': 'custom constructor',
        'constructor_param': 'constructor parameter',
        'constructor_super': 'super call',
        
        // Import blocks
        'import_manual': 'manual import',
        'import_package': 'import package',
        'import_class': 'import class',
        
        // Object blocks
        'object_create': 'create object',
        'object_get_field': 'get field',
        'object_set_field': 'set field',
        'object_call_method': 'call method',
        'object_is_null': 'is null',
        'object_cast': 'cast to',
        'object_instance_of': 'is instance of',
        
        // File operations
        'file_save': 'Save Blocks',
        'file_load': 'Load Blocks',
        'file_success': 'Operation successful',
        'file_error': 'Error during operation',
        
        // Tooltips
        'tooltip_save': 'Save current blocks to file',
        'tooltip_load': 'Load blocks from file',
        'tooltip_import': 'Add custom import',
        'tooltip_object': 'Create new object instance',
        'tooltip_method': 'Call method from imported class',

        'logic_compare': 'compare',
        'logic_compare_title': 'comparisons',
        'logic_compare_item_title': 'comparison',
        'logic_operation_and': 'and',
        'logic_operation_or': 'or',
        'logic_negate': 'not',
        'logic_boolean_true': 'true',
        'logic_boolean_false': 'false',
        'logic_null': 'null',

        'logic_operation_title': 'Logical Operation',
        'logic_operation_item_title': 'Boolean Input',
        'logic_operation_empty': '(empty)',
        'logic_operation_and': 'AND',
        'logic_operation_or': 'OR'
    },
    'pt-br': {
        // Interface
        'title': 'Construtor de ExtensÃµes MIT App Inventor',
        'btn_generate': 'Gerar CÃ³digo Java',
        'btn_download': 'Baixar .java',
        'theme_light': 'Tema Claro',
        'theme_dark': 'Tema Escuro',
        'theme_github': 'Tema GitHub',
        'theme_monokai': 'Tema Monokai',
        
        // Categorias
        'cat_config': 'ConfiguraÃ§Ã£o',
        'cat_props': 'Propriedades',
        'cat_methods': 'MÃ©todos',
        'cat_control': 'Controle',
        'cat_lists': 'Listas',
        'cat_math': 'MatemÃ¡tica',
        'cat_text': 'Texto',
        'cat_logic': 'LÃ³gica',
        'cat_dictionaries': 'DicionÃ¡rios',
        'cat_colors': 'Cores',
        'cat_variables': 'VariÃ¡veis',
        'cat_functions': 'FunÃ§Ãµes',
        
        // BotÃµes da IDE
        'save_blocks': 'Salvar Blocos',
        'load_blocks': 'Carregar Blocos',
        'generate_code': 'Gerar CÃ³digo Java',
        'download_file': 'Baixar .java',
        
        // Categorias do Toolbox
        'category_config': 'ConfiguraÃ§Ã£o',
        'category_imports': 'ImportaÃ§Ãµes',
        'category_props': 'Propriedades',
        'category_methods': 'MÃ©todos',
        'category_control': 'Controle',
        'category_math': 'MatemÃ¡tica',
        'category_text': 'Texto',
        'category_lists': 'Listas',
        'category_logic': 'LÃ³gica',
        'category_dictionaries': 'DicionÃ¡rios',
        'category_imported': 'Classes Importadas',
        'category_object': 'Objetos',
        'category_colors': 'Cores',
        'category_variables': 'VariÃ¡veis',
        'category_functions': 'FunÃ§Ãµes',
        
        // Blocos
        'block_return': 'retornar',
        'block_extension': 'Criar ExtensÃ£o',
        'block_constructor': 'Construtor',
        'block_package': 'Pacote',
        'block_import': 'Importar',
        'block_property': 'Propriedade',
        'block_designer': 'Propriedade Designer',
        'block_method': 'MÃ©todo',
        'block_event': 'Evento',
        'block_parameter': 'ParÃ¢metro',
        
        // Termos comuns
        'type': 'tipo',
        'return': 'retorno',
        'name': 'nome',
        'value': 'valor',
        'parameter': 'parÃ¢metro',
        'description': 'descriÃ§Ã£o',
        'implementation': 'implementaÃ§Ã£o',
        'add_parameter': 'Adicionar ParÃ¢metro',
        'remove_parameter': 'Remover ParÃ¢metro',
        // Blocos de controle
        'controls_if': 'se',
        'controls_for': 'para',
        'controls_while': 'enquanto',
        'controls_try': 'tentar',
        'controls_catch': 'capturar',
        'controls_finally': 'finalmente',
        'controls_return': 'retornar',
        'controls_do': 'faÃ§a',
        'controls_else': 'senÃ£o',
        
        // Blocos matemÃ¡ticos
        'math_number': 'nÃºmero',
        'math_operation': 'operaÃ§Ã£o',
        'math_function': 'funÃ§Ã£o',
        'math_random': 'aleatÃ³rio',
        'math_constant': 'constante',
        'math_add': 'adicionar',
        'math_subtract': 'subtrair',
        'math_multiply': 'multiplicar',
        'math_divide': 'dividir',
        'math_modulo': 'mÃ³dulo',
        'math_power': 'potÃªncia',
        'math_abs': 'absoluto',
        'math_sqrt': 'raiz quadrada',
        'math_sin': 'seno',
        'math_cos': 'cosseno',
        'math_tan': 'tangente',
        'math_round': 'arredondar',
        'math_ceil': 'teto',
        'math_floor': 'piso',
        'math_random_int': 'inteiro aleatÃ³rio',
        'math_random_float': 'decimal aleatÃ³rio',
        'math_random_bool': 'booleano aleatÃ³rio',
        
        // Blocos de texto
        'text_string': 'texto',
        'text_join': 'juntar',
        'text_length': 'comprimento',
        'text_uppercase': 'maiÃºsculas',
        'text_lowercase': 'minÃºsculas',
        'text_trim': 'remover espaÃ§os',
        'text_charAt': 'caractere na posiÃ§Ã£o',
        'text_indexOf': 'encontrar no texto',
        
        // Blocos de lista
        'lists_create': 'criar lista',
        'lists_add': 'adicionar',
        'lists_remove': 'remover',
        'lists_get': 'obter',
        'lists_set': 'definir',
        'lists_clear': 'limpar',
        'lists_size': 'tamanho',
        'lists_forEach': 'para cada',
        
        // Blocos do construtor
        'constructor_default': 'construtor padrÃ£o',
        'constructor_custom': 'construtor personalizado',
        'constructor_param': 'parÃ¢metro do construtor',
        'constructor_super': 'chamada super',
        
        // Blocos de importaÃ§Ã£o
        'import_manual': 'importaÃ§Ã£o manual',
        'import_package': 'importar pacote',
        'import_class': 'importar classe',
        
        // Blocos de objeto
        'object_create': 'criar objeto',
        'object_get_field': 'obter campo',
        'object_set_field': 'definir campo',
        'object_call_method': 'chamar mÃ©todo',
        'object_is_null': 'Ã© nulo',
        'object_cast': 'converter para',
        'object_instance_of': 'Ã© instÃ¢ncia de',
        
        // OperaÃ§Ãµes de arquivo
        'file_save': 'Salvar Blocos',
        'file_load': 'Carregar Blocos',
        'file_success': 'OperaÃ§Ã£o realizada com sucesso',
        'file_error': 'Erro durante a operaÃ§Ã£o',
        
        // Dicas de ferramentas
        'tooltip_save': 'Salvar blocos atuais em arquivo',
        'tooltip_load': 'Carregar blocos de um arquivo',
        'tooltip_import': 'Adicionar importaÃ§Ã£o personalizada',
        'tooltip_object': 'Criar nova instÃ¢ncia de objeto',
        'tooltip_method': 'Chamar mÃ©todo de classe importada',

        'logic_compare': 'compara',
        'logic_compare_title': 'comparaÃ§Ãµes',
        'logic_compare_item_title': 'comparaÃ§Ã£o',
        'logic_operation_and': 'e',
        'logic_operation_or': 'ou',
        'logic_negate': 'nÃ£o',
        'logic_boolean_true': 'verdadeiro',
        'logic_boolean_false': 'falso',
        'logic_null': 'nulo',

        'logic_operation_title': 'OperaÃ§Ã£o LÃ³gica',
        'logic_operation_item_title': 'Entrada Booleana',
        'logic_operation_empty': '(vazio)',
        'logic_operation_and': 'E',
        'logic_operation_or': 'OU'

    }
};


