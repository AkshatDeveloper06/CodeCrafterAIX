css/styles.css:
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: #f0f0f0;
}

.header {
    background: #2c3e50;
    color: white;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-controls {
    display: flex;
    gap: 10px;
    align-items: center;
}

.language-select {
    background: white;
    border: none;
    padding: 6px;
    border-radius: 4px;
    cursor: pointer;
}

.main-content {
    display: flex;
    flex: 1;
    position: relative;
}

#blocklyDiv {
    flex: 1;
    height: calc(70vh - 60px);
}

.output-panel {
    width: 100%;
    height: 30vh;
    background: #fff;
    border-top: 2px solid #ccc;
    padding: 10px;
    font-family: monospace;
    display: flex;
    flex-direction: column;
    position: relative;
    transition: background-color 0.3s ease;
}

.resize-handle {
    width: 100%;
    height: 5px;
    background: #ccc;
    cursor: ns-resize;
    position: absolute;
    top: 0;
    left: 0;
}

.resize-handle:hover {
    background: #999;
}

#outputCode {
    font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
    font-size: 14px;
    line-height: 1.5;
    padding: 15px;
    transition: all 0.3s ease;
}

.button {
    background: #3498db;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 4px;
    cursor: pointer;
    margin-left: 10px;
}

.button:hover {
    background: #2980b9;
}

/* Syntax highlighting */
/* Seletor de tema */
.theme-select {
    background: white;
    border: none;
    padding: 6px;
    border-radius: 4px;
    cursor: pointer;
    margin-right: 10px;
}

/* Tema Light (Padrão) */
.theme-light {
    background: white;
    color: #24292e;
}

.theme-light .token.comment { color: #6a737d; }
.theme-light .token.keyword { color: #d73a49; }
.theme-light .token.string { color: #032f62; }
.theme-light .token.class-name { color: #6f42c1; }
.theme-light .token.function { color: #005cc5; }
.theme-light .token.number { color: #005cc5; }
.theme-light .token.operator { color: #d73a49; }
.theme-light .token.punctuation { color: #24292e; }
.theme-light .token.annotation { color: #d73a49; }

/* Tema Dark */
.theme-dark {
    background: #1e1e1e;
    color: #d4d4d4;
}

.theme-dark .token.comment { color: #6A9955; }
.theme-dark .token.keyword { color: #569cd6; }
.theme-dark .token.string { color: #ce9178; }
.theme-dark .token.class-name { color: #4ec9b0; }
.theme-dark .token.function { color: #dcdcaa; }
.theme-dark .token.number { color: #b5cea8; }
.theme-dark .token.operator { color: #d4d4d4; }
.theme-dark .token.punctuation { color: #d4d4d4; }
.theme-dark .token.annotation { color: #4fc1ff; }

/* Tema GitHub */
.theme-github {
    background: white;
    color: #24292e;
}

.theme-github .token.comment { color: #6a737d; }
.theme-github .token.keyword { color: #d73a49; }
.theme-github .token.string { color: #032f62; }
.theme-github .token.class-name { color: #6f42c1; }
.theme-github .token.function { color: #005cc5; }
.theme-github .token.number { color: #005cc5; }
.theme-github .token.operator { color: #d73a49; }
.theme-github .token.punctuation { color: #24292e; }
.theme-github .token.annotation { color: #d73a49; }

/* Tema Monokai */
.theme-monokai {
    background: #272822;
    color: #f8f8f2;
}

.theme-monokai .token.comment { color: #75715e; }
.theme-monokai .token.keyword { color: #f92672; }
.theme-monokai .token.string { color: #e6db74; }
.theme-monokai .token.class-name { color: #a6e22e; }
.theme-monokai .token.function { color: #66d9ef; }
.theme-monokai .token.number { color: #ae81ff; }
.theme-monokai .token.operator { color: #f8f8f2; }
.theme-monokai .token.punctuation { color: #f8f8f2; }
.theme-monokai .token.annotation { color: #f92672; }

/* Notificações */
.notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 15px 25px;
    border-radius: 5px;
    color: white;
    font-weight: bold;
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

.notification.success {
    background-color: #2ecc71;
}

.notification.error {
    background-color: #e74c3c;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Estilo para o input de arquivo (oculto) */
input[type="file"] {
    display: none;
}

/* Melhorias nos botões de arquivo */
.button.file-button {
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.button.file-button span {
    font-size: 18px;
}

examples/mathoperations_blocks.json:
{
  "version": "1.0",
  "timestamp": "2024-11-17T02:10:33.231Z",
  "blocks": "<xml xmlns=\"https://developers.google.com/blockly/xml\">\n  <block type=\"package_declaration\" id=\"Y=.,0H=GAZ@A-m;-?ePv\" x=\"50\" y=\"30\">\n    <field name=\"PACKAGE\">com.bosonshiggs.mathoperations</field>\n    <next>\n      <block type=\"import_basic\" id=\"g~TKKeQI5d7w]6,:.!zE\">\n        <field name=\"IMPORT\">ANNOTATIONS</field>\n        <next>\n          <block type=\"import_manual\" id=\"2kFGmaLx}GO(Nx4xW0B@\">\n            <field name=\"IMPORT_PATH\">com.google.appinventor.components.common.ComponentCategory</field>\n            <field name=\"IS_STATIC\">FALSE</field>\n            <field name=\"IS_WILDCARD\">FALSE</field>\n            <next>\n              <block type=\"import_manual\" id=\"Lgg@fUIfFejA*dchCznz\">\n                <field name=\"IMPORT_PATH\">com.google.appinventor.components.runtime.AndroidNonvisibleComponent</field>\n                <field name=\"IS_STATIC\">FALSE</field>\n                <field name=\"IS_WILDCARD\">FALSE</field>\n                <next>\n                  <block type=\"import_manual\" id=\"@])tpzJy6s:I)zO-!Jr;\">\n                    <field name=\"IMPORT_PATH\">com.google.appinventor.components.runtime.ComponentContainer</field>\n                    <field name=\"IS_STATIC\">FALSE</field>\n                    <field name=\"IS_WILDCARD\">FALSE</field>\n                    <next>\n                      <block type=\"import_manual\" id=\"ABrd38B+oPY8rilPG~@O\">\n                        <field name=\"IMPORT_PATH\">com.google.appinventor.components.runtime.errors.YailRuntimeError</field>\n                        <field name=\"IS_STATIC\">FALSE</field>\n                        <field name=\"IS_WILDCARD\">FALSE</field>\n                      </block>\n                    </next>\n                  </block>\n                </next>\n              </block>\n            </next>\n          </block>\n        </next>\n      </block>\n    </next>\n  </block>\n  <block type=\"extension_class\" id=\".y8hLW)}{U(9OXke{v21\" x=\"630\" y=\"50\">\n    <field name=\"className\">Create Extension</field>\n    <field name=\"classNameEdit\">MathOperations</field>\n    <field name=\"descriptionName\">Description</field>\n    <field name=\"descriptionNameEdit\">An extension to perform basic and advanced mathematical operations.</field>\n    <field name=\"categoryName\">Category</field>\n    <field name=\"extensionNameEdit\">EXTENSION</field>\n    <field name=\"NAME\">Icon Name</field>\n    <field name=\"checkBoxNonVisible\">TRUE</field>\n    <field name=\"NAME\">Icon Name</field>\n    <field name=\"imageURL\">https://www.iconsdb.com/icons/preview/green/math-xxl.png</field>\n    <field name=\"interfacesLabel\">Interfaces</field>\n    <field name=\"interfaces\"></field>\n    <field name=\"annotationsText\">ANNOTATIONS</field>\n    <field name=\"blocksExtensions\">BLOCKS</field>\n    <statement name=\"statementBlocks\">\n      <block type=\"constructor_declaration\" id=\"^^PxcKv#X6T(j%gDto1I\">\n        <mutation xmlns=\"http://www.w3.org/1999/xhtml\" is_default=\"true\"></mutation>\n        <field name=\"IS_DEFAULT\">TRUE</field>\n        <statement name=\"CONSTRUCTOR_CONTENT\">\n          <block type=\"constructor_super_call\" id=\"[4l!tppl`l-;^Z56LZp/\">\n            <field name=\"SUPER_PARAMS\">container.$context()</field>\n          </block>\n        </statement>\n        <next>\n          <block type=\"method_declaration\" id=\"vs1=}]x4ZdKVR7RH{dZ4\">\n            <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"2\">\n              <param name=\"number1\" type=\"String\" final=\"false\" ></param>\n              <param name=\"number2\" type=\"String\" final=\"false\" ></param>\n            </mutation>\n            <field name=\"METHOD_NAME\">Add</field>\n            <field name=\"RETURN_TYPE\">double</field>\n            <field name=\"DESCRIPTION\">A custom method</field>\n            <statement name=\"METHOD_CONTENT\">\n              <block type=\"method_return\" id=\"-,95I@x.;M;3hC`#u^?9\">\n                <value name=\"RETURN_VALUE\">\n                  <block type=\"math_operation\" id=\"7.4W}e:d|Mj{:*bpvZRc\">\n                    <mutation xmlns=\"http://www.w3.org/1999/xhtml\" items=\"2\"></mutation>\n                    <field name=\"OP1\">ADD</field>\n                    <value name=\"NUM0\">\n                      <block type=\"get_variable\" id=\"Z),*}qV}i+JbXduC;(CD\">\n                        <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                      </block>\n                    </value>\n                    <value name=\"NUM1\">\n                      <block type=\"get_variable\" id=\"Ph$tU)qn$d-^*:KQ5^k$\">\n                        <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                      </block>\n                    </value>\n                  </block>\n                </value>\n              </block>\n            </statement>\n            <next>\n              <block type=\"method_declaration\" id=\"Ze*uZ!Y+4vi:/#f0?/,z\">\n                <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"2\">\n                  <param name=\"number1\" type=\"String\" final=\"false\" ></param>\n                  <param name=\"number2\" type=\"String\" final=\"false\" ></param>\n                </mutation>\n                <field name=\"METHOD_NAME\">Subtract</field>\n                <field name=\"RETURN_TYPE\">double</field>\n                <field name=\"DESCRIPTION\">A custom method</field>\n                <statement name=\"METHOD_CONTENT\">\n                  <block type=\"method_return\" id=\"zSR;XFEH1sA-rBI$AHBw\">\n                    <value name=\"RETURN_VALUE\">\n                      <block type=\"math_operation\" id=\"_ACF622DZ4%4^K4O}Sw0\">\n                        <mutation xmlns=\"http://www.w3.org/1999/xhtml\" items=\"2\"></mutation>\n                        <field name=\"OP1\">SUBTRACT</field>\n                        <value name=\"NUM0\">\n                          <block type=\"get_variable\" id=\"lpPo;`M0J@CK#xDxGi+f\">\n                            <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                          </block>\n                        </value>\n                        <value name=\"NUM1\">\n                          <block type=\"get_variable\" id=\"SP=o2a+fafxkoBK;ZqSh\">\n                            <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                          </block>\n                        </value>\n                      </block>\n                    </value>\n                  </block>\n                </statement>\n                <next>\n                  <block type=\"method_declaration\" id=\"wBcL+I^1zy9=E?uU`Eq(\">\n                    <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"2\">\n                      <param name=\"number1\" type=\"String\" final=\"false\" ></param>\n                      <param name=\"number2\" type=\"String\" final=\"false\" ></param>\n                    </mutation>\n                    <field name=\"METHOD_NAME\">Multiply</field>\n                    <field name=\"RETURN_TYPE\">double</field>\n                    <field name=\"DESCRIPTION\">A custom method</field>\n                    <statement name=\"METHOD_CONTENT\">\n                      <block type=\"method_return\" id=\"Xy%f5MAe8L+fih:f3hP+\">\n                        <value name=\"RETURN_VALUE\">\n                          <block type=\"math_operation\" id=\"Q}?DEo.{Xa!|M%i4hoYd\">\n                            <mutation xmlns=\"http://www.w3.org/1999/xhtml\" items=\"2\"></mutation>\n                            <field name=\"OP1\">MULTIPLY</field>\n                            <value name=\"NUM0\">\n                              <block type=\"get_variable\" id=\"Rja5)yf*]@~LZ4v*.b0J\">\n                                <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                              </block>\n                            </value>\n                            <value name=\"NUM1\">\n                              <block type=\"get_variable\" id=\"q7)#~30u4Pu2$zYcDOUf\">\n                                <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                              </block>\n                            </value>\n                          </block>\n                        </value>\n                      </block>\n                    </statement>\n                    <next>\n                      <block type=\"method_declaration\" id=\"K%-qj(G^ho;Md`{z!}~S\">\n                        <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"2\">\n                          <param name=\"number1\" type=\"String\" final=\"false\" ></param>\n                          <param name=\"number2\" type=\"String\" final=\"false\" ></param>\n                        </mutation>\n                        <field name=\"METHOD_NAME\">Divide</field>\n                        <field name=\"RETURN_TYPE\">double</field>\n                        <field name=\"DESCRIPTION\">A custom method</field>\n                        <statement name=\"METHOD_CONTENT\">\n                          <block type=\"controls_if_java\" id=\"i,;hb^Y@E.I^+NM]c#OP\">\n                            <value name=\"IF0\">\n                              <block type=\"logic_compare\" id=\")?Gva^U40.E0w}5XxIb*\">\n                                <field name=\"OP\">EQ</field>\n                                <value name=\"A\">\n                                  <block type=\"get_variable\" id=\"}DGY7tm8zIZd|a_t`1Nb\">\n                                    <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                                  </block>\n                                </value>\n                                <value name=\"B\">\n                                  <block type=\"math_number\" id=\"QnC:t+I8}yCd?RQ!4s6O\">\n                                    <field name=\"NUM\">0</field>\n                                  </block>\n                                </value>\n                              </block>\n                            </value>\n                            <statement name=\"DO0\">\n                              <block type=\"create_variable\" id=\"18V}lZnH~w:t[XVwwC@w\">\n                                <field name=\"VAR_NAME\">message</field>\n                                <field name=\"VAR_TYPE\">String</field>\n                                <field name=\"IS_FINAL\">FALSE</field>\n                                <next>\n                                  <block type=\"set_variable\" id=\"_.AZATd(?]lQoak-dxAG\">\n                                    <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                                    <value name=\"VALUE\">\n                                      <block type=\"text_string\" id=\"NkdJg*s!JtIL8,9$DI+l\">\n                                        <field name=\"TEXT\">Error! Division by zero!</field>\n                                      </block>\n                                    </value>\n                                    <next>\n                                      <block type=\"method_call\" id=\"y.z4w}6{`gYMtL=sa%:-\">\n                                        <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"1\">\n                                          <param name=\"message\" type=\"String\" ></param>\n                                        </mutation>\n                                        <field name=\"METHOD_NAME\">Error</field>\n                                      </block>\n                                    </next>\n                                  </block>\n                                </next>\n                              </block>\n                            </statement>\n                            <statement name=\"ELSE\">\n                              <block type=\"method_return\" id=\"e^_|urQ$iJ#,h*U/B)g{\">\n                                <value name=\"RETURN_VALUE\">\n                                  <block type=\"math_operation\" id=\"_3ulOJqb+SxrzkqDbi{+\">\n                                    <mutation xmlns=\"http://www.w3.org/1999/xhtml\" items=\"2\"></mutation>\n                                    <field name=\"OP1\">DIVIDE</field>\n                                    <value name=\"NUM0\">\n                                      <block type=\"get_variable\" id=\"1*vE{o_djwYaQ?H^KJi+\">\n                                        <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                                      </block>\n                                    </value>\n                                    <value name=\"NUM1\">\n                                      <block type=\"get_variable\" id=\"ci-%wfPUbizSmc{Lzp-U\">\n                                        <field name=\"VAR_NAME\">577:;dyEBor=tdeIgL]p</field>\n                                      </block>\n                                    </value>\n                                  </block>\n                                </value>\n                              </block>\n                            </statement>\n                          </block>\n                        </statement>\n                        <next>\n                          <block type=\"event_declaration\" id=\"^,]f,Owg`E(]g4XFHg^x\">\n                            <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"1\">\n                              <param name=\"message\" type=\"String\" final=\"false\" ></param>\n                            </mutation>\n                            <field name=\"EVENT_NAME\">Error</field>\n                            <field name=\"DESCRIPTION\">A custom event</field>\n                            <statement name=\"EVENT_CONTENT\">\n                              <block type=\"custom_dispatcher\" id=\"h5{9t)1g.P3h2[,`=i9[\">\n                                <mutation xmlns=\"http://www.w3.org/1999/xhtml\" params=\"1\">\n                                  <param name=\"message\" type=\"String\" ></param>\n                                </mutation>\n                                <field name=\"EVENT_NAME\">Dispatcher</field>\n                              </block>\n                            </statement>\n                          </block>\n                        </next>\n                      </block>\n                    </next>\n                  </block>\n                </next>\n              </block>\n            </next>\n          </block>\n        </next>\n      </block>\n    </statement>\n  </block>\n</xml>"
}

examples/MathOperations.java:
package com.bosonshiggs.mathoperations;

import com.google.appinventor.components.annotations.*;
import com.google.appinventor.components.common.ComponentCategory;
import com.google.appinventor.components.runtime.AndroidNonvisibleComponent;
import com.google.appinventor.components.runtime.ComponentContainer;
import com.google.appinventor.components.runtime.errors.YailRuntimeError;

@DesignerComponent(version = 1,
    description = "An extension to perform basic and advanced mathematical operations.",
    category = ComponentCategory.EXTENSION,
    nonVisible = true,
    iconName = "https://www.iconsdb.com/icons/preview/green/math-xxl.png")
@SimpleObject(external = true)
public class MathOperations extends AndroidNonvisibleComponent {
      public Constructor(ComponentContainer container) {

            super(container.$context());
      }
      @SimpleFunction(description = "A custom method")
      public double Add(String number1, String number2) {
            return (message + message);

      }
      @SimpleFunction(description = "A custom method")
      public double Subtract(String number1, String number2) {
            return (message - message);

      }
      @SimpleFunction(description = "A custom method")
      public double Multiply(String number1, String number2) {
            return (message * message);

      }
      @SimpleFunction(description = "A custom method")
      public double Divide(String number1, String number2) {
    if (message.equals(0)) {
              String message;
      message = "Error! Division by zero!";
      Error(message);

        } else {
                      return (message / message);

        }

      }
      @SimpleEvent(description = "A custom event")
      public void Error(String message) {
            EventDispatcher.dispatchEvent(this, "Dispatcher", message);

      }
}

index.html:
<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>MIT App Inventor Extension Builder</title>
	
	<!-- Favicon -->
	<link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAA/4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAERERERERERERAAAAAAAAERAQAAAAAAEBEAEAAAAAEAEQABAAAAEAARAAAQAAAQABEAAAEAAAEAEQAAAQAAEAARAAABAAEAABAAAAEAAAAAAQAAAQAAAAAAEAAAEAAAAAAAQAAAQAAAAAAEAAAAAAAAAAAAAARERERERERERAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
	
	<!-- Blockly -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/blockly.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/msg/pt-br.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.3.1/msg/en.js"></script>
	
	<!-- Prism.js para syntax highlighting -->
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-clike.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
	
	<!-- CSS próprio -->
	<link rel="stylesheet" href="css/styles.css">
</head>
<body>
	<div class="header">
		<h2 id="title">MIT App Inventor Extension Builder</h2>
			<div class="header-controls">
				<select id="themeSelect" class="theme-select">
					<option value="light">Light Theme</option>
					<option value="dark">Dark Theme</option>
					<option value="github">GitHub</option>
					<option value="monokai">Monokai</option>
				</select>
				<select id="languageSelect" class="language-select">
					<option value="en">English</option>
					<option value="pt-br">Português</option>
				</select>
				<button class="button" onclick="saveBlocks()" title="Salve Blocks">
					<span class="text-save">💾</span>
				</button>
				<button class="button" onclick="loadBlocks()" title="Upload Blocks">
					<span class="text-load">📂</span>
				</button>

				<button class="button" onclick="compileExtension()">
				    <span class="text-compile">Compile Extension</span>
				</button>


				<button class="button" onclick="generateJavaCode()">
					<span class="text-generate">Build Java File</span>
				</button>
				<button class="button" onclick="downloadCode()">
					<span class="text-download">Download .java</span>
				</button>
			</div>
	</div>
	<div class="main-content">
		<div id="blocklyDiv"></div>
	</div>
	<div class="output-panel">
		<div class="resize-handle"></div>
		<pre><code id="outputCode" class="language-java"></code></pre>
	</div>

	<xml id="toolbox" style="display: none">
	    <category id="cat_config" name="Configuration" colour="#5C6BC0">
	        <block type="extension_class"></block>
	        <block type="custom_annotation"></block>
	        <block type="constructor_declaration"></block>
	        <block type="constructor_parameter"></block>
	        <block type="constructor_super_call"></block>
	        <block type="package_declaration"></block>
	    </category>

	    <category id="cat_imports" name="Imports" colour="#00897B">
	        <block type="import_basic"></block>
	        <block type="import_manual"></block>
	        <block type="import_package"></block>
	        <block type="import_class"></block>
	        <block type="import_static"></block>
	        <block type="import_manual">
	            <field name="IMPORT_PATH">java.util.HashMap</field>
	        </block>		    
	    </category>

	    <category id="cat_imported" name="Imported Classes" colour="#6D4C41">
	        <block type="imported_static_method"></block>
	        <block type="imported_static_field"></block>
	        <block type="imported_type_declaration"></block>
	        <block type="imported_interface"></block>
	    </category>
	    
	    <category id="cat_props" name="Properties" colour="#FB8C00">
	        <block type="property_declaration"></block>
	        <block type="designer_property"></block>
	        <block type="set_property"></block>
	        <block type="get_property"></block>
	    </category>

	    <category id="cat_method_inserts" name="Method Inserts" colour="#4CAF50">
		    <block type="post_runnable"></block>
		    <block type="run_on_ui_thread"></block>
		    <block type="set_on_click_listener"></block>
		    <block type="add_text_view"></block>
		    <block type="add_image_view"></block>
		    <block type="scroll_to_bottom"></block>
		    <block type="show_toast"></block>
		</category>

	    
	    <category id="cat_methods" name="Methods" colour="#7CB342">
	        <block type="method_declaration"></block>
	        <block type="event_declaration"></block>
	        <block type="custom_dispatcher"></block>
	        <block type="method_return"></block>
	        <block type="method_call"></block>
	    </category>

	    <sep></sep>

	    <category id="cat_control" name="Control" colour="#E53935">
	        <block type="controls_if_java"></block>
	        <block type="controls_for_java"></block>
	        <block type="controls_while_java"></block>
	        <block type="controls_try_catch"></block>
	        <block type="controls_return"></block>
	    </category>

	    <category id="cat_logic" name="Logic" colour="#FDD835">
	        <block type="logic_compare"></block>
	        <block type="logic_operation"></block>
	        <block type="logic_negate"></block>
	        <block type="logic_boolean"></block>
	        <block type="logic_null"></block>
	    </category>

	    <category id="cat_math" name="Math" colour="#8E24AA">
	        <block type="math_operation"></block>
	        <block type="math_function"></block>
	        <block type="math_random"></block>
	        <block type="math_number"></block>
	        <block type="math_constant"></block>
	    </category>

	    <category id="cat_text" name="Text" colour="#3949AB">
		    <block type="text_string"></block>
		    <block type="text_join"></block>
		    <block type="text_operation"></block>
		    <block type="text_charAt"></block>
		    <block type="text_indexOf"></block>
		    <block type="text_replace"></block>
		    <block type="text_split"></block>
		</category>

		<category id="cat_comments" name="Comments" colour="#757575">
	        <block type="comment_single"></block>
	        <block type="comment_multi"></block>
	        <block type="comment_multi_text"></block>
	    </category>

	    <category id="cat_lists" name="Lists" colour="#00ACC1">
	        <block type="lists_create"></block>
	        <block type="lists_operation"></block>
	        <block type="lists_get_index"></block>
	        <block type="lists_set_index"></block>
	        <block type="lists_forEach"></block>
	    </category>

	    <category id="cat_dictionaries" name="Dictionaries" colour="#43A047">
		    <block type="dict_create"></block>
		    <block type="dict_get"></block>
		    <block type="dict_set"></block>
		    <block type="dict_remove"></block>
		    <block type="dict_containsKey"></block>
		    <block type="dict_keys"></block>
		    <block type="dict_values"></block>
		</category>


	    <category id="cat_object" name="Objects" colour="#F4511E">
	        <block type="object_create"></block>
	        <block type="object_get_field"></block>
	        <block type="object_set_field"></block>
	        <block type="object_call_method"></block>
	        <block type="object_instance_of"></block>
	        <block type="object_cast"></block>
	        <sep gap="8"></sep>
	        <block type="constructor_arg"></block>
	        <block type="method_arg"></block>
	    </category>

	    <category id="cat_colors" name="Colors" colour="#D81B60">
		    <!-- Existing Blocks -->
		    <block type="color_picker"></block>
		    <block type="color_rgb"></block>
		    <block type="color_blend"></block>
		    <block type="color_random"></block>
		    
		    <!-- Newly Added Blocks -->
		    <block type="color_brightness"></block>
		    <block type="color_hex_to_rgb"></block>
		    <block type="color_rgb_to_hex"></block>
		</category>


	    <category id="cat_variables_custom" name="Variables" colour="#546E7A">
		    <block type="create_variable"></block>
		    <block type="set_variable"></block>
		    <block type="get_variable"></block>
		</category>


	    <category id="cat_functions" name="Functions" colour="#827717">
		    <block type="procedures_defnoreturn"></block>
		    <block type="procedures_defreturn"></block>
		    <block type="procedures_callnoreturn"></block>
		    <block type="procedures_callreturn"></block>
		    <block type="function_return"></block>
		    <block type="function_with_parameters"></block>
		</category>

	</xml>


	<!-- Scripts próprios -->
	<script src="js/translations.js"></script>
	<script src="js/blocks/functions.js"></script>
	<script src="js/blocks/methods.js"></script>
	<script src="js/blocks/control_blocks.js"></script>
	<script src="js/blocks/math_blocks.js"></script>
	<script src="js/blocks/text_blocks.js"></script>
	<script src="js/blocks/list_blocks.js"></script>
	<script src="js/blocks/logic_blocks.js"></script>
	<script src="js/blocks/dictionary_blocks.js"></script>
	<script src="js/blocks/color_blocks.js"></script>
	<script src="js/blocks/import_blocks.js"></script>
	<script src="js/blocks/imported_class_blocks.js"></script>
	<script src="js/blocks/object_blocks.js"></script>
	<script src="js/blocks/imported_class_blocks.js"></script>
	<script src="js/blocks/blocks.js"></script>
	<script src="js/blocks/configurations.js"></script>
	<script src="js/blocks/method_inserts.js"></script>
	<script src="js/blocks/variables.js"></script>
	<script src="js/blocks/comments_blocks.js"></script>
	<script src="js/main.js"></script>
</body>
</html>


js/blocks/blocks.js:
// Define custom blocks



Blockly.Blocks['import_basic'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Import")
            .appendField(new Blockly.FieldDropdown([
                ["com.google.appinventor.components.annotations.*", "ANNOTATIONS"],
                ["com.google.appinventor.components.common.*", "COMMON"],
                ["com.google.appinventor.components.runtime.*", "RUNTIME"],
                ["android.content.Context", "CONTEXT"]
            ]), "IMPORT");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(210);
        this.setTooltip("Imports necessary libraries");
        this.setHelpUrl("");
    }
};

// Import Static Method

Blockly.Blocks['designer_property'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("designerProperty"), "PROPERTY_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["string", "PropertyTypeConstants.PROPERTY_TYPE_STRING"],
                ["boolean", "PropertyTypeConstants.PROPERTY_TYPE_BOOLEAN"],
                ["integer", "PropertyTypeConstants.PROPERTY_TYPE_INTEGER"],
                ["color", "PropertyTypeConstants.PROPERTY_TYPE_COLOR"]
            ]), "TYPE");
        this.appendDummyInput()
            .appendField("Description")
            .appendField(new Blockly.FieldTextInput("A designer property"), "DESCRIPTION");
        this.appendDummyInput()
            .appendField("Category")
            .appendField(new Blockly.FieldDropdown([
                ["BEHAVIOR", "PropertyCategory.BEHAVIOR"],
                ["APPEARANCE", "PropertyCategory.APPEARANCE"]
            ]), "CATEGORY");
        this.appendStatementInput("DESIGNER_PROPERTY_SETTER")
            .setCheck(null)
            .appendField("Setter");
        this.appendStatementInput("DESIGNER_PROPERTY_GETTER")
            .setCheck(null)
            .appendField("Getter");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(160);
        this.setTooltip("Declares a designer property");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['property_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["boolean", "boolean"],
                ["double", "double"]
            ]), "TYPE");
        this.appendStatementInput("PROPERTY_SETTER")
            .setCheck(null)
            .appendField("Setter");
        this.appendStatementInput("PROPERTY_GETTER")
            .setCheck(null)
            .appendField("Getter");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(160);
        this.setTooltip("Declares a property");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['set_property'] = {
  init: function() {
    this.appendValueInput("VALUE")
        .setCheck(null)
        .appendField("set")
        .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY");
    this.setPreviousStatement(true, null);
    this.setNextStatement(true, null);
    this.setColour(290);
    this.setTooltip("Set property value");
    this.setHelpUrl("");
  }
};


Blockly.Blocks['get_property'] = {
  init: function() {
    this.appendDummyInput()
        .appendField("get")
        .appendField(new Blockly.FieldTextInput("myProperty"), "PROPERTY");
    this.setOutput(true, null);
    this.setColour(290);
    this.setTooltip("Get property value");
    this.setHelpUrl("");
  }
};




//Generators
// Java code generator
Blockly.JavaScript['set_property'] = function(block) {
  let property = block.getFieldValue('PROPERTY');
  let value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC);
  let code = `set${property.charAt(0).toUpperCase() + property.slice(1)}(${value});\n`;
  return code;
};

Blockly.JavaScript['get_property'] = function(block) {
  let property = block.getFieldValue('PROPERTY');
  let code = `get${property.charAt(0).toUpperCase() + property.slice(1)}()`;
  return [code, Blockly.JavaScript.ORDER_FUNCTION_CALL];
};

Blockly.JavaScript['property_declaration'] = function(block) {
    let propertyName = block.getFieldValue('PROPERTY_NAME');
    let type = block.getFieldValue('TYPE');
    let setterContent = Blockly.JavaScript.statementToCode(block, 'PROPERTY_SETTER');
    let getterContent = Blockly.JavaScript.statementToCode(block, 'PROPERTY_GETTER');
    
    return `    private ${type} ${propertyName};
    
    public void set${propertyName.charAt(0).toUpperCase() + propertyName.slice(1)}(${type} value) {
        ${setterContent}
    }
    
    public ${type} get${propertyName.charAt(0).toUpperCase() + propertyName.slice(1)}() {
        ${getterContent}
    }\n`;
};

Blockly.JavaScript['designer_property'] = function(block) {
    let propertyName = block.getFieldValue('PROPERTY_NAME');
    let type = block.getFieldValue('TYPE');
    let description = block.getFieldValue('DESCRIPTION');
    let category = block.getFieldValue('CATEGORY');
    let setterContent = Blockly.JavaScript.statementToCode(block, 'DESIGNER_PROPERTY_SETTER');
    let getterContent = Blockly.JavaScript.statementToCode(block, 'DESIGNER_PROPERTY_GETTER');
    
    return `    @DesignerProperty(editorType = ${type}, defaultValue = "")
    @SimpleProperty(description = "${description}")
    public void ${propertyName}(String value) {
        ${setterContent}
    }
    
    @SimpleProperty(category = ${category})
    public String ${propertyName}() {
        ${getterContent}
    }\n`;
};

Blockly.JavaScript['import_basic'] = function(block) {
    let importType = block.getFieldValue('IMPORT');
    let imports = {
        'ANNOTATIONS': 'com.google.appinventor.components.annotations.*',
        'COMMON': 'com.google.appinventor.components.common.*',
        'RUNTIME': 'com.google.appinventor.components.runtime.*',
        'CONTEXT': 'android.content.Context'
    };
    return `import ${imports[importType]};\n`;
};





js/blocks/color_blocks.js:
//blocks/color_blocks.js
'use strict';

// Color Picker
Blockly.Blocks['color_picker'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('color')
            .appendField(new Blockly.FieldColour('#ff0000'), 'COLOR');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Selects a color');
    }
};

// RGB Color
Blockly.Blocks['color_rgb'] = {
    init: function() {
        this.appendValueInput('RED')
            .setCheck('Number')
            .appendField('color with R');
        this.appendValueInput('GREEN')
            .setCheck('Number')
            .appendField('G');
        this.appendValueInput('BLUE')
            .setCheck('Number')
            .appendField('B');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Creates a color from RGB values (0-255)');
    }
};

// Blend Colors
Blockly.Blocks['color_blend'] = {
    init: function() {
        this.appendValueInput('COLOR1')
            .setCheck('Color')
            .appendField('blend color');
        this.appendValueInput('COLOR2')
            .setCheck('Color')
            .appendField('with');
        this.appendValueInput('RATIO')
            .setCheck('Number')
            .appendField('ratio');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Blends two colors with a ratio (0-1)');
    }
};

// Random Color
Blockly.Blocks['color_random'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('random color');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Generates a random color');
    }
};

// Adjust Brightness
Blockly.Blocks['color_brightness'] = {
    init: function() {
        this.appendValueInput('COLOR')
            .setCheck('Color')
            .appendField('adjust brightness of');
        this.appendValueInput('AMOUNT')
            .setCheck('Number')
            .appendField('by amount');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Adjusts the brightness of a color by a specified amount');
    }
};

// Convert HEX to RGB
Blockly.Blocks['color_hex_to_rgb'] = {
    init: function() {
        this.appendValueInput('HEX')
            .setCheck('String')
            .appendField('convert HEX');
        this.setOutput(true, 'Color');
        this.setColour("#D81B60");
        this.setTooltip('Converts a HEX color string to an RGB color');
    }
};

// Convert RGB to HEX
Blockly.Blocks['color_rgb_to_hex'] = {
    init: function() {
        this.appendValueInput('COLOR')
            .setCheck('Color')
            .appendField('convert to HEX');
        this.setOutput(true, 'String');
        this.setColour("#D81B60");
        this.setTooltip('Converts an RGB color to a HEX color string');
    }
};

//Generators
// Code Generator for Color Picker
Blockly.JavaScript['color_picker'] = function(block) {
    // Get the selected color value from the block (e.g., '#ff0000')
    let color = block.getFieldValue('COLOR');

    // Remove the '#' character and convert to uppercase (e.g., 'FF0000')
    let hex = color.substring(1).toUpperCase();

    // Prepend 'FF' for the alpha channel to make it ARGB (e.g., 'FFFF0000')
    let argbHex = 'FF' + hex;

    // Generate JavaScript code to parse the ARGB hex string into a signed 32-bit integer
    // The bitwise OR with 0 (`| 0`) converts the number to a signed 32-bit integer
    let code = `parseInt('${argbHex}', 16) | 0`;

    // Return the generated code and specify the order of operations
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};


// Code Generator for RGB Color
// Code Generator for RGB Color
Blockly.JavaScript['color_rgb'] = function(block) {
    let red = Blockly.JavaScript.valueToCode(block, 'RED', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    let green = Blockly.JavaScript.valueToCode(block, 'GREEN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    let blue = Blockly.JavaScript.valueToCode(block, 'BLUE', Blockly.JavaScript.ORDER_ATOMIC) || '0';

    // Generate Java code using Color.rgb method
    let code = `Color.rgb(${red}, ${green}, ${blue})`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};


// Code Generator for Blend Colors
// Code Generator for Blend Colors
Blockly.JavaScript['color_blend'] = function(block) {
    let color1 = Blockly.JavaScript.valueToCode(block, 'COLOR1', Blockly.JavaScript.ORDER_ATOMIC) || 'Color.BLACK';
    let color2 = Blockly.JavaScript.valueToCode(block, 'COLOR2', Blockly.JavaScript.ORDER_ATOMIC) || 'Color.WHITE';
    let ratio = Blockly.JavaScript.valueToCode(block, 'RATIO', Blockly.JavaScript.ORDER_ATOMIC) || '0.5';

    // Generate Java code using a helper method to blend colors
    // Since we cannot define helper methods within generated code, we'll inline the blending logic
    let code = `(int) ((1 - ${ratio}) * ${color1} + ${ratio} * ${color2})`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

// Code Generator for Random Color
Blockly.JavaScript['color_random'] = function(block) {
    // Generate Java code to create a random color using Math.random()
    let code = `(int)(Math.random() * 0x1000000) | 0xFF000000`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

// Code Generator for Adjust Brightness
// Code Generator for Adjust Brightness
Blockly.JavaScript['color_brightness'] = function(block) {
    let color = Blockly.JavaScript.valueToCode(block, 'COLOR', Blockly.JavaScript.ORDER_ATOMIC) || 'Color.BLACK';
    let amount = Blockly.JavaScript.valueToCode(block, 'AMOUNT', Blockly.JavaScript.ORDER_ATOMIC) || '0';

    // Generate Java code to adjust brightness
    // This involves extracting RGB components, adjusting them, and recombining
    let code = `Color.argb(Color.alpha(${color}), 
        Math.min(255, Math.max(0, Color.red(${color}) + ${amount})), 
        Math.min(255, Math.max(0, Color.green(${color}) + ${amount})), 
        Math.min(255, Math.max(0, Color.blue(${color}) + ${amount})))`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

// Code Generator for Convert HEX to RGB
// Code Generator for Convert HEX to RGB
Blockly.JavaScript['color_hex_to_rgb'] = function(block) {
    let hex = Blockly.JavaScript.valueToCode(block, 'HEX', Blockly.JavaScript.ORDER_ATOMIC) || '"#000000"';

    // Generate Java code to convert HEX to RGB string
    let code = `Color.red(Color.parseColor(${hex})) + ", " + Color.green(Color.parseColor(${hex})) + ", " + Color.blue(Color.parseColor(${hex}))`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

// Code Generator for Convert RGB to HEX
// Code Generator for Convert RGB to HEX
Blockly.JavaScript['color_rgb_to_hex'] = function(block) {
    let rgb = Blockly.JavaScript.valueToCode(block, 'COLOR', Blockly.JavaScript.ORDER_ATOMIC) || '"rgb(0, 0, 0)"';

    // Generate Java code to convert RGB string to HEX color
    let code = `String.format("#%02X%02X%02X", 
        Integer.parseInt(${rgb}.split(",")[0].replace("rgb(", "").trim()), 
        Integer.parseInt(${rgb}.split(",")[1].trim()), 
        Integer.parseInt(${rgb}.split(",")[2].replace(")", "").trim()))`;

    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};


js/blocks/comments_blocks.js:
'use strict';

/**
 * Define comment blocks for Blockly.
 */

/**
 * Single-Line Comment Block
 */
Blockly.Blocks['comment_single'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('//')
            .appendField(new Blockly.FieldTextInput('Your comment here'), 'COMMENT_TEXT');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(210); // Hue for comments (grey)
        this.setTooltip('Inserts a single-line comment.');
        this.setHelpUrl('https://docs.oracle.com/javase/tutorial/java/nutsandbolts/comments.html');
    }
};

Blockly.Blocks['comment_multi_text'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('')
            .appendField(new Blockly.FieldTextInput('Your comment here'), 'COMMENT_TEXT');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(210); // Hue for comments (grey)
        this.setTooltip('Inserts a single-line comment.');
        this.setHelpUrl('https://docs.oracle.com/javase/tutorial/java/nutsandbolts/comments.html');
    }
};

/**
 * Multi-Line Comment Block
 */
Blockly.Blocks['comment_multi'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('/*');
        this.appendStatementInput('COMMENT_LINES')
            .setCheck('comment_line');
        this.appendDummyInput()
            .appendField('*/');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(210); // Hue for comments (grey)
        this.setTooltip('Inserts a multi-line comment. Add comment lines below.');
        this.setHelpUrl('https://docs.oracle.com/javase/tutorial/java/nutsandbolts/comments.html');
    }
};

/**
 * JavaScript Code Generator for Single-Line Comment
 */
Blockly.JavaScript['comment_single'] = function(block) {
    const commentText = block.getFieldValue('COMMENT_TEXT');
    const escapedText = commentText.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/\n/g, '\\n');
    return `// ${escapedText}\n`;
};

/**
 * JavaScript Code Generator for Multi-Line Comment
 */
Blockly.JavaScript['comment_multi'] = function(block) {
    const commentLines = Blockly.JavaScript.statementToCode(block, 'COMMENT_LINES').trim().split('\n');
    const formattedLines = commentLines.map(line => ` * ${line.trim()}`).join('\n');
    return `/*\n${formattedLines}\n */\n`;
};

/**
 * JavaScript Code Generator for comment_multi_text
 */
Blockly.JavaScript['comment_multi_text'] = function(block) {
    const commentText = block.getFieldValue('COMMENT_TEXT');
    const escapedText = commentText.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/\n/g, '\\n');
    return ` ${escapedText}\n`;
};

js/blocks/configurations.js:
//blocks/configurations.js

//Blocks
Blockly.Blocks['extension_class'] = {
  init: function() {
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Create Extension"), "className")
        .appendField(new Blockly.FieldTextInput("MyExtension"), "classNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Description"), "descriptionName")
        .appendField(new Blockly.FieldTextInput("A custom extension"), "descriptionNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Category"), "categoryName")
        .appendField(new Blockly.FieldTextInput("EXTENSION"), "extensionNameEdit");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Non-visible"), "NAME")
        .appendField(new Blockly.FieldCheckbox("TRUE"), "checkBoxNonVisible");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Icon Name"), "NAME")
        .appendField(new Blockly.FieldTextInput("image/icon.png"), "imageURL");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("Interfaces"), "interfacesLabel")
        .appendField(new Blockly.FieldTextInput(""), "interfaces");
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("ANNOTATIONS"), "annotationsText");
    this.appendStatementInput("annotationBlocks")
        .setCheck(null);
    this.appendDummyInput()
        .appendField(new Blockly.FieldLabelSerializable("BLOCKS"), "blocksExtensions");
    this.appendStatementInput("statementBlocks")
        .setCheck(null);
    this.setPreviousStatement(true, null);
    this.setColour("#5C6BC0");
    this.setTooltip("");
    this.setHelpUrl("");
  }
};

Blockly.Blocks['custom_annotation'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Custom Annotation")
            .appendField(new Blockly.FieldTextInput("@MyAnnotation"), "ANNOTATION");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip("Adds a custom annotation above @SimpleObject");
        this.setHelpUrl("");
    }
};


// Bloco do construtor
Blockly.Blocks['constructor_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('Constructor')
            .appendField(new Blockly.FieldCheckbox("TRUE"), "IS_DEFAULT")
            .appendField("default");
        this.appendStatementInput('PARAMETERS')
            .setCheck('constructor_parameter')
            .appendField('parameters');
        this.appendStatementInput('SUPER_CALL')
            .setCheck('constructor_super_call')
            .appendField('super call');
        this.appendStatementInput('CONSTRUCTOR_CONTENT')
            .setCheck(null)
            .appendField('implementation');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Define o construtor da extensão');
        
        this.updateShape_();
    },
    
    mutationToDom: function() {
        let container = document.createElement('mutation');
        let isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        container.setAttribute('is_default', isDefault);
        return container;
    },
    
    domToMutation: function(xmlElement) {
        let isDefault = (xmlElement.getAttribute('is_default') == 'true');
        this.getField('IS_DEFAULT').setValue(isDefault ? 'TRUE' : 'FALSE');
        this.updateShape_();
    },
    
    updateShape_: function() {
        let isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        if (isDefault) {
            if (this.getInput('PARAMETERS')) this.removeInput('PARAMETERS');
            if (this.getInput('SUPER_CALL')) this.removeInput('SUPER_CALL');
        } else {
            if (!this.getInput('PARAMETERS')) {
                this.appendStatementInput('PARAMETERS')
                    .setCheck('constructor_parameter')
                    .appendField('parameters');
            }
            if (!this.getInput('SUPER_CALL')) {
                this.appendStatementInput('SUPER_CALL')
                    .setCheck('constructor_super_call')
                    .appendField('super call');
            }
        }
    }
};

// Bloco de parâmetro do construtor
Blockly.Blocks['constructor_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('parameter')
            .appendField(new Blockly.FieldTextInput('paramName'), 'PARAM_NAME')
            .appendField('type')
            .appendField(new Blockly.FieldDropdown([
                ['ComponentContainer', 'ComponentContainer'],
                ['Context', 'Context'],
                ['String', 'String'],
                ['int', 'int'],
                ['boolean', 'boolean']
            ]), 'PARAM_TYPE');
        this.setPreviousStatement(true, 'constructor_parameter');
        this.setNextStatement(true, 'constructor_parameter');
        this.setColour("#5C6BC0");
        this.setTooltip('Adiciona um parâmetro ao construtor');
    }
};

// Bloco para chamada super
Blockly.Blocks['constructor_super_call'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('super(')
            .appendField(new Blockly.FieldTextInput('container.$context()'), 'SUPER_PARAMS')
            .appendField(')');
        this.setPreviousStatement(true, 'constructor_super_call');
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Chamada do construtor da classe pai');
    }
};

Blockly.Blocks['package_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Package")
            .appendField(new Blockly.FieldTextInput("com.example.extension"), "PACKAGE");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip("Declares the extension package");
        this.setHelpUrl("");
    }
};

//Generators
Blockly.JavaScript['extension_class'] = function(block) {
  let interfaces = block.getFieldValue('interfaces');
  let className = block.getFieldValue('classNameEdit');
  let description = block.getFieldValue('descriptionNameEdit');
  let category = block.getFieldValue('extensionNameEdit');
  let nonVisible = block.getFieldValue('checkBoxNonVisible') === 'TRUE';
  let iconName = block.getFieldValue('imageURL');
  let annotations = Blockly.JavaScript.statementToCode(block, 'annotationBlocks');
  let members = Blockly.JavaScript.statementToCode(block, 'statementBlocks');

  let code = `@DesignerComponent(version = 1,
    description = "${description}",
    category = ComponentCategory.${category},
    nonVisible = ${nonVisible},
    iconName = "${iconName}")
@SimpleObject(external = true)
${annotations}public class ${className} extends AndroidNonvisibleComponent${interfaces ? ' implements ' + interfaces : ''} {
${members}}`;

  return code;
};

Blockly.JavaScript['custom_annotation'] = function(block) {
    let annotation = block.getFieldValue('ANNOTATION');
    return `${annotation}\n`;
};

Blockly.JavaScript['constructor_declaration'] = function(block) {
    let isDefault = block.getFieldValue('IS_DEFAULT') == 'TRUE';
    let content = Blockly.JavaScript.statementToCode(block, 'CONSTRUCTOR_CONTENT') || '';
    
    if (isDefault) {
        return `    public Constructor(ComponentContainer container) {
        
${content}    }\n`;
    } else {
        let parameters = Blockly.JavaScript.statementToCode(block, 'PARAMETERS') || '';
        let superCall = Blockly.JavaScript.statementToCode(block, 'SUPER_CALL') || '';
        
        parameters = parameters.trim().replace(/,\s*$/, '');
        
        return `    public Constructor(${parameters}) {
${superCall}${content}    }\n`;
    }
};

Blockly.JavaScript['constructor_parameter'] = function(block) {
    let paramName = block.getFieldValue('PARAM_NAME');
    let paramType = block.getFieldValue('PARAM_TYPE');
    
    return paramType + ' ' + paramName + ', ';
};

Blockly.JavaScript['constructor_super_call'] = function(block) {
    let params = block.getFieldValue('SUPER_PARAMS');
    let afterSuper = Blockly.JavaScript.statementToCode(block, 'AFTER_SUPER') || '';
    
    return `        super(${params});
${afterSuper}`;
};

Blockly.JavaScript['package_declaration'] = function(block) {
    let package = block.getFieldValue('PACKAGE');
    return `package ${package};\n\n`;
};

js/blocks/constructor_blocks.js:
'use strict';

// Bloco do construtor
Blockly.Blocks['constructor_declaration'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('Constructor')
            .appendField(new Blockly.FieldCheckbox("TRUE"), "IS_DEFAULT")
            .appendField("default");
        this.appendStatementInput('PARAMETERS')
            .setCheck('constructor_parameter')
            .appendField('parameters');
        this.appendStatementInput('SUPER_CALL')
            .setCheck('constructor_super_call')
            .appendField('super call');
        this.appendStatementInput('CONSTRUCTOR_CONTENT')
            .setCheck(null)
            .appendField('implementation');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Define o construtor da extensão');
        
        this.updateShape_();
    },
    
    mutationToDom: function() {
        var container = document.createElement('mutation');
        var isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        container.setAttribute('is_default', isDefault);
        return container;
    },
    
    domToMutation: function(xmlElement) {
        var isDefault = (xmlElement.getAttribute('is_default') == 'true');
        this.getField('IS_DEFAULT').setValue(isDefault ? 'TRUE' : 'FALSE');
        this.updateShape_();
    },
    
    updateShape_: function() {
        var isDefault = (this.getFieldValue('IS_DEFAULT') == 'TRUE');
        if (isDefault) {
            if (this.getInput('PARAMETERS')) this.removeInput('PARAMETERS');
            if (this.getInput('SUPER_CALL')) this.removeInput('SUPER_CALL');
        } else {
            if (!this.getInput('PARAMETERS')) {
                this.appendStatementInput('PARAMETERS')
                    .setCheck('constructor_parameter')
                    .appendField('parameters');
            }
            if (!this.getInput('SUPER_CALL')) {
                this.appendStatementInput('SUPER_CALL')
                    .setCheck('constructor_super_call')
                    .appendField('super call');
            }
        }
    }
};

// Bloco de parâmetro do construtor
Blockly.Blocks['constructor_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('parameter')
            .appendField(new Blockly.FieldTextInput('paramName'), 'PARAM_NAME')
            .appendField('type')
            .appendField(new Blockly.FieldDropdown([
                ['ComponentContainer', 'ComponentContainer'],
                ['Context', 'Context'],
                ['String', 'String'],
                ['int', 'int'],
                ['boolean', 'boolean']
            ]), 'PARAM_TYPE');
        this.setPreviousStatement(true, 'constructor_parameter');
        this.setNextStatement(true, 'constructor_parameter');
        this.setColour("#5C6BC0");
        this.setTooltip('Adiciona um parâmetro ao construtor');
    }
};

// Bloco para chamada super
Blockly.Blocks['constructor_super_call'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('super(')
            .appendField(new Blockly.FieldTextInput('container.$context()'), 'SUPER_PARAMS')
            .appendField(')');
        this.appendStatementInput('AFTER_SUPER')
            .setCheck(null)
            .appendField('after super');
        this.setPreviousStatement(true, 'constructor_super_call');
        this.setNextStatement(true, null);
        this.setColour("#5C6BC0");
        this.setTooltip('Chamada do construtor da classe pai');
    }
};

// Geradores de código
Blockly.JavaScript['constructor_declaration'] = function(block) {
    var isDefault = block.getFieldValue('IS_DEFAULT') == 'TRUE';
    var content = Blockly.JavaScript.statementToCode(block, 'CONSTRUCTOR_CONTENT') || '';
    
    if (isDefault) {
        return `    public Constructor(ComponentContainer container) {
        super(container.$context());
${content}    }\n`;
    } else {
        var parameters = Blockly.JavaScript.statementToCode(block, 'PARAMETERS') || '';
        var superCall = Blockly.JavaScript.statementToCode(block, 'SUPER_CALL') || '';
        
        parameters = parameters.trim().replace(/,\s*$/, '');
        
        return `    public Constructor(${parameters}) {
${superCall}${content}    }\n`;
    }
};

Blockly.JavaScript['constructor_parameter'] = function(block) {
    var paramName = block.getFieldValue('PARAM_NAME');
    var paramType = block.getFieldValue('PARAM_TYPE');
    
    return paramType + ' ' + paramName + ', ';
};

Blockly.JavaScript['constructor_super_call'] = function(block) {
    var params = block.getFieldValue('SUPER_PARAMS');
    var afterSuper = Blockly.JavaScript.statementToCode(block, 'AFTER_SUPER') || '';
    
    return `        super(${params});
${afterSuper}`;
};

js/blocks/control_blocks.js:
// Bloco If-Else
Blockly.Blocks['controls_if_java'] = {
    init: function() {
        this.appendValueInput('IF0')
            .setCheck('Boolean')
            .appendField('if');
        this.appendStatementInput('DO0')
            .appendField('do');
        this.appendStatementInput('ELSE')
            .appendField('else');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('If-else control statement');
    }
};

// Bloco For
Blockly.Blocks['controls_for_java'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('for')
            .appendField(new Blockly.FieldTextInput('i'), 'VAR')
            .appendField('from')
            .appendField(new Blockly.FieldNumber(0), 'FROM')
            .appendField('to')
            .appendField(new Blockly.FieldNumber(10), 'TO')
            .appendField('step')
            .appendField(new Blockly.FieldNumber(1), 'STEP');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('For loop with variable');
    }
};

// Bloco While
Blockly.Blocks['controls_while_java'] = {
    init: function() {
        this.appendValueInput('CONDITION')
            .setCheck('Boolean')
            .appendField('while');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('While loop');
    }
};

// Geradores de código para os blocos de controle
Blockly.JavaScript['controls_if_java'] = function(block) {
    let condition = Blockly.JavaScript.valueToCode(block, 'IF0', Blockly.JavaScript.ORDER_NONE) || 'false';
    let thenBranch = Blockly.JavaScript.statementToCode(block, 'DO0');
    let elseBranch = Blockly.JavaScript.statementToCode(block, 'ELSE');
    
    return `if (${condition}) {
        ${thenBranch}
    } else {
        ${elseBranch}
    }\n`;
};

Blockly.JavaScript['controls_for_java'] = function(block) {
    let variable = block.getFieldValue('VAR');
    let from = block.getFieldValue('FROM');
    let to = block.getFieldValue('TO');
    let step = block.getFieldValue('STEP');
    let branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `for (int ${variable} = ${from}; ${variable} <= ${to}; ${variable} += ${step}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_while_java'] = function(block) {
    let condition = Blockly.JavaScript.valueToCode(block, 'CONDITION', Blockly.JavaScript.ORDER_NONE) || 'false';
    let branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `while (${condition}) {
        ${branch}
    }\n`;
};

// Bloco If-Else
Blockly.Blocks['controls_if_java'] = {
    init: function() {
        this.appendValueInput('IF0')
            .setCheck('Boolean')
            .appendField('if');
        this.appendStatementInput('DO0')
            .appendField('do');
        this.appendStatementInput('ELSE')
            .appendField('else');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('If-else control statement');
    }
};

// Bloco For
Blockly.Blocks['controls_for_java'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('for')
            .appendField(new Blockly.FieldTextInput('i'), 'VAR')
            .appendField('from')
            .appendField(new Blockly.FieldNumber(0), 'FROM')
            .appendField('to')
            .appendField(new Blockly.FieldNumber(10), 'TO')
            .appendField('step')
            .appendField(new Blockly.FieldNumber(1), 'STEP');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('For loop with variable');
    }
};

// Bloco While
Blockly.Blocks['controls_while_java'] = {
    init: function() {
        this.appendValueInput('CONDITION')
            .setCheck('Boolean')
            .appendField('while');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('While loop');
    }
};

// Try-Catch Block
Blockly.Blocks['controls_try_catch'] = {
    init: function() {
        this.appendStatementInput('TRY')
            .setCheck(null)
            .appendField('try');
        this.appendStatementInput('CATCH')
            .setCheck(null)
            .appendField('catch')
            .appendField(new Blockly.FieldTextInput('Exception'), 'EXCEPTION_TYPE')
            .appendField(new Blockly.FieldTextInput('e'), 'EXCEPTION_VAR');
        this.appendStatementInput('FINALLY')
            .setCheck(null)
            .appendField('finally');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#E53935");
        this.setTooltip('Try-Catch-Finally block');
    }
};

// Return Block
Blockly.Blocks['controls_return'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('return');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null); // Return geralmente é a última declaração
        this.setColour("#E53935");
        this.setTooltip('Return statement');
    }
};

// Geradores de código para os blocos de controle
Blockly.JavaScript['controls_if_java'] = function(block) {
    let condition = Blockly.JavaScript.valueToCode(block, 'IF0', Blockly.JavaScript.ORDER_NONE) || 'false';
    let thenBranch = Blockly.JavaScript.statementToCode(block, 'DO0');
    let elseBranch = Blockly.JavaScript.statementToCode(block, 'ELSE');
    
    return `if (${condition}) {
        ${thenBranch}
    } else {
        ${elseBranch}
    }\n`;
};

Blockly.JavaScript['controls_for_java'] = function(block) {
    let variable = block.getFieldValue('VAR');
    let from = block.getFieldValue('FROM');
    let to = block.getFieldValue('TO');
    let step = block.getFieldValue('STEP');
    let branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `for (int ${variable} = ${from}; ${variable} <= ${to}; ${variable} += ${step}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_while_java'] = function(block) {
    let condition = Blockly.JavaScript.valueToCode(block, 'CONDITION', Blockly.JavaScript.ORDER_NONE) || 'false';
    let branch = Blockly.JavaScript.statementToCode(block, 'DO');
    
    return `while (${condition}) {
        ${branch}
    }\n`;
};

Blockly.JavaScript['controls_try_catch'] = function(block) {
    let tryCode = Blockly.JavaScript.statementToCode(block, 'TRY') || '';
    let catchCode = Blockly.JavaScript.statementToCode(block, 'CATCH') || '';
    let finallyCode = Blockly.JavaScript.statementToCode(block, 'FINALLY') || '';
    let exceptionType = block.getFieldValue('EXCEPTION_TYPE');
    let exceptionlet = block.getFieldValue('EXCEPTION_VAR');
    
    let code = 'try {\n' + 
        tryCode + 
        '} catch (' + exceptionType + ' ' + exceptionlet + ') {\n' +
        catchCode;

    if (finallyCode) {
        code += '} finally {\n' + finallyCode;
    }
    
    return code + '}\n';
};

Blockly.JavaScript['controls_return'] = function(block) {
    let value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return 'return ' + value + ';\n';
};

js/blocks/dictionary_blocks.js:
//blocks/dictionary_blocks.js
'use strict';

// Create a new HashMap
Blockly.Blocks['dict_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('new HashMap<')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Object', 'Object']
            ]), 'KEY_TYPE')
            .appendField(',')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Object', 'Object']
            ]), 'VALUE_TYPE')
            .appendField('>');
        this.setOutput(true, 'HashMap');
        this.setColour("#43A047");
        this.setTooltip('Creates a new HashMap');
    }
};

// Get value from HashMap
Blockly.Blocks['dict_get'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('get value from');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('with key');
        this.setOutput(true, null);
        this.setColour("#43A047");
        this.setTooltip('Gets a value from the HashMap by key');
    }
};

// Set value in HashMap
Blockly.Blocks['dict_set'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('set in');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('key');
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('value');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#43A047");
        this.setTooltip('Sets a value in the HashMap by key');
    }
};

// Remove value from HashMap
Blockly.Blocks['dict_remove'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('remove from');
        this.appendValueInput('KEY')
            .setCheck(null)
            .appendField('key');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#43A047");
        this.setTooltip('Removes a value from the HashMap by key');
    }
};

// Check if HashMap contains key
Blockly.Blocks['dict_containsKey'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('contains key');
        this.appendValueInput('KEY')
            .setCheck(null);
        this.setOutput(true, 'Boolean');
        this.setColour("#43A047");
        this.setTooltip('Checks if the HashMap contains the specified key');
    }
};

// Get all keys
Blockly.Blocks['dict_keys'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('get all keys from');
        this.setOutput(true, 'Set');
        this.setColour("#43A047");
        this.setTooltip('Gets all keys from the HashMap');
    }
};

// Get all values
Blockly.Blocks['dict_values'] = {
    init: function() {
        this.appendValueInput('DICT')
            .setCheck('HashMap')
            .appendField('get all values from');
        this.setOutput(true, 'Collection');
        this.setColour("#43A047");
        this.setTooltip('Gets all values from the HashMap');
    }
};

// Code Generators
Blockly.JavaScript['dict_create'] = function(block) {
    const keyType = block.getFieldValue('KEY_TYPE');
    const valueType = block.getFieldValue('VALUE_TYPE');
    return [`new HashMap<${keyType}, ${valueType}>()`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_get'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    const key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${dict}.get(${key})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_set'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    const key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return `${dict}.put(${key}, ${value});\n`;
};

Blockly.JavaScript['dict_remove'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    const key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return `${dict}.remove(${key});\n`;
};

Blockly.JavaScript['dict_containsKey'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    const key = Blockly.JavaScript.valueToCode(block, 'KEY', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${dict}.containsKey(${key})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_keys'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    return [`${dict}.keySet()`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['dict_values'] = function(block) {
    const dict = Blockly.JavaScript.valueToCode(block, 'DICT', Blockly.JavaScript.ORDER_ATOMIC) || 'map';
    return [`${dict}.values()`, Blockly.JavaScript.ORDER_ATOMIC];
};


js/blocks/functions.js:
'use strict';

// Define a procedure without return
Blockly.Blocks['procedures_defnoreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('procedure')
            .appendField(new Blockly.FieldTextInput('name'), 'NAME');
        this.appendStatementInput('STACK')
            .appendField('do');
        this.setColour('#827717');
        this.setTooltip('Defines a procedure without a return value');
        this.setHelpUrl('');
    }
};

// Define a function with return
Blockly.Blocks['procedures_defreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('function')
            .appendField(new Blockly.FieldTextInput('name'), 'NAME');
        this.appendStatementInput('STACK')
            .appendField('do');
        this.appendValueInput('RETURN')
            .appendField('return');
        this.setColour('#827717');
        this.setTooltip('Defines a function with a return value');
        this.setHelpUrl('');
    }
};

// Call procedure without return
Blockly.Blocks['procedures_callnoreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('call')
            .appendField(new Blockly.FieldTextInput('procedure'), 'NAME');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour('#827717');
        this.setTooltip('Calls a procedure without a return value');
    }
};

// Call function with return
Blockly.Blocks['procedures_callreturn'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('call function')
            .appendField(new Blockly.FieldTextInput('function'), 'NAME');
        this.setOutput(true, null);
        this.setColour('#827717');
        this.setTooltip('Calls a function and retrieves the return value');
    }
};

// Simple return block
Blockly.Blocks['function_return'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField('return');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null);
        this.setColour('#827717');
        this.setTooltip('Returns a value from the function');
    }
};

// Define a function with parameters
Blockly.Blocks['function_with_parameters'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField("function")
            .appendField(new Blockly.FieldTextInput("myFunction"), "FUNCTION_NAME")
            .appendField("return type")
            .appendField(new Blockly.FieldDropdown([
                ["void", "void"],
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"],
                ["Object", "Object"]
            ]), "RETURN_TYPE");
        this.appendStatementInput("STACK")
            .appendField("do");
        this.setMutator(new Blockly.Mutator(['function_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setColour('#827717');
        this.setTooltip("Defines a function with editable and 'final' parameters.");
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            paramNode.setAttribute('final', param.final ? 'true' : 'false');
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type'),
                final: param.getAttribute('final') === 'true'
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('function_mutator');
        containerBlock.initSvg();
        let connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('function_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.setFieldValue(param.final ? 'TRUE' : 'FALSE', 'FINAL');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        const newParamNames = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME');
            const paramType = paramBlock.getFieldValue('PARAM_TYPE');
            const isFinal = paramBlock.getFieldValue('FINAL') === 'TRUE';

            newParamNames.push({
                name: paramName,
                type: paramType,
                final: isFinal
            });

            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.paramCount_ = newParamNames.length;
        this.paramNames_ = newParamNames;

        this.updateShape_();

        // Update Blockly variable list
        const workspace = this.workspace;
        const variableNames = newParamNames.map(param => param.name);
        workspace.getAllVariables().forEach(variable => {
            if (!variableNames.includes(variable.name)) {
                workspace.deleteVariableById(variable.getId());
            }
        });
        variableNames.forEach(name => {
            if (!workspace.getVariable(name)) {
                workspace.createVariable(name);
            }
        });
    },

    updateShape_: function() {
        // Remove old parameter display
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        // Add new parameter display
        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};

Blockly.Blocks['function_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour('#827717');
        this.setTooltip("Add or remove parameters for the function.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['function_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("parameter")
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"],
                ["Object", "Object"]
            ]), "PARAM_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("FALSE"), "FINAL");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour('#827717');
        this.setTooltip("Defines a parameter for the function.");
    }
};

Blockly.JavaScript['function_with_parameters'] = function(block) {
    const functionName = block.getFieldValue('FUNCTION_NAME');
    const returnType = block.getFieldValue('RETURN_TYPE');
    const paramList = block.paramNames_
        .map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`)
        .join(', ');
    const statements = Blockly.JavaScript.statementToCode(block, 'STACK');
    return `public ${returnType} ${functionName}(${paramList}) {\n${statements}}\n`;
};

Blockly.JavaScript['function_parameter'] = function(block) {
    const paramName = block.getFieldValue('PARAM_NAME');
    const paramType = block.getFieldValue('PARAM_TYPE');
    const isFinal = block.getFieldValue('FINAL') === "TRUE";
    return `${isFinal ? 'final ' : ''}${paramType} ${paramName}`;
};



// JavaScript Generators
Blockly.JavaScript['procedures_defnoreturn'] = function(block) {
    const name = block.getFieldValue('NAME');
    const statements = Blockly.JavaScript.statementToCode(block, 'STACK');
    return `public void ${name}() {\n${statements}}\n`;
};

Blockly.JavaScript['procedures_defreturn'] = function(block) {
    const name = block.getFieldValue('NAME');
    const statements = Blockly.JavaScript.statementToCode(block, 'STACK');
    const returnValue = Blockly.JavaScript.valueToCode(block, 'RETURN', Blockly.JavaScript.ORDER_ATOMIC);
    return `public Object ${name}() {\n${statements}    return ${returnValue};\n}\n`;
};

Blockly.JavaScript['procedures_callnoreturn'] = function(block) {
    const name = block.getFieldValue('NAME');
    return `${name}();\n`;
};

Blockly.JavaScript['procedures_callreturn'] = function(block) {
    const name = block.getFieldValue('NAME');
    return [`${name}()`, Blockly.JavaScript.ORDER_ATOMIC];
};



js/blocks/import_blocks.js:
// Importação Manual
Blockly.Blocks['import_manual'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import')
            .appendField(new Blockly.FieldTextInput('java.util.ArrayList'), 'IMPORT_PATH');
        this.appendDummyInput()
            .appendField(new Blockly.FieldCheckbox('FALSE'), 'IS_STATIC')
            .appendField('static')
            .appendField(new Blockly.FieldCheckbox('FALSE'), 'IS_WILDCARD')
            .appendField('.*');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importação manual de classe ou pacote');
    }
};

// Importar Pacote Específico
Blockly.Blocks['import_package'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import package')
            .appendField(new Blockly.FieldTextInput('com.example'), 'PACKAGE')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('util'), 'SUB_PACKAGE')
            .appendField('.*');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar todas as classes de um pacote');
    }
};

// Importar Classe Específica
Blockly.Blocks['import_class'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import class')
            .appendField(new Blockly.FieldTextInput('java.util.List'), 'CLASS_PATH');
        this.appendDummyInput()
            .appendField('as')
            .appendField(new Blockly.FieldTextInput(''), 'ALIAS')
            .appendField('(opcional)');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar uma classe específica com alias opcional');
    }
};

// Importar Método Estático
Blockly.Blocks['import_static'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('import static')
            .appendField(new Blockly.FieldTextInput('java.lang.Math'), 'CLASS')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('*'), 'METHOD');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00897B");
        this.setTooltip('Importar método estático de uma classe');
    }
};

// Geradores de código
Blockly.JavaScript['import_manual'] = function(block) {
    let path = block.getFieldValue('IMPORT_PATH');
    let isStatic = block.getFieldValue('IS_STATIC') === 'TRUE';
    let isWildcard = block.getFieldValue('IS_WILDCARD') === 'TRUE';
    
    let code = 'import ';
    if (isStatic) code += 'static ';
    code += path;
    if (isWildcard) code += '.*';
    return code + ';\n';
};

Blockly.JavaScript['import_package'] = function(block) {
    let pkg = block.getFieldValue('PACKAGE');
    let subPkg = block.getFieldValue('SUB_PACKAGE');
    return `import ${pkg}.${subPkg}.*;\n`;
};

Blockly.JavaScript['import_class'] = function(block) {
    let classPath = block.getFieldValue('CLASS_PATH');
    let alias = block.getFieldValue('ALIAS');
    let code = `import ${classPath}`;
    if (alias) {
        code += ` as ${alias}`;
    }
    return code + ';\n';
};

Blockly.JavaScript['import_static'] = function(block) {
    let className = block.getFieldValue('CLASS');
    let method = block.getFieldValue('METHOD');
    return `import static ${className}.${method};\n`;
};

js/blocks/imported_class_blocks.js:
// Bloco para chamar método estático
Blockly.Blocks['imported_static_method'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput('Class'), 'CLASS_NAME')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('staticMethod'), 'METHOD_NAME')
            .appendField('(');
        this.appendStatementInput('ARGS')
            .setCheck('method_arg');
        this.appendDummyInput()
            .appendField(')');
        this.setOutput(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Chama um método estático de uma classe importada');
    }
};

// Bloco para acessar campo estático
Blockly.Blocks['imported_static_field'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput('Class'), 'CLASS_NAME')
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('CONSTANT'), 'FIELD_NAME');
        this.setOutput(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Acessa um campo estático de uma classe importada');
    }
};

// Bloco para declarar tipo
Blockly.Blocks['imported_type_declaration'] = {
    init: function() {
        this.appendValueInput('VALUE')
            .setCheck(null)
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE_NAME')
            .appendField(new Blockly.FieldTextInput('varName'), 'VAR_NAME')
            .appendField('=');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Declara uma variável com tipo importado');
    }
};

// Bloco para interface
Blockly.Blocks['imported_interface'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('implement interface')
            .appendField(new Blockly.FieldTextInput('Interface'), 'INTERFACE_NAME');
        this.appendStatementInput('METHODS')
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#6D4C41");
        this.setTooltip('Implementa uma interface importada');
    }
};

// Geradores de código
Blockly.JavaScript['imported_static_method'] = function(block) {
    let className = block.getFieldValue('CLASS_NAME');
    let methodName = block.getFieldValue('METHOD_NAME');
    let args = Blockly.JavaScript.statementToCode(block, 'ARGS');
    args = args.trim().replace(/,\s*$/, '');
    return [`${className}.${methodName}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['imported_static_field'] = function(block) {
    let className = block.getFieldValue('CLASS_NAME');
    let fieldName = block.getFieldValue('FIELD_NAME');
    return [`${className}.${fieldName}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['imported_type_declaration'] = function(block) {
    let typeName = block.getFieldValue('TYPE_NAME');
    let varName = block.getFieldValue('VAR_NAME');
    let value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${typeName} ${varName} = ${value};\n`;
};

Blockly.JavaScript['imported_interface'] = function(block) {
    let interfaceName = block.getFieldValue('INTERFACE_NAME');
    let methods = Blockly.JavaScript.statementToCode(block, 'METHODS');
    return `implements ${interfaceName} {\n${methods}}\n`;
};

js/blocks/list_blocks.js:
//blocks/list_blocks.js
'use strict';

// Create List
Blockly.Blocks['lists_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('new ArrayList<')
            .appendField(new Blockly.FieldDropdown([
                ['String', 'String'],
                ['Integer', 'Integer'],
                ['Boolean', 'Boolean'],
                ['Double', 'Double']
            ]), 'TYPE')
            .appendField('>');
        this.setOutput(true, 'ArrayList');
        this.setColour("#00ACC1");
        this.setTooltip('Creates a new ArrayList.');
    }
};

// List Operations
// List Operations with target list selection
Blockly.Blocks['lists_operation'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('Operate on list:');
        this.appendDummyInput()
            .appendField('Operation')
            .appendField(new Blockly.FieldDropdown([
                ['add', 'ADD'],
                ['remove', 'REMOVE'],
                ['get', 'GET'],
                ['size', 'SIZE'],
                ['clear', 'CLEAR']
            ]), 'OPERATION');
        this.appendValueInput('ITEM')
            .setCheck(null)
            .appendField('Item'); // Only relevant for operations like add/remove/get
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Perform operations on the specified ArrayList.');
    }
};

// Get Item from List
Blockly.Blocks['lists_get_index'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('get item from list');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('at index');
        this.setOutput(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Gets an item from the list at the specified index.');
    }
};

// Set Item in List
Blockly.Blocks['lists_set_index'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('set item in list');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('at index');
        this.appendValueInput('ITEM')
            .appendField('to value');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Sets an item in the list at the specified index.');
    }
};

// For Each Item in List
Blockly.Blocks['lists_forEach'] = {
    init: function() {
        this.appendValueInput('LIST')
            .setCheck('ArrayList')
            .appendField('for each item in');
        this.appendDummyInput()
            .appendField('as')
            .appendField(new Blockly.FieldTextInput('item'), 'VAR');
        this.appendStatementInput('DO')
            .appendField('do');
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#00ACC1");
        this.setTooltip('Performs actions for each item in the list.');
    }
};

// JavaScript Generators
Blockly.JavaScript['lists_create'] = function(block) {
    const type = block.getFieldValue('TYPE');
    return [`new ArrayList<${type}>()`, Blockly.JavaScript.ORDER_ATOMIC];
};

// Updated JavaScript generator
Blockly.JavaScript['lists_operation'] = function(block) {
    const list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    const item = Blockly.JavaScript.valueToCode(block, 'ITEM', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    const operation = block.getFieldValue('OPERATION');
    
    switch (operation) {
        case 'ADD':
            return `${list}.add(${item});\n`;
        case 'REMOVE':
            return `${list}.remove(${item});\n`;
        case 'GET':
            return `const result = ${list}.get(${item});\n`;
        case 'SIZE':
            return `const size = ${list}.size();\n`;
        case 'CLEAR':
            return `${list}.clear();\n`;
        default:
            return '';
    }
};

Blockly.JavaScript['lists_get_index'] = function(block) {
    const list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    const index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [`${list}.get(${index})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['lists_set_index'] = function(block) {
    const list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    const index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    const item = Blockly.JavaScript.valueToCode(block, 'ITEM', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${list}.set(${index}, ${item});\n`;
};

Blockly.JavaScript['lists_forEach'] = function(block) {
    const list = Blockly.JavaScript.valueToCode(block, 'LIST', Blockly.JavaScript.ORDER_ATOMIC) || 'list';
    const varName = block.getFieldValue('VAR');
    const branch = Blockly.JavaScript.statementToCode(block, 'DO') || '';
    return `for (let ${varName} of ${list}) {\n${branch}}\n`;
};


js/blocks/logic_blocks.js:
// Comparações
Blockly.Blocks['logic_compare'] = {
    init: function() {
        this.appendValueInput('A')
            .setCheck(null);
        this.appendValueInput('B')
            .setCheck(null)
            .appendField(new Blockly.FieldDropdown([
                ['=', 'EQ'],
                ['≠', 'NEQ'],
                ['<', 'LT'],
                ['≤', 'LTE'],
                ['>', 'GT'],
                ['≥', 'GTE']
            ]), 'OP');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Compara dois valores');
    }
};

// Operações lógicas com múltiplas entradas
Blockly.Blocks['logic_operation'] = {
    init: function() {
        this.setHelpUrl('');
        this.setColour("#FDD835");
        this.itemCount_ = 2;
        this.updateShape_();
        this.setOutput(true, 'Boolean');
        this.setMutator(new Blockly.Mutator(['logic_operation_item']));
        this.setTooltip('Combina valores booleanos com AND/OR');
    },

    mutationToDom: function() {
        let container = document.createElement('mutation');
        container.setAttribute('items', this.itemCount_);
        return container;
    },

    domToMutation: function(xmlElement) {
        this.itemCount_ = parseInt(xmlElement.getAttribute('items'), 10);
        this.updateShape_();
    },

    decompose: function(workspace) {
        let containerBlock = workspace.newBlock('logic_operation_container');
        containerBlock.initSvg();
        
        let connection = containerBlock.getInput('STACK').connection;
        for (let i = 0; i < this.itemCount_; i++) {
            let itemBlock = workspace.newBlock('logic_operation_item');
            itemBlock.initSvg();
            connection.connect(itemBlock.previousConnection);
            connection = itemBlock.nextConnection;
        }
        
        return containerBlock;
    },

    compose: function(containerBlock) {
        let itemBlock = containerBlock.getInputTargetBlock('STACK');
        let connections = [];
        while (itemBlock) {
            connections.push(itemBlock.valueConnection_);
            itemBlock = itemBlock.nextConnection &&
                itemBlock.nextConnection.targetBlock();
        }
        
        this.itemCount_ = connections.length;
        this.updateShape_();
        
        for (let i = 0; i < this.itemCount_; i++) {
            if (connections[i]) {
                this.getInput('ADD' + i).connection.connect(connections[i]);
            }
        }
    },

    updateShape_: function() {
        let i = 0;
        while (this.getInput('ADD' + i)) {
            this.removeInput('ADD' + i);
            i++;
        }

        if (!this.getInput('OP')) {
            this.appendDummyInput('OP')
                .appendField(new Blockly.FieldDropdown([
                    ['and', 'AND'],
                    ['or', 'OR']
                ]), 'OP');
        }

        for (let i = 0; i < this.itemCount_; i++) {
            let input = this.appendValueInput('ADD' + i)
                .setCheck('Boolean');
            if (i === 0) {
                input.appendField('');
            }
        }

        if (this.itemCount_ === 0) {
            this.appendDummyInput('EMPTY')
                .appendField('(vazio)');
        }
    }
};

// Negação
Blockly.Blocks['logic_negate'] = {
    init: function() {
        this.appendValueInput('BOOL')
            .setCheck('Boolean')
            .appendField('not');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Nega um valor booleano');
    }
};

// Booleano
Blockly.Blocks['logic_boolean'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['true', 'TRUE'],
                ['false', 'FALSE']
            ]), 'BOOL');
        this.setOutput(true, 'Boolean');
        this.setColour("#FDD835");
        this.setTooltip('Retorna verdadeiro ou falso');
    }
};

// Nulo
Blockly.Blocks['logic_null'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('null');
        this.setOutput(true, null);
        this.setColour("#FDD835");
        this.setTooltip('Retorna um valor nulo');
    }
};

// Blocos do mutator para logic_operation
Blockly.Blocks['logic_operation_container'] = {
    init: function() {
        this.setColour("#FDD835");
        this.appendDummyInput()
            .appendField('entradas');
        this.appendStatementInput('STACK');
        this.setTooltip("Adicione, remova ou reordene as entradas");
        this.contextMenu = false;
    }
};

Blockly.Blocks['logic_operation_item'] = {
    init: function() {
        this.setColour("#FDD835");
        this.appendDummyInput()
            .appendField('valor booleano');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
        this.setTooltip("Adiciona uma nova entrada booleana");
        this.contextMenu = false;
    }
};

// Geradores de código
Blockly.JavaScript['logic_compare'] = function(block) {
    let a = Blockly.JavaScript.valueToCode(block, 'A', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    let b = Blockly.JavaScript.valueToCode(block, 'B', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    let op = block.getFieldValue('OP');
    
    let code = '';
    switch(op) {
        case 'EQ': code = `${a}.equals(${b})`; break;
        case 'NEQ': code = `!${a}.equals(${b})`; break;
        case 'LT': code = `${a} < ${b}`; break;
        case 'LTE': code = `${a} <= ${b}`; break;
        case 'GT': code = `${a} > ${b}`; break;
        case 'GTE': code = `${a} >= ${b}`; break;
    }
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_operation'] = function(block) {
    let operator = block.getFieldValue('OP');
    let code = [];
    
    for (let i = 0; i < block.itemCount_; i++) {
        let value = Blockly.JavaScript.valueToCode(block, 'ADD' + i,
            Blockly.JavaScript.ORDER_ATOMIC) || 'false';
        code.push(value);
    }
    
    let operation = (operator === 'AND') ? ' && ' : ' || ';
    return ['(' + code.join(operation) + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_negate'] = function(block) {
    let bool = Blockly.JavaScript.valueToCode(block, 'BOOL', Blockly.JavaScript.ORDER_ATOMIC) || 'false';
    return [`!${bool}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_boolean'] = function(block) {
    let code = (block.getFieldValue('BOOL') === 'TRUE') ? 'true' : 'false';
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_null'] = function(block) {
    return ['null', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['logic_operation_container'] = function(block) {
    return null;
};

Blockly.JavaScript['logic_operation_item'] = function(block) {
    return null;
};

js/blocks/math_blocks.js:
//blocks/math_blocks.js
'use strict';


// Number block
Blockly.Blocks['math_number'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldNumber(0), 'NUM');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('A number');
    }
};

// Multiple Math Operations
Blockly.Blocks['math_operation'] = {
    init: function() {
        this.setHelpUrl('');
        this.setColour("#8E24AA");
        this.itemCount_ = 2;
        this.updateShape_();
        this.setOutput(true, 'Number');
        this.setMutator(new Blockly.Mutator(['math_operation_item']));
        this.setTooltip('Combines numbers with mathematical operations');
    },

    mutationToDom: function() {
        let container = document.createElement('mutation');
        container.setAttribute('items', this.itemCount_);
        return container;
    },

    domToMutation: function(xmlElement) {
        this.itemCount_ = parseInt(xmlElement.getAttribute('items'), 10);
        this.updateShape_();
    },

    decompose: function(workspace) {
        let containerBlock = workspace.newBlock('math_operation_container');
        containerBlock.initSvg();
        
        let connection = containerBlock.getInput('STACK').connection;
        for (let i = 0; i < this.itemCount_ - 1; i++) {
            let itemBlock = workspace.newBlock('math_operation_item');
            itemBlock.initSvg();
            connection.connect(itemBlock.previousConnection);
            connection = itemBlock.nextConnection;
        }
        
        return containerBlock;
    },

    compose: function(containerBlock) {
        let itemBlock = containerBlock.getInputTargetBlock('STACK');
        let connections = [];
        let operators = [];
        while (itemBlock) {
            connections.push(itemBlock.valueConnection_);
            operators.push(itemBlock.getFieldValue('OP'));
            itemBlock = itemBlock.nextConnection &&
                itemBlock.nextConnection.targetBlock();
        }
        
        this.itemCount_ = connections.length + 1;
        this.updateShape_();
        
        for (let i = 1; i < this.itemCount_; i++) {
            if (operators[i-1]) {
                this.getField('OP' + i).setValue(operators[i-1]);
            }
            if (connections[i-1]) {
                this.getInput('NUM' + i).connection.connect(connections[i-1]);
            }
        }
    },

    updateShape_: function() {
        if (!this.getInput('NUM0')) {
            this.appendValueInput('NUM0')
                .setCheck('Number');
        }

        let i = 1;
        while (this.getInput('NUM' + i)) {
            this.removeInput('NUM' + i);
            i++;
        }

        for (let i = 1; i < this.itemCount_; i++) {
            this.appendValueInput('NUM' + i)
                .setCheck('Number')
                .appendField(new Blockly.FieldDropdown([
                    ['+', 'ADD'],
                    ['-', 'SUBTRACT'],
                    ['×', 'MULTIPLY'],
                    ['÷', 'DIVIDE'],
                    ['%', 'MODULO'],
                    ['^', 'POWER']
                ]), 'OP' + i);
        }
    }
};

// Container block for mutator
Blockly.Blocks['math_operation_container'] = {
    init: function() {
        this.setColour("#8E24AA");
        this.appendDummyInput()
            .appendField('numbers');
        this.appendStatementInput('STACK');
        this.setTooltip('Add numbers for math operations');
        this.contextMenu = false;
    }
};

// Item block for mutator
Blockly.Blocks['math_operation_item'] = {
    init: function() {
        this.setColour("#8E24AA");
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['+', 'ADD'],
                ['-', 'SUBTRACT'],
                ['×', 'MULTIPLY'],
                ['÷', 'DIVIDE'],
                ['%', 'MODULO'],
                ['^', 'POWER']
            ]), 'OP');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
        this.setTooltip('Adds a new number with operator');
        this.contextMenu = false;
    }
};

// Math functions
Blockly.Blocks['math_function'] = {
    init: function() {
        this.appendValueInput('NUMBER')
            .setCheck('Number')
            .appendField(new Blockly.FieldDropdown([
                ['abs', 'Math.abs'],
                ['sqrt', 'Math.sqrt'],
                ['pow', 'Math.pow'],
                ['sin', 'Math.sin'],
                ['cos', 'Math.cos'],
                ['tan', 'Math.tan'],
                ['round', 'Math.round'],
                ['ceil', 'Math.ceil'],
                ['floor', 'Math.floor'],
                ['log', 'Math.log'],
                ['log10', 'Math.log10'],
                ['exp', 'Math.exp']
            ]), 'FUNC');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('Advanced mathematical functions');
    }
};

// Random with options
Blockly.Blocks['math_random'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('random')
            .appendField(new Blockly.FieldDropdown([
                ['number between', 'INT'],
                ['decimal between', 'FLOAT'],
                ['decimal 0-1', 'RANDOM'],
                ['boolean', 'BOOL']
            ]), 'TYPE');
        this.appendValueInput('MIN')
            .setCheck('Number')
            .appendField('min');
        this.appendValueInput('MAX')
            .setCheck('Number')
            .appendField('max');
        this.setOutput(true, ['Number', 'Boolean']);
        this.setColour("#8E24AA");
        this.setTooltip('Generates random numbers');
        this.updateShape_();
    },

    updateShape_: function() {
        let type = this.getFieldValue('TYPE');
        if (type === 'RANDOM' || type === 'BOOL') {
            if (this.getInput('MIN')) this.removeInput('MIN');
            if (this.getInput('MAX')) this.removeInput('MAX');
        } else {
            if (!this.getInput('MIN')) {
                this.appendValueInput('MIN')
                    .setCheck('Number')
                    .appendField('min');
            }
            if (!this.getInput('MAX')) {
                this.appendValueInput('MAX')
                    .setCheck('Number')
                    .appendField('max');
            }
        }
    },

    onchange: function() {
        this.updateShape_();
    }
};

// Mathematical constants
Blockly.Blocks['math_constant'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldDropdown([
                ['π', 'Math.PI'],
                ['e', 'Math.E'],
                ['φ (phi)', '1.618034'],
                ['√2', 'Math.SQRT2'],
                ['√½', 'Math.SQRT1_2'],
                ['∞', 'Infinity']
            ]), 'CONSTANT');
        this.setOutput(true, 'Number');
        this.setColour("#8E24AA");
        this.setTooltip('Mathematical constants');
    }
};

// Code Generators
Blockly.JavaScript['math_number'] = function(block) {
    let number = block.getFieldValue('NUM');
    return [number, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_operation'] = function(block) {
    let code = [];
    
    code.push(Blockly.JavaScript.valueToCode(block, 'NUM0', Blockly.JavaScript.ORDER_ATOMIC) || '0');
    
    for (let i = 1; i < block.itemCount_; i++) {
        let operator = block.getFieldValue('OP' + i);
        let value = Blockly.JavaScript.valueToCode(block, 'NUM' + i, Blockly.JavaScript.ORDER_ATOMIC) || '0';
        
        switch(operator) {
            case 'ADD': code.push('+', value); break;
            case 'SUBTRACT': code.push('-', value); break; 
            case 'MULTIPLY': code.push('*', value); break; 
            case 'DIVIDE': code.push('/', value); break;
            case 'MODULO': code.push('%', value); break;
            case 'POWER': code.push('Math.pow(' + code.pop() + ',', value + ')'); break;
        }
    }
    
    return ['(' + code.join(' ') + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_constant'] = function(block) {
    let constant = block.getFieldValue('CONSTANT');
    return [constant, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_function'] = function(block) {
    let func = block.getFieldValue('FUNC');
    let number = Blockly.JavaScript.valueToCode(block, 'NUMBER', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [func + '(' + number + ')', Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_random'] = function(block) {
    let type = block.getFieldValue('TYPE');
    let code;
    let min;
    let max

    switch(type) {
        case 'INT':
            min = Blockly.JavaScript.valueToCode(block, 'MIN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
            max = Blockly.JavaScript.valueToCode(block, 'MAX', Blockly.JavaScript.ORDER_ATOMIC) || '100';
            code = `Math.floor(Math.random() * (${max} - ${min} + 1) + ${min})`;
            break;
        case 'FLOAT':
            min = Blockly.JavaScript.valueToCode(block, 'MIN', Blockly.JavaScript.ORDER_ATOMIC) || '0';
            max = Blockly.JavaScript.valueToCode(block, 'MAX', Blockly.JavaScript.ORDER_ATOMIC) || '1';
            code = `(Math.random() * (${max} - ${min}) + ${min})`;
            break;
        case 'RANDOM':
            code = 'Math.random()';
            break;
        case 'BOOL':
            code = 'Math.random() >= 0.5';
            break;
    }
    return [code, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['math_operation_container'] = function(block) {
    return null;
};

Blockly.JavaScript['math_operation_item'] = function(block) {
    return null;
};


js/blocks/method_inserts.js:
//blocks/method_inserts.js
'use strict';
Blockly.Blocks['post_runnable'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".post new Runnable");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Executes code inside a Runnable using post with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['post_runnable'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.post(new Runnable() {\n    @Override\n    public void run() {\n${content}    }\n});\n`;
};

Blockly.Blocks['run_on_ui_thread'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".$form().runOnUiThread");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Runs code on the UI thread with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['run_on_ui_thread'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.runOnUiThread(new Runnable() {\n    @Override\n    public void run() {\n${content}    }\n});\n`;
};


Blockly.Blocks['set_on_click_listener'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".setOnClickListener");
        this.appendStatementInput("CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Sets an OnClickListener with a prefix.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['set_on_click_listener'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const content = Blockly.JavaScript.statementToCode(block, 'CONTENT');
    return `${prefix}.setOnClickListener(new View.OnClickListener() {\n    @Override\n    public void onClick(View v) {\n${content}    }\n});\n`;
};

Blockly.Blocks['add_text_view'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".addTextView");
        this.appendValueInput("TEXT")
            .setCheck("String")
            .appendField("with text");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Adds a TextView with specified text to a layout.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['add_text_view'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const text = Blockly.JavaScript.valueToCode(block, 'TEXT', Blockly.JavaScript.ORDER_ATOMIC);
    return `${prefix}.addView(new TextView(context) {{ setText(${text}); }});\n`;
};

Blockly.Blocks['add_image_view'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".addImageView");
        this.appendValueInput("IMAGE_PATH")
            .setCheck("String")
            .appendField("with image path");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Adds an ImageView with the specified image path.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['add_image_view'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    const imagePath = Blockly.JavaScript.valueToCode(block, 'IMAGE_PATH', Blockly.JavaScript.ORDER_ATOMIC);
    return `${prefix}.addView(new ImageView(context) {{ setImageURI(Uri.parse(${imagePath})); }});\n`;
};

Blockly.Blocks['scroll_to_bottom'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("prefix"), "PREFIX")
            .appendField(".scrollToBottom");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Scrolls a ScrollView to the bottom.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['scroll_to_bottom'] = function(block) {
    const prefix = block.getFieldValue('PREFIX');
    return `${prefix}.post(new Runnable() {\n    @Override\n    public void run() {\n        ${prefix}.fullScroll(View.FOCUS_DOWN);\n    }\n});\n`;
};

Blockly.Blocks['show_toast'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Show Toast");
        this.appendValueInput("MESSAGE")
            .setCheck("String")
            .appendField("message");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#4CAF50");
        this.setTooltip("Shows a toast message.");
        this.setHelpUrl("");
    }
};

Blockly.JavaScript['show_toast'] = function(block) {
    const message = Blockly.JavaScript.valueToCode(block, 'MESSAGE', Blockly.JavaScript.ORDER_ATOMIC);
    return `Toast.makeText(context, ${message}, Toast.LENGTH_SHORT).show();\n`;
};



js/blocks/methods.js:
//blocks/methods.js
'use strict';

//blocks
// Function return block for methods
Blockly.Blocks['method_return'] = {
    init: function() {
        this.appendValueInput('RETURN_VALUE')
            .setCheck(null)
            .appendField('return');
        this.setPreviousStatement(true, null);
        this.setNextStatement(false, null); // Does not allow following block
        this.setColour("#7CB342"); // Same color as methods
        this.setTooltip('Returns a value from the method');
    }
};

Blockly.Blocks['method_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['parameter'] = {
    init: function() {
        this.setColour("#7CB342");
        this.appendDummyInput()
            .appendField('parameter');
        this.setPreviousStatement(true);
        this.setNextStatement(true);
    }
};

// Updated method block with content field
Blockly.Blocks['method_declaration'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("myMethod"), "METHOD_NAME")
            .appendField("return")
            .appendField(new Blockly.FieldDropdown([
                ["void", "void"],
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "RETURN_TYPE");
        this.appendDummyInput("DESCRIPTION")
            .appendField("description")
            .appendField(new Blockly.FieldTextInput("A custom method"), "DESCRIPTION");
        this.appendStatementInput("METHOD_CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setMutator(new Blockly.Mutator(['method_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setColour("#7CB342");
        this.setTooltip("Declares a method with customizable and editable parameters.");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            paramNode.setAttribute('final', param.final ? 'true' : 'false');
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type'),
                final: param.getAttribute('final') === 'true'
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('method_mutator');
        containerBlock.initSvg();
        let connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('method_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.setFieldValue(param.final ? 'TRUE' : 'FALSE', 'FINAL');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        const newParamNames = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME') || `param${this.paramCount_ + 1}`;
            const paramType = paramBlock.getFieldValue('PARAM_TYPE') || "String";
            const isFinal = paramBlock.getFieldValue('FINAL') === "TRUE";

            newParamNames.push({
                name: paramName,
                type: paramType,
                final: isFinal
            });

            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.paramCount_ = newParamNames.length;
        this.paramNames_ = newParamNames;

        this.updateShape_();

        // Update Blockly variable list
        const workspace = this.workspace;
        const variableNames = newParamNames.map(param => param.name);
        workspace.getAllVariables().forEach(variable => {
            if (!variableNames.includes(variable.name)) {
                workspace.deleteVariableById(variable.getId());
            }
        });
        variableNames.forEach(name => {
            if (!workspace.getVariable(name)) {
                workspace.createVariable(name);
            }
        });
    },

    updateShape_: function() {
        // Remove old parameter display
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        // Add new parameter display
        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};

Blockly.Blocks['method_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the method.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['method_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("parameter")
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"],
                ["Object", "Object"]
            ]), "PARAM_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("FALSE"), "FINAL");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the method.");
    }
};

Blockly.JavaScript['method_declaration'] = function(block) {
    const methodName = block.getFieldValue('METHOD_NAME');
    const description = block.getFieldValue('DESCRIPTION');
    const returnType = block.getFieldValue('RETURN_TYPE');
    const content = Blockly.JavaScript.statementToCode(block, 'METHOD_CONTENT');

    const parameters = block.paramNames_ || [];
    const paramString = parameters.map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`).join(', ');

    return `    @SimpleFunction(description = "${description}")
    public ${returnType} ${methodName}(${paramString}) {
${content}
    }\n`;
};

Blockly.JavaScript['method_parameter'] = function(block) {
    const paramName = block.getFieldValue('PARAM_NAME');
    const paramType = block.getFieldValue('PARAM_TYPE');
    const isFinal = block.getFieldValue('FINAL') === "TRUE";
    return `${isFinal ? 'final ' : ''}${paramType} ${paramName}`;
};


//Events
Blockly.Blocks['event_declaration'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("MyEvent"), "EVENT_NAME")
            .appendField("parameters");
        this.appendDummyInput("DESCRIPTION")
            .appendField("description")
            .appendField(new Blockly.FieldTextInput("A custom event"), "DESCRIPTION");
        this.appendStatementInput("EVENT_CONTENT")
            .setCheck(null)
            .appendField("content");
        this.setMutator(new Blockly.Mutator(['event_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setColour("#7CB342");
        this.setTooltip("Declares an event with customizable parameters.");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            paramNode.setAttribute('final', param.final ? 'true' : 'false');
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type'),
                final: param.getAttribute('final') === 'true'
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('event_mutator');
        containerBlock.initSvg();
        let connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('event_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.setFieldValue(param.final ? 'TRUE' : 'FALSE', 'FINAL');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        const newParamNames = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME') || `param${this.paramCount_ + 1}`;
            const paramType = paramBlock.getFieldValue('PARAM_TYPE') || "String";
            const isFinal = paramBlock.getFieldValue('FINAL') === "TRUE";

            newParamNames.push({
                name: paramName,
                type: paramType,
                final: isFinal
            });

            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.paramCount_ = newParamNames.length;
        this.paramNames_ = newParamNames;

        this.updateShape_();

        // Update Blockly variable list
        const workspace = this.workspace;
        const variableNames = newParamNames.map(param => param.name);
        workspace.getAllVariables().forEach(variable => {
            if (!variableNames.includes(variable.name)) {
                workspace.deleteVariableById(variable.getId());
            }
        });
        variableNames.forEach(name => {
            if (!workspace.getVariable(name)) {
                workspace.createVariable(name);
            }
        });
    },

    updateShape_: function() {
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};

Blockly.Blocks['event_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the event.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['event_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("parameter")
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("FALSE"), "FINAL");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the event.");
    }
};

Blockly.JavaScript['event_declaration'] = function(block) {
    const eventName = block.getFieldValue('EVENT_NAME');
    const description = block.getFieldValue('DESCRIPTION');
    const content = Blockly.JavaScript.statementToCode(block, 'EVENT_CONTENT');

    const parameters = block.paramNames_ || [];
    const paramString = parameters.map(param => `${param.final ? 'final ' : ''}${param.type} ${param.name}`).join(', ');

    return `    @SimpleEvent(description = "${description}")
    public void ${eventName}(${paramString}) {
${content}
    }\n`;
};

Blockly.JavaScript['event_parameter'] = function(block) {
    const paramName = block.getFieldValue('PARAM_NAME');
    const paramType = block.getFieldValue('PARAM_TYPE');
    const isFinal = block.getFieldValue('FINAL') === "TRUE";
    return `${isFinal ? 'final ' : ''}${paramType} ${paramName}`;
};


//Custom_dispatcher
Blockly.Blocks['custom_dispatcher'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField(new Blockly.FieldTextInput("Dispatcher"), "EVENT_NAME")
            .appendField("parameters");
        this.setMutator(new Blockly.Mutator(['custom_dispatcher_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Custom Event Dispatcher with dynamic parameters.");
    },

    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            container.appendChild(paramNode);
        });
        return container;
    },

    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type')
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('custom_dispatcher_mutator');
        containerBlock.initSvg();
        let connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('custom_dispatcher_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        const newParamNames = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME') || `param${this.paramCount_ + 1}`;
            const paramType = paramBlock.getFieldValue('PARAM_TYPE') || "String";

            newParamNames.push({
                name: paramName,
                type: paramType
            });

            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.paramCount_ = newParamNames.length;
        this.paramNames_ = newParamNames;

        this.updateShape_();
    },

    updateShape_: function() {
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};

Blockly.Blocks['custom_dispatcher_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the dispatcher.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['custom_dispatcher_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("parameter")
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the dispatcher.");
    }
};

Blockly.JavaScript['custom_dispatcher'] = function(block) {
    const eventName = block.getFieldValue('EVENT_NAME');

    const parameters = block.paramNames_ || [];
    const paramString = parameters.map(param => `${param.type} ${param.name}`).join(', ');
    const paramNames = parameters.map(param => param.name).join(', ');

    return `        EventDispatcher.dispatchEvent(this, "${eventName}", ${paramNames});\n`;
};

Blockly.Blocks['method_call'] = {
    init: function() {
        this.appendDummyInput("HEADER")
            .appendField("call method")
            .appendField(new Blockly.FieldTextInput("Method Name"), "METHOD_NAME");
        this.setMutator(new Blockly.Mutator(['custom_dispatcher_parameter']));
        this.paramCount_ = 0;
        this.paramNames_ = [];
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#7CB342");
        this.setTooltip("Call a method with dynamic parameters.");
    },
    
    mutationToDom: function() {
        const container = document.createElement('mutation');
        container.setAttribute('params', this.paramCount_);
        this.paramNames_.forEach(param => {
            const paramNode = document.createElement('param');
            paramNode.setAttribute('name', param.name);
            paramNode.setAttribute('type', param.type);
            container.appendChild(paramNode);
        });
        return container;
    },
    
    domToMutation: function(xmlElement) {
        this.paramCount_ = parseInt(xmlElement.getAttribute('params'), 10);
        this.paramNames_ = [];
        Array.from(xmlElement.children).forEach(param => {
            this.paramNames_.push({
                name: param.getAttribute('name'),
                type: param.getAttribute('type')
            });
        });
        this.updateShape_();
    },

    decompose: function(workspace) {
        const containerBlock = workspace.newBlock('call_event_mutator');
        containerBlock.initSvg();
        const connection = containerBlock.getInput('STACK').connection;

        this.paramNames_.forEach(param => {
            const paramBlock = workspace.newBlock('call_event_parameter');
            paramBlock.setFieldValue(param.name, 'PARAM_NAME');
            paramBlock.setFieldValue(param.type, 'PARAM_TYPE');
            paramBlock.initSvg();
            connection.connect(paramBlock.previousConnection);
            connection = paramBlock.nextConnection;
        });

        return containerBlock;
    },

    compose: function(containerBlock) {
        let paramBlock = containerBlock.getInputTargetBlock('STACK');
        this.paramCount_ = 0;
        this.paramNames_ = [];

        while (paramBlock) {
            const paramName = paramBlock.getFieldValue('PARAM_NAME');
            const paramType = paramBlock.getFieldValue('PARAM_TYPE');

            this.paramCount_++;
            this.paramNames_.push({
                name: paramName,
                type: paramType
            });
            paramBlock = paramBlock.nextConnection && paramBlock.nextConnection.targetBlock();
        }

        this.updateShape_();
    },

    updateShape_: function() {
        // Remove the old parameter display
        if (this.getField("PARAMS")) {
            this.getInput("HEADER").removeField("PARAMS");
        }

        // Add the new parameter display
        if (this.paramCount_ > 0) {
            const paramDisplay = this.paramNames_
                .map(param => `${param.type} ${param.name}`)
                .join(', ');
            this.getInput("HEADER")
                .appendField("(" + paramDisplay + ")", "PARAMS");
        } else {
            this.getInput("HEADER")
                .appendField("()", "PARAMS");
        }
    }
};

Blockly.Blocks['call_event_mutator'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Parameters");
        this.appendStatementInput("STACK")
            .setCheck("Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Add or remove parameters for the custom dispatcher.");
        this.contextMenu = false;
    }
};

Blockly.Blocks['call_event_parameter'] = {
    init: function() {
        this.appendDummyInput()
            .appendField(new Blockly.FieldTextInput("param1"), "PARAM_NAME")
            .appendField(":")
            .appendField(new Blockly.FieldDropdown([
                ["String", "String"],
                ["int", "int"],
                ["double", "double"],
                ["boolean", "boolean"]
            ]), "PARAM_TYPE");
        this.setPreviousStatement(true, "Parameter");
        this.setNextStatement(true, "Parameter");
        this.setColour("#7CB342");
        this.setTooltip("Defines a parameter for the custom dispatcher.");
    }
};



//generators

Blockly.JavaScript['method_call'] = function(block) {
    const eventName = block.getFieldValue('METHOD_NAME');
    const content = Blockly.JavaScript.statementToCode(block, 'EVENT_CONTENT');

    // Coleta os parâmetros diretamente do `paramNames_`
    const parameters = block.paramNames_ || [];

    // Junta os parâmetros no formato "tipo nome" para o cabeçalho
    const paramString = parameters.map(param => `${param.type} ${param.name}`).join(', ');

    // Apenas os nomes dos parâmetros para usar no `EventDispatcher.dispatchEvent`
    const paramNames = parameters.map(param => param.name).join(', ');

    // Gera o evento com os parâmetros no cabeçalho e no dispatcher
    return `${eventName}(${paramNames});\n`;
};


Blockly.JavaScript['method_parameter'] = function(block) {
    const paramName = block.getFieldValue('PARAM_NAME');
    const paramType = block.getFieldValue('PARAM_TYPE');
    const paramFinal = block.getFieldValue('FINAL') === 'TRUE';

    // Retorna o parâmetro formatado como "tipo nome"
    return (paramFinal ? 'final ' : '') + `${paramType} ${paramName}`;
};


Blockly.JavaScript['method_return'] = function(block) {
    let returnValue = Blockly.JavaScript.valueToCode(block, 'RETURN_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || '';
    return `        return ${returnValue};\n`;
};

js/blocks/object_blocks.js:
// Criar Objeto
Blockly.Blocks['object_create'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('new')
            .appendField(new Blockly.FieldTextInput('Object'), 'CLASS_NAME');
        this.appendStatementInput('CONSTRUCTOR_ARGS')
            .setCheck('constructor_arg')
            .appendField('argumentos');
        this.setOutput(true, 'Object');
        this.setColour("#F4511E");;
        this.setTooltip('Cria uma nova instância de objeto');
    }
};

// Argumento do Construtor
Blockly.Blocks['constructor_arg'] = {
    init: function() {
        this.appendValueInput('ARG_VALUE')
            .setCheck(null)
            .appendField(new Blockly.FieldTextInput('arg'), 'ARG_NAME');
        this.setPreviousStatement(true, 'constructor_arg');
        this.setNextStatement(true, 'constructor_arg');
        this.setColour("#F4511E");;
        this.setTooltip('Argumento para construtor');
    }
};

// Acessar Campo
Blockly.Blocks['object_get_field'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('field'), 'FIELD_NAME');
        this.setOutput(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Acessa um campo do objeto');
    }
};

// Definir Campo
Blockly.Blocks['object_set_field'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('field'), 'FIELD_NAME')
            .appendField('=');
        this.appendValueInput('VALUE')
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Define o valor de um campo do objeto');
    }
};

// Chamar Método
Blockly.Blocks['object_call_method'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('.')
            .appendField(new Blockly.FieldTextInput('method'), 'METHOD_NAME')
            .appendField('(');
        this.appendStatementInput('ARGS')
            .setCheck('method_arg');
        this.appendDummyInput()
            .appendField(')');
        this.setOutput(true, null);
        this.setColour("#F4511E");;
        this.setTooltip('Chama um método do objeto');
    }
};

// Argumento de Método
Blockly.Blocks['method_arg'] = {
    init: function() {
        this.appendValueInput('ARG_VALUE')
            .setCheck(null);
        this.setPreviousStatement(true, 'method_arg');
        this.setNextStatement(true, 'method_arg');
        this.setColour("#F4511E");;
        this.setTooltip('Argumento para método');
    }
};

// Instanceof
Blockly.Blocks['object_instance_of'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object');
        this.appendDummyInput()
            .appendField('instanceof')
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE');
        this.setOutput(true, 'Boolean');
        this.setColour("#F4511E");;
        this.setTooltip('Verifica se o objeto é instância de um tipo');
    }
};

// Cast
Blockly.Blocks['object_cast'] = {
    init: function() {
        this.appendValueInput('OBJECT')
            .setCheck('Object')
            .appendField('(')
            .appendField(new Blockly.FieldTextInput('Type'), 'TYPE')
            .appendField(')');
        this.setOutput(true, 'Object');
        this.setColour("#F4511E");;
        this.setTooltip('Converte o objeto para outro tipo');
    }
};

// Geradores de código
Blockly.JavaScript['object_create'] = function(block) {
    let className = block.getFieldValue('CLASS_NAME');
    let args = Blockly.JavaScript.statementToCode(block, 'CONSTRUCTOR_ARGS');
    args = args.trim().replace(/,\s*$/, ''); // Remove última vírgula
    return [`new ${className}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['constructor_arg'] = function(block) {
    let value = Blockly.JavaScript.valueToCode(block, 'ARG_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return value + ', ';
};

Blockly.JavaScript['object_get_field'] = function(block) {
    let object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    let field = block.getFieldValue('FIELD_NAME');
    return [`${object}.${field}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['object_set_field'] = function(block) {
    let object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    let field = block.getFieldValue('FIELD_NAME');
    let value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${object}.${field} = ${value};\n`;
};

Blockly.JavaScript['object_call_method'] = function(block) {
    let object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    let method = block.getFieldValue('METHOD_NAME');
    let args = Blockly.JavaScript.statementToCode(block, 'ARGS');
    args = args.trim().replace(/,\s*$/, ''); // Remove última vírgula
    return [`${object}.${method}(${args})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['method_arg'] = function(block) {
    let value = Blockly.JavaScript.valueToCode(block, 'ARG_VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return value + ', ';
};

Blockly.JavaScript['object_instance_of'] = function(block) {
    let object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'this';
    let type = block.getFieldValue('TYPE');
    return [`${object} instanceof ${type}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['object_cast'] = function(block) {
    let object = Blockly.JavaScript.valueToCode(block, 'OBJECT', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    let type = block.getFieldValue('TYPE');
    return [`(${type}) ${object}`, Blockly.JavaScript.ORDER_ATOMIC];
};

js/blocks/text_blocks.js:
//blocks/text_blocks.js
'use strict';

// Simple Text Block
Blockly.Blocks['text_string'] = {
    init: function() {
        this.appendDummyInput()
            .appendField('"')
            .appendField(new Blockly.FieldTextInput(''), 'TEXT')
            .appendField('"');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('Text string');
    }
};

// Concatenate Texts Block
Blockly.Blocks['text_join'] = {
    init: function() {
        this.appendValueInput('A')
            .setCheck(['String', 'Number']);
        this.appendValueInput('B')
            .setCheck(['String', 'Number'])
            .appendField('+');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('Concatenates texts');
    }
};

// Text Operations Block
Blockly.Blocks['text_operation'] = {
    init: function() {
        this.appendValueInput('TEXT')
            .setCheck('String')
            .appendField(new Blockly.FieldDropdown([
                ['length', 'LENGTH'],
                ['to uppercase', 'UPPER'],
                ['to lowercase', 'LOWER'],
                ['trim', 'TRIM']
            ]), 'OP');
        this.setOutput(true, ['String', 'Number']);
        this.setColour("#3949AB");
        this.setTooltip('Text operations');
    }
};

// Character at index Block
Blockly.Blocks['text_charAt'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('character at');
        this.appendValueInput('INDEX')
            .setCheck('Number')
            .appendField('position');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('Returns the character at the specified position in the string');
    }
};

// Find Index of Substring Block
Blockly.Blocks['text_indexOf'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('find in');
        this.appendValueInput('SUBSTRING')
            .setCheck('String')
            .appendField('substring');
        this.setOutput(true, 'Number');
        this.setColour("#3949AB");
        this.setTooltip('Finds the position of a substring in the text');
    }
};

// Replace Text Block
Blockly.Blocks['text_replace'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('replace in');
        this.appendValueInput('TARGET')
            .setCheck('String')
            .appendField('target');
        this.appendValueInput('REPLACEMENT')
            .setCheck('String')
            .appendField('with');
        this.setOutput(true, 'String');
        this.setColour("#3949AB");
        this.setTooltip('Replaces occurrences of the target text with replacement text');
    }
};

// Split Text Block
Blockly.Blocks['text_split'] = {
    init: function() {
        this.appendValueInput('STRING')
            .setCheck('String')
            .appendField('split');
        this.appendValueInput('DELIMITER')
            .setCheck('String')
            .appendField('by');
        this.setOutput(true, 'Array');
        this.setColour("#3949AB");
        this.setTooltip('Splits the string into an array using a delimiter');
    }
};

// JavaScript Generators
Blockly.JavaScript['text_string'] = function(block) {
    const text = block.getFieldValue('TEXT');
    return [`"${text}"`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_join'] = function(block) {
    const a = Blockly.JavaScript.valueToCode(block, 'A', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const b = Blockly.JavaScript.valueToCode(block, 'B', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${a} + ${b}`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_operation'] = function(block) {
    const text = Blockly.JavaScript.valueToCode(block, 'TEXT', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const op = block.getFieldValue('OP');
    switch (op) {
        case 'LENGTH':
            return [`${text}.length()`, Blockly.JavaScript.ORDER_ATOMIC];
        case 'UPPER':
            return [`${text}.toUpperCase()`, Blockly.JavaScript.ORDER_ATOMIC];
        case 'LOWER':
            return [`${text}.toLowerCase()`, Blockly.JavaScript.ORDER_ATOMIC];
        case 'TRIM':
            return [`${text}.trim()`, Blockly.JavaScript.ORDER_ATOMIC];
        default:
            return ['""', Blockly.JavaScript.ORDER_ATOMIC];
    }
};

Blockly.JavaScript['text_charAt'] = function(block) {
    const string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const index = Blockly.JavaScript.valueToCode(block, 'INDEX', Blockly.JavaScript.ORDER_ATOMIC) || '0';
    return [`${string}.charAt(${index})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_indexOf'] = function(block) {
    const string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const substring = Blockly.JavaScript.valueToCode(block, 'SUBSTRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${string}.indexOf(${substring})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_replace'] = function(block) {
    const string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const target = Blockly.JavaScript.valueToCode(block, 'TARGET', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const replacement = Blockly.JavaScript.valueToCode(block, 'REPLACEMENT', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${string}.replace(${target}, ${replacement})`, Blockly.JavaScript.ORDER_ATOMIC];
};

Blockly.JavaScript['text_split'] = function(block) {
    const string = Blockly.JavaScript.valueToCode(block, 'STRING', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    const delimiter = Blockly.JavaScript.valueToCode(block, 'DELIMITER', Blockly.JavaScript.ORDER_ATOMIC) || '""';
    return [`${string}.split(${delimiter})`, Blockly.JavaScript.ORDER_ATOMIC];
};


js/blocks/variables.js:
//blocks/variables.js
'use strict';

Blockly.Blocks['create_variable'] = {
    init: function () {
        this.appendDummyInput()
            .appendField("Create Variable")
            .appendField(new Blockly.FieldTextInput("varName", this.validateAndRenameVariable.bind(this)), "VAR_NAME")
            .appendField("type")
            .appendField(new Blockly.FieldDropdown([
                ["int", "int"],
                ["String", "String"],
                ["boolean", "boolean"],
                ["double", "double"],
                ["Object", "Object"],
                ["List<String>", "List<String>"],
                ["List<Integer>", "List<Integer>"]
            ]), "VAR_TYPE")
            .appendField("final")
            .appendField(new Blockly.FieldCheckbox("FALSE"), "IS_FINAL");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Creates a new variable.");
        this.setHelpUrl("");
    },

    validateAndRenameVariable: function (newName) {
        const workspace = Blockly.getMainWorkspace();
        if (!workspace) return newName;

        const currentName = this.getFieldValue('VAR_NAME');
        const varType = this.getFieldValue('VAR_TYPE');

        // Se o nome não mudou, não faça nada
        if (currentName === newName) {
            return newName;
        }

        const existingVariable = workspace.getVariable(currentName, varType);

        // Se a variável atual não existir, crie uma nova
        if (!existingVariable) {
            console.warn(`Variable "${currentName}" does not exist. Creating a new one.`);
            workspace.createVariable(newName, varType);
            this.updateAllReferences(newName); // Atualiza referências no workspace
            return newName;
        }

        // Verifica se já existe uma variável com o novo nome
        const conflictingVariable = workspace.getVariable(newName, varType);
        if (conflictingVariable) {
            console.warn(`Variable "${newName}" already exists. Cannot rename.`);
            return currentName; // Reverte para o nome anterior
        }

        // Renomeia a variável no workspace
        workspace.renameVariableById(existingVariable.getId(), newName);
        this.updateAllReferences(newName); // Atualiza referências no workspace

        return newName;
    },
    updateAllReferences: function (variableId, newName) {
        const workspace = Blockly.getMainWorkspace();

        // Atualiza todos os blocos que utilizam a variável pelo ID
        workspace.getAllBlocks().forEach(block => {
            if (block.type === 'set_variable' || block.type === 'get_variable') {
                const variableField = block.getField('VAR_NAME');
                if (variableField && variableField.getValue() === variableId) {
                    variableField.setValue(variableId); // Atualiza o ID
                }
                if (typeof block.updateVariableDropdown === 'function') {
                    block.updateVariableDropdown(); // Atualiza os dropdowns
                }
            }
        });
    },
    onchange: function (event) {
        if (event.type === Blockly.Events.BLOCK_CREATE || Blockly.Events.BLOCK_CHANGE) {
            const workspace = Blockly.getMainWorkspace();
            const varName = this.getFieldValue('VAR_NAME');
            const varType = this.getFieldValue('VAR_TYPE');

            // Verifica se a variável já existe
            const existingVariable = workspace.getVariable(varName, varType);

            if (!existingVariable) {
                // Cria a variável apenas se não existir
                workspace.createVariable(varName, varType);
            }
        }
    },
};


Blockly.JavaScript['create_variable'] = function(block) {
    const varName = block.getFieldValue('VAR_NAME');
    const varType = block.getFieldValue('VAR_TYPE');
    const isFinal = block.getFieldValue('IS_FINAL') === 'TRUE' ? 'final ' : '';
    return `${isFinal}${varType} ${varName};\n`;
};

// Atribuição de valor
Blockly.Blocks['set_variable'] = {
    init: function () {
        this.appendDummyInput()
            .appendField("Set Variable")
            .appendField(new Blockly.FieldDropdown(this.getVariableOptions.bind(this)), "VAR_NAME")
            .appendField("=");
        this.appendValueInput("VALUE")
            .setCheck(null);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Sets a value to an existing variable.");
        this.setHelpUrl("");
    },

    getVariableOptions: function () {
        const workspace = Blockly.getMainWorkspace();
        const variables = workspace.getAllVariables();
        return variables.length > 0
            ? variables.map(v => [v.name, v.getId()]) // Nome e ID da variável
            : [["No Variables", ""]];
    },

    updateVariableDropdown: function () {
        const variableField = this.getField("VAR_NAME");
        const currentValue = variableField.getValue(); // Obtém o ID atual selecionado
        const options = this.getVariableOptions(); // Obtém as opções atualizadas

        // Atualiza as opções do dropdown
        variableField.menuGenerator_ = options;

        // Verifica se o valor atual ainda é válido
        const isValidOption = options.some(([, id]) => id === currentValue);

        if (!isValidOption && options.length > 0) {
            // Define o valor para a primeira variável disponível
            variableField.setValue(options[0][1]);
        } else if (isValidOption) {
            // Mantém o valor atual selecionado
            variableField.setValue(currentValue);
        }
    },
};

Blockly.JavaScript['set_variable'] = function (block) {
    const varId = block.getFieldValue('VAR_NAME');
    const workspace = Blockly.getMainWorkspace();
    const variable = workspace.getVariableById(varId);
    const varName = variable ? variable.name : "unknown";
    const value = Blockly.JavaScript.valueToCode(block, 'VALUE', Blockly.JavaScript.ORDER_ATOMIC) || 'null';
    return `${varName} = ${value};\n`;
};

// Obter valor de variável
Blockly.Blocks['get_variable'] = {
    init: function () {
        this.appendDummyInput()
            .appendField("Get Variable")
            .appendField(new Blockly.FieldDropdown(this.getVariableOptions.bind(this)), "VAR_NAME");
        this.setOutput(true, null);
        this.setColour("#546E7A");
        this.setTooltip("Gets the value of a variable.");
        this.setHelpUrl("");
    },

    getVariableOptions: function () {
        const workspace = Blockly.getMainWorkspace();
        const variables = workspace.getAllVariables();
        return variables.length > 0
            ? variables.map(v => [v.name, v.getId()]) // Nome e ID da variável
            : [["No Variables", ""]];
    },

    updateVariableDropdown: function () {
        const variableField = this.getField("VAR_NAME");
        const currentValue = variableField.getValue(); // Obtém o ID atual selecionado
        const options = this.getVariableOptions(); // Obtém as opções atualizadas

        // Atualiza as opções do dropdown
        variableField.menuGenerator_ = options;

        // Verifica se o valor atual ainda é válido
        const isValidOption = options.some(([, id]) => id === currentValue);

        if (!isValidOption && options.length > 0) {
            // Define o valor para a primeira variável disponível
            variableField.setValue(options[0][1]);
        } else if (isValidOption) {
            // Mantém o valor atual selecionado
            variableField.setValue(currentValue);
        }
    },

};


Blockly.JavaScript['get_variable'] = function (block) {
    const varId = block.getFieldValue('VAR_NAME');
    const workspace = Blockly.getMainWorkspace();
    const variable = workspace.getVariableById(varId);
    const varName = variable ? variable.name : "unknown";
    return [`${varName}`, Blockly.JavaScript.ORDER_ATOMIC];
};


js/main.js:
//js/main.js
/*
 * Author: Francisco Iago Lira Passos (iagolirapassos@gmail.com)
 * New blocks in https://google.github.io/blockly-samples/examples/developer-tools/index.html
 * MIT LICENSE
 */
// Variáveis globais
let workspace = Blockly.getMainWorkspace();
let currentLanguage = 'pt-br';

// Sistema de notificações
function showNotification(message, type) {
    let oldNotification = document.querySelector('.notification');
    if (oldNotification) {
        oldNotification.remove();
    }
    
    let notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Funções para sallet e carregar blocos
window.saveBlocks = function() {
    try {
        let xmlDom = Blockly.Xml.workspaceToDom(workspace);
        let xmlText = Blockly.Xml.domToPrettyText(xmlDom);
        
        let saveData = {
            version: "1.0",
            timestamp: new Date().toISOString(),
            blocks: xmlText
        };
        
        let saveString = JSON.stringify(saveData, null, 2);
        let blob = new Blob([saveString], {type: 'application/json'});
        let a = document.createElement('a');
        a.download = 'extension_blocks.json';
        a.href = URL.createObjectURL(blob);
        a.click();
        
        showNotification(TRANSLATIONS[currentLanguage]['file_success'], 'success');
    } catch (e) {
        console.error('Erro ao sallet blocos:', e);
        showNotification(TRANSLATIONS[currentLanguage]['file_error'], 'error');
    }
};

window.loadBlocks = function() {
    let input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = function(e) {
        let file = e.target.files[0];
        let reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                let saveData = JSON.parse(e.target.result);
                
                if (!saveData.version) {
                    throw new Error('Formato de arquivo inválido');
                }
                
                let xmlDom = Blockly.utils.xml.textToDom(saveData.blocks);
                workspace.clear();
                Blockly.Xml.domToWorkspace(xmlDom, workspace);
                
                showNotification(TRANSLATIONS[currentLanguage]['file_success'], 'success');
            } catch (err) {
                console.error('Erro ao carregar blocos:', err);
                showNotification(TRANSLATIONS[currentLanguage]['file_error'], 'error');
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
};


document.addEventListener('DOMContentLoaded', function() {
	const themeSelect = document.getElementById('themeSelect');
	const outputCode = document.getElementById('outputCode');

    // Configuração do Blockly
    workspace = Blockly.inject('blocklyDiv', {
        toolbox: document.getElementById('toolbox'),
        grid: {
            spacing: 20,
            length: 3,
            colour: '#ccc',
            snap: true
        },
        zoom: {
            controls: true,
            wheel: true,
            startScale: 1.0,
            maxScale: 3,
            minScale: 0.3,
            scaleSpeed: 1.2
        },
        trashcan: true
    });

    // Configuração do redimensionamento do painel
    const outputPanel = document.querySelector('.output-panel');
    const resizeHandle = document.querySelector('.resize-handle');
    let isResizing = false;
    let startY;
    let startHeight;

    resizeHandle.addEventListener('mousedown', (e) => {
        isResizing = true;
        startY = e.clientY;
        startHeight = parseInt(document.defaultView.getComputedStyle(outputPanel).height, 10);
    });

    document.addEventListener('mousemove', (e) => {
        if (!isResizing) return;

        const diffY = startY - e.clientY;
        outputPanel.style.height = (startHeight + diffY) + 'px';
        
        // Ajusta a altura do Blockly
        const blocklyDiv = document.getElementById('blocklyDiv');
        blocklyDiv.style.height = `calc(100vh - ${outputPanel.offsetHeight}px - 60px)`;
        Blockly.svgResize(workspace);
    });

    document.addEventListener('mouseup', () => {
        isResizing = false;
    });

    // Configuração da mudança de idioma
    const languageSelect = document.getElementById('languageSelect');
    languageSelect.addEventListener('change', function() {
        currentLanguage = this.value; // Atualiza a variável global
        changeLanguage(this.value);
    });

    function changeLanguage(lang) {
    
        // Atualiza as categorias do toolbox
        document.querySelectorAll('[id^="cat_"]').forEach(category => {
            const categoryId = category.id.replace('cat_', 'category_');
            if (TRANSLATIONS[lang][categoryId]) {
                category.setAttribute('name', TRANSLATIONS[lang][categoryId]);
            }
        });

        // Atualiza textos da interface
        document.getElementById('title').textContent = TRANSLATIONS[lang]['title'];
        // Atualiza categorias do toolbox
        document.getElementById('cat_config').setAttribute('name', TRANSLATIONS[lang]['cat_config']);
        document.getElementById('cat_props').setAttribute('name', TRANSLATIONS[lang]['cat_props']);
        document.getElementById('cat_methods').setAttribute('name', TRANSLATIONS[lang]['cat_methods']);

        // Atualiza os botões da IDE
        document.querySelector('.text-save').parentElement.title = TRANSLATIONS[lang]['save_blocks'];
        document.querySelector('.text-load').parentElement.title = TRANSLATIONS[lang]['load_blocks'];
        document.querySelector('.text-generate').textContent = TRANSLATIONS[lang]['generate_code'];
        document.querySelector('.text-download').textContent = TRANSLATIONS[lang]['download_file'];

        // Atualiza o Blockly
        Blockly.setLocale(lang);
    }
    
    //Themes
    themeSelect.addEventListener('change', function() {
		changeTheme(this.value);
	});

	function changeTheme(theme) {
		// Remove todas as classes de tema anteriores
		outputPanel.classList.remove('theme-light', 'theme-dark', 'theme-github', 'theme-monokai');
		
		// Adiciona a nova classe de tema
		outputPanel.classList.add(`theme-${theme}`);
		
		// Regenera o código para aplicar o novo tema
		if (workspace) {
		    generateJavaCode();
		}
	}

    // Funções de geração e download de código
    window.generateJavaCode = function() {
		try {
		    let code = Blockly.JavaScript.workspaceToCode(workspace);
		    const outputElement = document.getElementById('outputCode');
		    
		    // Primeiro, define o texto bruto
		    outputElement.textContent = code;

		    // Se o Prism está disponível e carregado corretamente
		    if (typeof Prism !== 'undefined' && Prism.languages.java) {
		        requestAnimationFrame(() => {
		            try {
		                const highlightedCode = Prism.highlight(
		                    code,
		                    Prism.languages.java,
		                    'java'
		                );
		                outputElement.innerHTML = highlightedCode;
		                
		                // Mantém o tema atual
		                const currentTheme = themeSelect.value;
		                changeTheme(currentTheme);
		            } catch (highlightError) {
		                console.warn('Erro ao aplicar syntax highlighting:', highlightError);
		            }
		        });
		    }
		} catch (error) {
		    console.error('Erro ao gerar código:', error);
		    outputElement.textContent = 'Erro ao gerar código. Por favor, verifique seus blocos.';
		}
	};

    window.downloadCode = function () {
        const outputElement = document.getElementById('outputCode');
        const code = outputElement.textContent || outputElement.innerText;

        if (!code) {
            showNotification("No code generated. Please generate code first.", "error");
            return;
        }

        try {
            // Extração do package e nome da classe
            const packageMatch = code.match(/package\s+([\w\.]+);/);
            const classMatch = code.match(/public\s+class\s+(\w+)/);

            if (!packageMatch || !classMatch) {
                throw new Error("Invalid Java code. Could not extract package or class name.");
            }

            const packageName = packageMatch[1];
            const className = classMatch[1];

            // Criar o nome do arquivo
            const fileName = `${className}.java`;

            // Criação do arquivo Java para download
            const blob = new Blob([code], { type: "text/java;charset=utf-8" });
            const a = document.createElement("a");
            a.download = fileName;
            a.href = URL.createObjectURL(blob);
            a.click();

            showNotification(`Code downloaded as ${fileName}`, "success");
        } catch (error) {
            console.error("Error while downloading code:", error);
            showNotification("Failed to download code. Check the console for details.", "error");
        }
    };


    document.getElementById('blocklyDiv').addEventListener('dragover', handleDragOver);
    document.getElementById('blocklyDiv').addEventListener('drop', handleFileDrop);

    function handleDragOver(e) {
      e.preventDefault();
    }

    function handleFileDrop(e) {
      e.preventDefault();
      let file = e.dataTransfer.files[0];
      let reader = new FileReader();

      reader.onload = function(event) {
        let saveData = JSON.parse(event.target.result);
        let xmlDom = Blockly.utils.xml.textToDom(saveData.blocks);
        workspace.clear();
        Blockly.Xml.domToWorkspace(xmlDom, workspace);
      };

      reader.readAsText(file);
    }

    Blockly.getMainWorkspace().addChangeListener(event => {
        if (event.type === Blockly.Events.VAR_RENAME || 
            event.type === Blockly.Events.VAR_CREATE || 
            event.type === Blockly.Events.VAR_DELETE) {
            
            Blockly.getMainWorkspace().getAllBlocks().forEach(block => {
                if (typeof block.updateVariableDropdown === 'function') {
                    block.updateVariableDropdown();
                }
            });
        }
    });



    // Define o idioma inicial
    changeLanguage('en');
    changeTheme('light');
});

// Função para compilar extensão
async function compileExtension() {
    try {
        const outputElement = document.getElementById('outputCode');
        const code = outputElement.textContent || outputElement.innerText;

        if (!code) {
            showNotification("No code generated. Please generate code first.", "error");
            return;
        }

        // Extração do nome da classe e pacote
        const packageMatch = code.match(/package\s+([\w\.]+);/);
        const classMatch = code.match(/public\s+class\s+(\w+)/);

        if (!classMatch) {
            throw new Error("Invalid Java code. Could not extract class name.");
        }

        const className = classMatch[1];
        const packageName = packageMatch ? packageMatch[1] : "com.example";

        // Enviar o código Java para o servidor
        const response = await fetch("https://localhost:8080/compile", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({ code, className, packageName }),
            mode: "cors", // Configurar o modo CORS
        });


        if (!response.ok) {
            throw new Error("Failed to compile the extension.");
        }

        // Baixar o arquivo .aix gerado
        const blob = await response.blob();
        const downloadUrl = URL.createObjectURL(blob);
        const downloadLink = document.createElement("a");
        downloadLink.href = downloadUrl;
        downloadLink.download = `${className}.aix`;
        downloadLink.click();

        showNotification("Extension compiled successfully!", "success");
    } catch (error) {
        console.error("Error during compilation:", error);
        showNotification("Failed to compile extension. Check the console for details.", "error");
    }
}

// Evento de clique no botão
document.querySelector('.button').addEventListener('click', compileExtension);


js/translations.js:
const TRANSLATIONS = {
    'en': {
        // Interface
        'title': 'MIT App Inventor Extension Builder',
        'btn_generate': 'Generate Java Code',
        'btn_download': 'Download .java',
        'theme_light': 'Light Theme',
        'theme_dark': 'Dark Theme',
        'theme_github': 'GitHub Theme',
        'theme_monokai': 'Monokai Theme',
        
        // Categories
        'cat_config': 'Configuration',
        'cat_props': 'Properties',
        'cat_methods': 'Methods',
        'cat_control': 'Control',
        'cat_lists': 'Lists',
        'cat_math': 'Math',
        'cat_text': 'Text',
        'cat_logic': 'Logic',
        'cat_dictionaries': 'Dictionaries',
        'cat_colors': 'Colors',
        'cat_variables': 'Variables',
        'cat_functions': 'Functions',


        // Botões da IDE
        'save_blocks': 'Save Blocks',
        'load_blocks': 'Load Blocks',
        'generate_code': 'Generate Java Code',
        'download_file': 'Download .java',
        
        // Categorias do Toolbox
        'category_config': 'Configuration',
        'category_imports': 'Imports',
        'category_props': 'Properties',
        'category_methods': 'Methods',
        'category_control': 'Control',
        'category_math': 'Math',
        'category_text': 'Text',
        'category_lists': 'Lists',
        'category_logic': 'Logic',
        'category_dictionaries': 'Dictionaries',
        'category_imported': 'Imported Classes',
        'category_object': 'Objects',
        'category_colors': 'Colors',
        'category_variables': 'Variables',
        'category_functions': 'Functions',
        
        // Blocos
        'block_return': 'return',
        'block_extension': 'Create Extension',
        'block_constructor': 'Constructor',
        'block_package': 'Package',
        'block_import': 'Import',
        'block_property': 'Property',
        'block_designer': 'Designer Property',
        'block_method': 'Method',
        'block_event': 'Event',
        'block_parameter': 'Parameter',
        
        // Common terms
        'type': 'type',
        'return': 'return',
        'name': 'name',
        'value': 'value',
        'parameter': 'parameter',
        'description': 'description',
        'implementation': 'implementation',
        'add_parameter': 'Add Parameter',
        'remove_parameter': 'Remove Parameter',
        // Control blocks
        'controls_if': 'if',
        'controls_for': 'for',
        'controls_while': 'while',
        'controls_try': 'try',
        'controls_catch': 'catch',
        'controls_finally': 'finally',
        'controls_return': 'return',
        'controls_do': 'do',
        'controls_else': 'else',
        
        // Math blocks
        'math_number': 'number',
        'math_operation': 'operation',
        'math_function': 'function',
        'math_random': 'random',
        'math_constant': 'constant',
        'math_add': 'add',
        'math_subtract': 'subtract',
        'math_multiply': 'multiply',
        'math_divide': 'divide',
        'math_modulo': 'modulo',
        'math_power': 'power',
        'math_abs': 'absolute',
        'math_sqrt': 'square root',
        'math_sin': 'sine',
        'math_cos': 'cosine',
        'math_tan': 'tangent',
        'math_round': 'round',
        'math_ceil': 'ceiling',
        'math_floor': 'floor',
        'math_random_int': 'random integer',
        'math_random_float': 'random decimal',
        'math_random_bool': 'random boolean',
        
        // Text blocks
        'text_string': 'text',
        'text_join': 'join',
        'text_length': 'length',
        'text_uppercase': 'to uppercase',
        'text_lowercase': 'to lowercase',
        'text_trim': 'trim',
        'text_charAt': 'character at',
        'text_indexOf': 'find in text',
        
        // List blocks
        'lists_create': 'create list',
        'lists_add': 'add',
        'lists_remove': 'remove',
        'lists_get': 'get',
        'lists_set': 'set',
        'lists_clear': 'clear',
        'lists_size': 'size',
        'lists_forEach': 'for each',
        
        // Constructor blocks
        'constructor_default': 'default constructor',
        'constructor_custom': 'custom constructor',
        'constructor_param': 'constructor parameter',
        'constructor_super': 'super call',
        
        // Import blocks
        'import_manual': 'manual import',
        'import_package': 'import package',
        'import_class': 'import class',
        
        // Object blocks
        'object_create': 'create object',
        'object_get_field': 'get field',
        'object_set_field': 'set field',
        'object_call_method': 'call method',
        'object_is_null': 'is null',
        'object_cast': 'cast to',
        'object_instance_of': 'is instance of',
        
        // File operations
        'file_save': 'Save Blocks',
        'file_load': 'Load Blocks',
        'file_success': 'Operation successful',
        'file_error': 'Error during operation',
        
        // Tooltips
        'tooltip_save': 'Save current blocks to file',
        'tooltip_load': 'Load blocks from file',
        'tooltip_import': 'Add custom import',
        'tooltip_object': 'Create new object instance',
        'tooltip_method': 'Call method from imported class',

        'logic_compare': 'compare',
        'logic_compare_title': 'comparisons',
        'logic_compare_item_title': 'comparison',
        'logic_operation_and': 'and',
        'logic_operation_or': 'or',
        'logic_negate': 'not',
        'logic_boolean_true': 'true',
        'logic_boolean_false': 'false',
        'logic_null': 'null',

        'logic_operation_title': 'Logical Operation',
        'logic_operation_item_title': 'Boolean Input',
        'logic_operation_empty': '(empty)',
        'logic_operation_and': 'AND',
        'logic_operation_or': 'OR'
    },
    'pt-br': {
        // Interface
        'title': 'Construtor de Extensões MIT App Inventor',
        'btn_generate': 'Gerar Código Java',
        'btn_download': 'Baixar .java',
        'theme_light': 'Tema Claro',
        'theme_dark': 'Tema Escuro',
        'theme_github': 'Tema GitHub',
        'theme_monokai': 'Tema Monokai',
        
        // Categorias
        'cat_config': 'Configuração',
        'cat_props': 'Propriedades',
        'cat_methods': 'Métodos',
        'cat_control': 'Controle',
        'cat_lists': 'Listas',
        'cat_math': 'Matemática',
        'cat_text': 'Texto',
        'cat_logic': 'Lógica',
        'cat_dictionaries': 'Dicionários',
        'cat_colors': 'Cores',
        'cat_variables': 'Variáveis',
        'cat_functions': 'Funções',
        
        // Botões da IDE
        'save_blocks': 'Salvar Blocos',
        'load_blocks': 'Carregar Blocos',
        'generate_code': 'Gerar Código Java',
        'download_file': 'Baixar .java',
        
        // Categorias do Toolbox
        'category_config': 'Configuração',
        'category_imports': 'Importações',
        'category_props': 'Propriedades',
        'category_methods': 'Métodos',
        'category_control': 'Controle',
        'category_math': 'Matemática',
        'category_text': 'Texto',
        'category_lists': 'Listas',
        'category_logic': 'Lógica',
        'category_dictionaries': 'Dicionários',
        'category_imported': 'Classes Importadas',
        'category_object': 'Objetos',
        'category_colors': 'Cores',
        'category_variables': 'Variáveis',
        'category_functions': 'Funções',
        
        // Blocos
        'block_return': 'retornar',
        'block_extension': 'Criar Extensão',
        'block_constructor': 'Construtor',
        'block_package': 'Pacote',
        'block_import': 'Importar',
        'block_property': 'Propriedade',
        'block_designer': 'Propriedade Designer',
        'block_method': 'Método',
        'block_event': 'Evento',
        'block_parameter': 'Parâmetro',
        
        // Termos comuns
        'type': 'tipo',
        'return': 'retorno',
        'name': 'nome',
        'value': 'valor',
        'parameter': 'parâmetro',
        'description': 'descrição',
        'implementation': 'implementação',
        'add_parameter': 'Adicionar Parâmetro',
        'remove_parameter': 'Remover Parâmetro',
        // Blocos de controle
        'controls_if': 'se',
        'controls_for': 'para',
        'controls_while': 'enquanto',
        'controls_try': 'tentar',
        'controls_catch': 'capturar',
        'controls_finally': 'finalmente',
        'controls_return': 'retornar',
        'controls_do': 'faça',
        'controls_else': 'senão',
        
        // Blocos matemáticos
        'math_number': 'número',
        'math_operation': 'operação',
        'math_function': 'função',
        'math_random': 'aleatório',
        'math_constant': 'constante',
        'math_add': 'adicionar',
        'math_subtract': 'subtrair',
        'math_multiply': 'multiplicar',
        'math_divide': 'dividir',
        'math_modulo': 'módulo',
        'math_power': 'potência',
        'math_abs': 'absoluto',
        'math_sqrt': 'raiz quadrada',
        'math_sin': 'seno',
        'math_cos': 'cosseno',
        'math_tan': 'tangente',
        'math_round': 'arredondar',
        'math_ceil': 'teto',
        'math_floor': 'piso',
        'math_random_int': 'inteiro aleatório',
        'math_random_float': 'decimal aleatório',
        'math_random_bool': 'booleano aleatório',
        
        // Blocos de texto
        'text_string': 'texto',
        'text_join': 'juntar',
        'text_length': 'comprimento',
        'text_uppercase': 'maiúsculas',
        'text_lowercase': 'minúsculas',
        'text_trim': 'remover espaços',
        'text_charAt': 'caractere na posição',
        'text_indexOf': 'encontrar no texto',
        
        // Blocos de lista
        'lists_create': 'criar lista',
        'lists_add': 'adicionar',
        'lists_remove': 'remover',
        'lists_get': 'obter',
        'lists_set': 'definir',
        'lists_clear': 'limpar',
        'lists_size': 'tamanho',
        'lists_forEach': 'para cada',
        
        // Blocos do construtor
        'constructor_default': 'construtor padrão',
        'constructor_custom': 'construtor personalizado',
        'constructor_param': 'parâmetro do construtor',
        'constructor_super': 'chamada super',
        
        // Blocos de importação
        'import_manual': 'importação manual',
        'import_package': 'importar pacote',
        'import_class': 'importar classe',
        
        // Blocos de objeto
        'object_create': 'criar objeto',
        'object_get_field': 'obter campo',
        'object_set_field': 'definir campo',
        'object_call_method': 'chamar método',
        'object_is_null': 'é nulo',
        'object_cast': 'converter para',
        'object_instance_of': 'é instância de',
        
        // Operações de arquivo
        'file_save': 'Salvar Blocos',
        'file_load': 'Carregar Blocos',
        'file_success': 'Operação realizada com sucesso',
        'file_error': 'Erro durante a operação',
        
        // Dicas de ferramentas
        'tooltip_save': 'Salvar blocos atuais em arquivo',
        'tooltip_load': 'Carregar blocos de um arquivo',
        'tooltip_import': 'Adicionar importação personalizada',
        'tooltip_object': 'Criar nova instância de objeto',
        'tooltip_method': 'Chamar método de classe importada',

        'logic_compare': 'compara',
        'logic_compare_title': 'comparações',
        'logic_compare_item_title': 'comparação',
        'logic_operation_and': 'e',
        'logic_operation_or': 'ou',
        'logic_negate': 'não',
        'logic_boolean_true': 'verdadeiro',
        'logic_boolean_false': 'falso',
        'logic_null': 'nulo',

        'logic_operation_title': 'Operação Lógica',
        'logic_operation_item_title': 'Entrada Booleana',
        'logic_operation_empty': '(vazio)',
        'logic_operation_and': 'E',
        'logic_operation_or': 'OU'

    }
};


LICENSE:
MIT License

Copyright (c) 2024 Iago lira

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


localhost.crt:
-----BEGIN CERTIFICATE-----
MIIDXzCCAkcCFEoMG0dsj5Dxw6NcxbVUbWJHi2tqMA0GCSqGSIb3DQEBCwUAMGwx
CzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVTdGF0ZTENMAsGA1UEBwwEQ2l0eTEVMBMG
A1UECgwMT3JnYW5pemF0aW9uMRMwEQYDVQQLDApEZXBhcnRtZW50MRIwEAYDVQQD
DAlsb2NhbGhvc3QwHhcNMjQxMTE3MDMwMTI1WhcNMjUxMTE3MDMwMTI1WjBsMQsw
CQYDVQQGEwJVUzEOMAwGA1UECAwFU3RhdGUxDTALBgNVBAcMBENpdHkxFTATBgNV
BAoMDE9yZ2FuaXphdGlvbjETMBEGA1UECwwKRGVwYXJ0bWVudDESMBAGA1UEAwwJ
bG9jYWxob3N0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA79LlxpCT
IJEsvLZciAxFr8PsnP3X1VhL4/EvtzXWuYpcy0SudiRapILxqw9qkMTYnOX0jmAD
1sPdE69p7JMJSU99UazUTxgot4T+UYnyLOT0jt7ZI42C+FCe5BMZsfhD2na2nZKC
Qbjkq6yBzfWPZORwTfwPTIjpc+ct92usMb4OgU/TFGcp1jQ2CzCPTiyPbiO3XuHh
1WKDj1KGoBW5JsTpdQfoRrsviuJZ7uBJZvVJMIsaH3fXZp2eDgzvycIpOx7Qwwx0
4V7zYbdN02JHyE+DZSwAvgfPjVnWuKLE6wooFzEXjm9xJV1XXiL1E1X6v3Vmmm+z
UBDWMYqew0rs7wIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQC5tVtcjWhv9lWVuMrA
nrHfG07uH5QToJipkkmkvAtUVafN2RZitkgksMvmi+bXs+5YssbHJH39uqP2b84K
59iBTehd2WLdfEDzP/0EnPAimvMQwWKQksXpCXfyI9t7xRdG/zDLL7ABwXyI4wnS
vOR/qvyvHbggWMyxUHe7wbwcL873+C6yqB57dDlU834pXSYHLvVm1gPQXOWICU0w
5y/v0hfWZG+H6G8VaHBM5Iu0Peb2NMtqkv+NL3+yzortiGq+vhx4T3dcwzHI4vhq
HH+P3kmwX3yX8FjCR/o2mE7s/eiqgXJUt445tTYv1Ayw7AGXvEIYmqNGQUPm+vUw
DMx9
-----END CERTIFICATE-----


localhost.key:
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDv0uXGkJMgkSy8
tlyIDEWvw+yc/dfVWEvj8S+3Nda5ilzLRK52JFqkgvGrD2qQxNic5fSOYAPWw90T
r2nskwlJT31RrNRPGCi3hP5RifIs5PSO3tkjjYL4UJ7kExmx+EPadradkoJBuOSr
rIHN9Y9k5HBN/A9MiOlz5y33a6wxvg6BT9MUZynWNDYLMI9OLI9uI7de4eHVYoOP
UoagFbkmxOl1B+hGuy+K4lnu4Elm9Ukwixofd9dmnZ4ODO/Jwik7HtDDDHThXvNh
t03TYkfIT4NlLAC+B8+NWda4osTrCigXMReOb3ElXVdeIvUTVfq/dWaab7NQENYx
ip7DSuzvAgMBAAECggEAEMXPsyj2WT8+AT7BzvQIxaeuuzYXq8CeoiUCoM4fo99U
6RR3HSUiv8G2tC+CVPina6W7il+VtSYCprdMcbLA4gMwsQ8k1BlM87TV8o7yxIgI
wJs+VXm2sLY2vp3FXMiPuk42LGQMPxt2xrjsZSKo8jX10sZvrXsf1K7U7Kp3owzU
nzfApcOWYcxRyjtxvNTKxYqVmVaNzN7U9aP/RijTmVUnkkcrtUhqH5yWV6dK3C7O
UOE1cmWqltSG5Xnagj9E+bxYOyqdGZdZOJT0MqGkL3/56eeR4XvDDTwj+cboiDz+
QdzKDb1+WHCeICjl9UtPD9G9Pxtf6b38MdCRFgaWJQKBgQD4CCouX/GlD463uuVh
xxCjWBuGAn8hco/ENaWpLTup31Y6f2F6pGKU3xZR2WuEVH+lMbhRy3stXCeV1Q8q
3tRadFcFzf2ID9qalrgN7XZQlO8xntaMDvawBn8xD7ahhS9dmCryoLCgkrIhtgBc
K/aW2M56Ga9MOEREUDiWfoMFbQKBgQD3hzqYeOg7R8tM9w5iUijDNhlxgwbzPnSz
if13CMhBl9+trcEgZInX6XJHdoUwj8iGm0r1eppH4VjdTL/GFcCVKhF99sU9oCVv
nNNACHKUlc6pMMokyKrTynsSWnvpzkT+q6XGgiSSv3btkEjn0AoOPnablMu9WcRA
WL8XAjHuSwKBgChFoxuuhlzHnuOkG/R5TvFGsAldRGkY4dD46PIEHyjg025iGmDA
aiVD56rYg4WT9rnKzeOyB0kBKohAdNsAHTimpS6TGLRL5rGtASt5v/krhX7oDGvn
ThScqXA83elx55PpzidhAezAhN3GYF6W4M3zW+slWnoktKjm4ZlF514tAoGBAMN6
e//lnCEUtaz2ftmO4LopgzZtr5Nxg2A2XYEf4mZKtk7GpXoba/CjX6ioJM8Q/d+v
zCbIyAZ0JGXAMsMQcqJaMq4zr9jXHDlktEAha7uEA00CRuF9x8qyYTdBVhJy33Hv
xF9cb92kbxt1kt3fIdHV6n07qRrERYQ7kc1t4li5AoGBALBpvDeGnI5hLUK9MUuc
/7GTwzZVQzDKsRNIhIz13bF8yznWZmDHDkOchIwyfRv+gzXUzblFaqSSgMcPzTIh
FvvYmXn5JloqwHaxk27A429aFBwk15FtwxJ6lUvWRFtV5DwWHq7qY/9mkOGUAMPt
VFqpu8ieNu064ysLJo60RLP5
-----END PRIVATE KEY-----


server.py:
from flask import Flask, request, send_file, jsonify
import os
import subprocess
import shutil

app = Flask(__name__)

# Configuração do diretório do Fast CLI e do projeto temporário
FAST_JAR_PATH = "/home/iaiaia/.local/share/Fast/fast.jar"  # Substitua pelo caminho do fast.jar
TEMP_DIR = "temp"

# Endpoint para compilar extensão
@app.route('/compile', methods=['POST'])
def compile_extension():
    try:
        # Extrair dados do corpo da requisição
        data = request.json
        code = data.get('code')
        class_name = data.get('className')
        package_name = data.get('packageName', 'com.example')

        if not code or not class_name:
            return jsonify({"error": "Code or class name is missing."}), 400

        # Configuração de diretórios
        project_dir = os.path.join(TEMP_DIR, "ExtensionProject")
        src_dir = os.path.join(project_dir, "src", package_name.replace(".", os.sep))
        build_dir = os.path.join(project_dir, "build")

        # Criar diretórios necessários
        os.makedirs(src_dir, exist_ok=True)

        # Caminho do arquivo Java
        java_file_path = os.path.join(src_dir, f"{class_name}.java")

        # Salvar o código Java
        with open(java_file_path, "w") as java_file:
            java_file.write(code)

        # Comando para executar o Fast CLI
        command = ["java", "-jar", FAST_JAR_PATH, "build", "-o"]
        result = subprocess.run(command, cwd=project_dir, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

        if result.returncode != 0:
            print("Build error:", result.stderr.decode())
            return jsonify({"error": "Failed to compile extension."}), 500

        # Caminho do arquivo .aix gerado
        aix_file_path = os.path.join(build_dir, f"{class_name}.aix")
        if not os.path.exists(aix_file_path):
            return jsonify({"error": "Extension file not found."}), 500

        # Enviar o arquivo .aix gerado
        return send_file(aix_file_path, as_attachment=True, download_name=f"{class_name}.aix")

    except Exception as e:
        print("Error:", str(e))
        return jsonify({"error": "Internal server error."}), 500
    finally:
        # Limpar diretórios temporários
        if os.path.exists(TEMP_DIR):
            shutil.rmtree(TEMP_DIR, ignore_errors=True)

# Iniciar o servidor
if __name__ == "__main__":
    from werkzeug.serving import make_ssl_devcert
    from werkzeug.middleware.proxy_fix import ProxyFix

    # Configurar HTTPS
    if not os.path.exists("localhost.key") or not os.path.exists("localhost.crt"):
        make_ssl_devcert("./localhost", host="localhost")

    app.wsgi_app = ProxyFix(app.wsgi_app)
    app.run(ssl_context=("localhost.crt", "localhost.key"), host="0.0.0.0", port=8080, debug=True)


